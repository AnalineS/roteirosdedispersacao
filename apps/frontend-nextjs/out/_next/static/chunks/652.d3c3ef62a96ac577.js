"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[652],{3652:function(e,t,o){o.r(t),o.d(t,{default:function(){return i}});var n=o(7437),r=o(2265),a=o(5121);function i(e){let{messages:t,currentPersona:i,isMobile:s=!1}=e,[l,c]=(0,r.useState)(!1),[d,p]=(0,r.useState)(!1),[u,x]=(0,r.useState)({recipient:"",subject:"Conversa com Assistente Virtual - Roteiros de Dispensa\xe7\xe3o",showEmailModal:!1}),g=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let m=t.length>0,h=()=>"CONVERSA COM ASSISTENTE VIRTUAL\nSistema: Roteiros de Dispensa\xe7\xe3o PQT-U\nAssistente: ".concat((null==i?void 0:i.name)||"N/A","\nData: ").concat(new Date().toLocaleDateString("pt-BR"),"\nHor\xe1rio: ").concat(new Date().toLocaleTimeString("pt-BR"),"\n\n").concat("=".repeat(50),"\n\n")+t.map((e,t)=>{let o=new Date(e.timestamp).toLocaleTimeString("pt-BR"),n="user"===e.role?"USU\xc1RIO":(null==i?void 0:i.name)||"ASSISTENTE";return"".concat(t+1,". [").concat(o,"] ").concat(n,":\n").concat(e.content,"\n\n")}).join("")+"".concat("=".repeat(50),"\n\nEsta conversa foi gerada pelo Sistema Educacional de Roteiros de Dispensa\xe7\xe3o PQT-U\nPrograma de P\xf3s-Gradua\xe7\xe3o em Ci\xeancias Farmac\xeauticas - Universidade de Bras\xedlia (UnB)\n\nPara mais informa\xe7\xf5es, visite nosso sistema educacional.\n"),b=async()=>{if(m){p(!0);try{let{default:e}=await Promise.all([o.e(505),o.e(553)]).then(o.bind(o,3375)),n=new e;h();let r=n.internal.pageSize.width,a=n.internal.pageSize.height,s=r-40;n.setFontSize(16),n.setFont("helvetica","bold"),n.text("Conversa com Assistente Virtual",20,20),n.setFontSize(12),n.setFont("helvetica","normal"),n.text("Sistema Educacional - Roteiros de Dispensa\xe7\xe3o PQT-U",20,30),n.setFontSize(10),n.text("Assistente: ".concat((null==i?void 0:i.name)||"N/A"),20,40),n.text("Data: ".concat(new Date().toLocaleDateString("pt-BR")," - ").concat(new Date().toLocaleTimeString("pt-BR")),20,47);let l=60;t.forEach((e,t)=>{l>a-30&&(n.addPage(),l=20);let o=new Date(e.timestamp).toLocaleTimeString("pt-BR"),r="user"===e.role?"USU\xc1RIO":(null==i?void 0:i.name)||"ASSISTENTE";n.setFontSize(10),n.setFont("helvetica","bold"),n.text("".concat(t+1,". [").concat(o,"] ").concat(r,":"),20,l),l+=9,n.setFont("helvetica","normal"),n.splitTextToSize(e.content,s).forEach(e=>{l>a-20&&(n.addPage(),l=20),n.text(e,20,l),l+=7}),l+=5}),l>a-40&&(n.addPage(),l=20),n.setFontSize(8),n.setFont("helvetica","italic"),n.text("Gerado pelo Sistema Educacional de Roteiros de Dispensa\xe7\xe3o PQT-U - PPGCF/UnB",20,a-15);let c="conversa-".concat((null==i?void 0:i.name)||"assistente","-").concat(new Date().toISOString().split("T")[0],".pdf");n.save(c)}catch(e){console.error("Erro ao exportar PDF:",e),alert("Erro ao exportar PDF. Tente novamente.")}finally{p(!1),c(!1)}}},S=()=>{let e=h();return{subject:encodeURIComponent(u.subject),body:encodeURIComponent(e),text:e}},f=async()=>{if(m)try{let e=h();await navigator.clipboard.writeText(e),alert("Conversa copiada para a \xe1rea de transfer\xeancia!"),c(!1)}catch(e){console.error("Erro ao copiar texto:",e),alert("Erro ao copiar texto. Tente novamente.")}};return(0,n.jsxs)("div",{ref:g,style:{position:"relative",zIndex:1e3},children:[(0,n.jsx)("button",{onClick:()=>c(!l),disabled:!m,style:{display:"flex",alignItems:"center",justifyContent:"center",width:s?"40px":"44px",height:s?"40px":"44px",background:m?"rgba(255,255,255,0.15)":"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",color:m?"white":"rgba(255,255,255,0.5)",cursor:m?"pointer":"not-allowed",fontSize:s?"1.1rem":"1.2rem",transition:"all 0.3s ease"},onMouseEnter:e=>{m&&(e.currentTarget.style.background="rgba(255,255,255,0.25)")},onMouseLeave:e=>{m&&(e.currentTarget.style.background="rgba(255,255,255,0.15)")},title:"Exportar conversa",children:"\uD83D\uDCE4"}),l&&m&&(0,n.jsxs)(n.Fragment,{children:[s&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:998},onClick:()=>c(!1)}),(0,n.jsxs)("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",background:"white",borderRadius:"12px",boxShadow:"0 8px 32px rgba(0,0,0,0.15)",border:"1px solid rgba(0,0,0,0.1)",minWidth:"240px",zIndex:999,overflow:"hidden"},children:[(0,n.jsxs)("div",{style:{padding:"16px 20px",background:"linear-gradient(135deg, ".concat(a.rS.colors.primary[50]," 0%, ").concat(a.rS.colors.secondary[50]," 100%)"),borderBottom:"1px solid #f0f0f0"},children:[(0,n.jsx)("h3",{style:{margin:0,fontSize:"0.9rem",fontWeight:"bold",color:a.rS.colors.primary[700]},children:"Exportar Conversa"}),(0,n.jsxs)("p",{style:{margin:"4px 0 0",fontSize:"0.75rem",color:a.rS.colors.neutral[600]},children:[t.length," mensagem",1!==t.length?"s":""]})]}),(0,n.jsxs)("div",{style:{padding:"8px 0"},children:[(0,n.jsxs)("button",{onClick:b,disabled:d,style:{width:"100%",display:"flex",alignItems:"center",gap:"12px",padding:"12px 20px",border:"none",background:"transparent",cursor:d?"wait":"pointer",textAlign:"left",transition:"background 0.2s ease"},onMouseEnter:e=>{d||(e.currentTarget.style.background=a.rS.colors.neutral[50])},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[(0,n.jsx)("span",{style:{fontSize:"1.2rem"},children:"\uD83D\uDCC4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:"600",color:a.rS.colors.neutral[800]},children:d?"Gerando PDF...":"Exportar como PDF"}),(0,n.jsx)("div",{style:{fontSize:"0.75rem",color:a.rS.colors.neutral[600]},children:"Salvar arquivo PDF no computador"})]})]}),(0,n.jsxs)("button",{onClick:()=>x(e=>({...e,showEmailModal:!0})),style:{width:"100%",display:"flex",alignItems:"center",gap:"12px",padding:"12px 20px",border:"none",background:"transparent",cursor:"pointer",textAlign:"left",transition:"background 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background=a.rS.colors.neutral[50]},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[(0,n.jsx)("span",{style:{fontSize:"1.2rem"},children:"\uD83D\uDCE7"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:"600",color:a.rS.colors.neutral[800]},children:"Enviar por E-mail"}),(0,n.jsx)("div",{style:{fontSize:"0.75rem",color:a.rS.colors.neutral[600]},children:"Abrir cliente de e-mail"})]})]}),(0,n.jsxs)("button",{onClick:f,style:{width:"100%",display:"flex",alignItems:"center",gap:"12px",padding:"12px 20px",border:"none",background:"transparent",cursor:"pointer",textAlign:"left",transition:"background 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background=a.rS.colors.neutral[50]},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[(0,n.jsx)("span",{style:{fontSize:"1.2rem"},children:"\uD83D\uDCCB"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:"600",color:a.rS.colors.neutral[800]},children:"Copiar Texto"}),(0,n.jsx)("div",{style:{fontSize:"0.75rem",color:a.rS.colors.neutral[600]},children:"Copiar para \xe1rea de transfer\xeancia"})]})]})]})]})]}),u.showEmailModal&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px"},onClick:e=>{e.target===e.currentTarget&&x(e=>({...e,showEmailModal:!1}))},children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"24px",width:"100%",maxWidth:"400px",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[(0,n.jsx)("h3",{style:{margin:"0 0 16px",fontSize:"1.1rem",fontWeight:"bold",color:a.rS.colors.primary[700]},children:"Enviar por E-mail"}),(0,n.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,n.jsx)("label",{style:{display:"block",fontSize:"0.9rem",fontWeight:"600",color:a.rS.colors.neutral[700],marginBottom:"6px"},children:"E-mail do destinat\xe1rio (opcional):"}),(0,n.jsx)("input",{type:"email",value:u.recipient,onChange:e=>x(t=>({...t,recipient:e.target.value})),placeholder:"exemplo@email.com",style:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"0.9rem",outline:"none"}})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",fontSize:"0.9rem",fontWeight:"600",color:a.rS.colors.neutral[700],marginBottom:"6px"},children:"Assunto:"}),(0,n.jsx)("input",{type:"text",value:u.subject,onChange:e=>x(t=>({...t,subject:e.target.value})),style:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"0.9rem",outline:"none"}})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,n.jsx)("button",{onClick:()=>x(e=>({...e,showEmailModal:!1})),style:{padding:"10px 20px",border:"1px solid #ddd",borderRadius:"8px",background:"white",color:a.rS.colors.neutral[700],cursor:"pointer",fontSize:"0.9rem"},children:"Cancelar"}),(0,n.jsx)("button",{onClick:()=>{if(!m)return;let{subject:e,body:t}=S(),o=u.recipient?encodeURIComponent(u.recipient):"",n="mailto:".concat(o,"?subject=").concat(e,"&body=").concat(t);window.open(n,"_self"),c(!1),x(e=>({...e,showEmailModal:!1}))},style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:a.rS.colors.primary[500],color:"white",cursor:"pointer",fontSize:"0.9rem",fontWeight:"600"},children:"Abrir E-mail"})]})]})})]})}}}]);