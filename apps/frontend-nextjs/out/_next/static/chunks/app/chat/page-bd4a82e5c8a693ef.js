(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{1340:function(e,a,t){Promise.resolve().then(t.bind(t,7740))},7740:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return S}});var r=t(7437),n=t(29),s=t.n(n),o=t(2265),i=t(7648),l=t(4768),c=t(3861);let d=e=>{try{let a=new URL(e);return["https:","http:"].includes(a.protocol)}catch(e){return!1}};function p(e){let{persona:a,personaId:t,size:n="medium",showStatus:i=!1,isTyping:l=!1,onClick:p,ariaLabel:u,className:m=""}=e,[x,f]=(0,o.useState)(!1),[g,b]=(0,o.useState)(!1),h=(0,o.useMemo)(()=>{let e=(0,c.Qu)(t);return e&&d(e)?e:null},[t]),y=(0,o.useMemo)(()=>{switch(n){case"small":return{width:"32px",height:"32px",fontSize:"1rem"};case"large":return{width:"64px",height:"64px",fontSize:"2rem"};default:return{width:"48px",height:"48px",fontSize:"1.5rem"}}},[n]),j=(0,o.useCallback)(()=>{f(!1),b(!1)},[]),v=(0,o.useCallback)(()=>{console.warn("Erro ao carregar avatar para persona ".concat(t,":"),h),f(!0),b(!1)},[t,h]),w=(0,o.useCallback)(()=>{b(!0)},[]),k=(0,o.useCallback)(()=>{p&&!g&&p()},[p,g]),S=(0,o.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&p&&!g&&(e.preventDefault(),p())},[p,g]),C="Avatar de ".concat(a.name).concat(l?", digitando":"").concat(i?", online":"");return(0,r.jsxs)("div",{role:p?"button":"img",tabIndex:p?0:-1,"aria-label":u||C,style:{position:"relative",display:"inline-block",cursor:p?"pointer":"default",outline:"none"},onClick:k,onKeyDown:S,className:"jsx-5912179cbb9301c9 "+(m||""),children:[(0,r.jsxs)("div",{style:{...y,borderRadius:"50%",background:x||!h?"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)":"white",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",boxShadow:"0 4px 12px rgba(25, 118, 210, 0.3)",transition:"all 0.3s ease",border:l?"3px solid #4caf50":"3px solid #f0f0f0",animation:l?"pulse 2s infinite":"none",overflow:"hidden"},onMouseEnter:e=>{p&&!g&&(e.currentTarget.style.transform="scale(1.1)",e.currentTarget.style.boxShadow="0 6px 20px rgba(25, 118, 210, 0.4)")},onMouseLeave:e=>{p&&(e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 12px rgba(25, 118, 210, 0.3)")},onFocus:e=>{p&&(e.currentTarget.style.outline="2px solid #1976d2",e.currentTarget.style.outlineOffset="2px")},onBlur:e=>{p&&(e.currentTarget.style.outline="none")},className:"jsx-5912179cbb9301c9",children:[g&&(0,r.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.8rem",color:"white"},className:"jsx-5912179cbb9301c9",children:"⏳"}),!x&&h?(0,r.jsx)("img",{src:h,alt:"Avatar de ".concat(a.name),loading:"lazy",decoding:"async",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%",opacity:g?.5:1,transition:"opacity 0.3s ease"},onError:v,onLoad:j,onLoadStart:w,className:"jsx-5912179cbb9301c9"}):(0,r.jsx)("span",{style:{fontSize:y.fontSize,color:"white",fontWeight:"bold",userSelect:"none"},"aria-hidden":"true",className:"jsx-5912179cbb9301c9",children:a.avatar||a.name.charAt(0).toUpperCase()})]}),i&&(0,r.jsx)("div",{"aria-label":l?"Digitando":"Online",style:{position:"absolute",bottom:"2px",right:"2px",width:"small"===n?"8px":"large"===n?"16px":"12px",height:"small"===n?"8px":"large"===n?"16px":"12px",borderRadius:"50%",background:l?"#4caf50":"#2196f3",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",animation:l?"pulse 2s infinite":"none"},className:"jsx-5912179cbb9301c9"}),l&&(0,r.jsx)("div",{"aria-live":"polite","aria-label":"Digitando",style:{position:"absolute",top:"-8px",right:"-8px",background:"#4caf50",color:"white",borderRadius:"12px",padding:"2px 6px",fontSize:"0.7rem",fontWeight:"bold",animation:"bounce 1s infinite",userSelect:"none",pointerEvents:"none"},className:"jsx-5912179cbb9301c9",children:(0,r.jsx)("span",{"aria-hidden":"true",className:"jsx-5912179cbb9301c9",children:"..."})}),(0,r.jsx)(s(),{id:"5912179cbb9301c9",children:"@-webkit-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-moz-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-o-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-webkit-keyframes bounce{0%,20%,50%,80%,100%{-webkit-transform:translatey(0);transform:translatey(0)}40%{-webkit-transform:translatey(-4px);transform:translatey(-4px)}60%{-webkit-transform:translatey(-2px);transform:translatey(-2px)}}@-moz-keyframes bounce{0%,20%,50%,80%,100%{-moz-transform:translatey(0);transform:translatey(0)}40%{-moz-transform:translatey(-4px);transform:translatey(-4px)}60%{-moz-transform:translatey(-2px);transform:translatey(-2px)}}@-o-keyframes bounce{0%,20%,50%,80%,100%{-o-transform:translatey(0);transform:translatey(0)}40%{-o-transform:translatey(-4px);transform:translatey(-4px)}60%{-o-transform:translatey(-2px);transform:translatey(-2px)}}@keyframes bounce{0%,20%,50%,80%,100%{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}40%{-webkit-transform:translatey(-4px);-moz-transform:translatey(-4px);-o-transform:translatey(-4px);transform:translatey(-4px)}60%{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px)}}"})]})}let u=e=>e.replace(/[<>"'&]/g,e=>({"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","&":"&amp;"})[e]||e);function m(e){var a;let{persona:t,personaId:n,currentInput:s,onSuggestionClick:i,isVisible:l=!0,onClose:c}=e,[d,p]=(0,o.useState)([]),[m,x]=(0,o.useState)(!1),[f,g]=(0,o.useState)(-1),[b,h]=(0,o.useState)(!1),y=(0,o.useMemo)(()=>({dose_calculation:["Como calcular a dose correta de PQT-U?","Quais fatores considerar na dosagem?","Como ajustar doses para diferentes idades?"],adverse_reactions:["Quais s\xe3o os efeitos colaterais mais comuns?","Como identificar rea\xe7\xf5es adversas graves?","O que fazer quando paciente tem alergia?"],clinical_cases:["Como diagnosticar hansen\xedase multibacilar?","Diferen\xe7as entre PB e MB?","Quando iniciar o tratamento?"],patient_education:["Como explicar o tratamento ao paciente?","Como motivar ades\xe3o ao tratamento?","Orienta\xe7\xf5es para fam\xedlia do paciente"],dispensation:["Protocolo correto de dispensa\xe7\xe3o","Como organizar cronograma mensal?","Documenta\xe7\xe3o necess\xe1ria"]}),[]),j=(0,o.useCallback)(e=>{if(!e||"string"!=typeof e)return[];let a=u(e).toLowerCase().trim(),r=[];if((a.includes("dose")||a.includes("quantidade")||a.includes("mg"))&&r.push(...y.dose_calculation),(a.includes("efeito")||a.includes("rea\xe7\xe3o")||a.includes("alergia"))&&r.push(...y.adverse_reactions),(a.includes("diagnos")||a.includes("sintoma")||a.includes("caso"))&&r.push(...y.clinical_cases),(a.includes("paciente")||a.includes("fam\xedlia")||a.includes("explicar"))&&r.push(...y.patient_education),(a.includes("dispensar")||a.includes("entregar")||a.includes("cronograma"))&&r.push(...y.dispensation),0===r.length){var n;r=(null===(n=t.example_questions)||void 0===n?void 0:n.slice(0,4))||[]}return Array.from(new Set(r)).slice(0,4)},[y,t.example_questions]);(0,o.useEffect)(()=>{h(!0);let e=setTimeout(()=>{try{if(s.length>2){let e=j(s);p(e),x(!0)}else if(0===s.length){var e;p((null===(e=t.example_questions)||void 0===e?void 0:e.slice(0,4))||[]),x(!0)}else x(!1);g(-1)}catch(e){console.error("Erro ao detectar contexto:",e),p([]),x(!1)}finally{h(!1)}},150);return()=>clearTimeout(e)},[s,t.example_questions,j]);let v=(0,o.useCallback)(e=>{switch(e.key){case"ArrowDown":e.preventDefault(),g(e=>(e+1)%d.length);break;case"ArrowUp":e.preventDefault(),g(e=>e<=0?d.length-1:e-1);break;case"Enter":e.preventDefault(),f>=0&&d[f]&&i(d[f]);break;case"Escape":e.preventDefault(),null==c||c()}},[d,f,i,c]),w=(0,o.useCallback)(e=>{try{i(e)}catch(e){console.error("Erro ao aplicar sugest\xe3o:",e)}},[i]);return l&&m&&(0!==d.length||b)?(0,r.jsxs)("div",{role:"listbox","aria-label":"Sugest\xf5es de perguntas","aria-live":"polite",onKeyDown:v,tabIndex:-1,style:{position:"absolute",bottom:"100%",left:0,right:0,background:"white",border:"1px solid #e0e0e0",borderRadius:"12px 12px 0 0",boxShadow:"0 -4px 12px rgba(0,0,0,0.1)",maxHeight:"200px",overflowY:"auto",zIndex:1e3},children:[(0,r.jsx)("div",{style:{padding:"12px 16px",borderBottom:"1px solid #f0f0f0",background:"#f8f9fa",borderRadius:"12px 12px 0 0"},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)("span",{style:{fontSize:"1rem"},children:"\uD83D\uDCA1"}),(0,r.jsx)("span",{style:{fontSize:"0.85rem",fontWeight:"bold",color:"#1976d2"},children:s.length>2?"Sugest\xf5es relacionadas":"Perguntas frequentes"})]})}),(0,r.jsx)("div",{style:{padding:"8px 0"},children:b?(0,r.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#666",fontSize:"0.9rem"},children:(0,r.jsx)("span",{children:"Carregando sugest\xf5es..."})}):d.map((e,a)=>{let t=a===f;return(0,r.jsx)("button",{role:"option","aria-selected":t,"aria-label":"Sugest\xe3o ".concat(a+1," de ").concat(d.length,": ").concat(e),onClick:()=>w(e),onMouseEnter:()=>g(a),onMouseLeave:()=>g(-1),style:{width:"100%",padding:"12px 16px",border:"none",background:t?"#e3f2fd":"transparent",textAlign:"left",cursor:"pointer",fontSize:"0.9rem",color:"#333",transition:"all 0.2s ease",borderBottom:a<d.length-1?"1px solid #f5f5f5":"none",outline:t?"2px solid #1976d2":"none",outlineOffset:"-2px"},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px"},children:[(0,r.jsx)("span",{style:{fontSize:"0.8rem",color:"#1976d2",marginTop:"2px",flexShrink:0},children:"?"}),(0,r.jsx)("span",{style:{lineHeight:"1.4",wordBreak:"break-word"},children:e})]})},"".concat(n,"-suggestion-").concat(a))})}),(0,r.jsx)("div",{style:{padding:"8px 16px",background:"#f8f9fa",borderTop:"1px solid #f0f0f0",fontSize:"0.75rem",color:"#666"},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,r.jsx)("span",{children:t.avatar}),(0,r.jsxs)("span",{children:["Especialidade: ",(null===(a=t.expertise)||void 0===a?void 0:a.slice(0,2).join(", "))||t.target_audience]})]})})]}):null}function x(e){let{conversations:a,currentConversationId:t,personas:n,onConversationSelect:s,onNewConversation:i,onDeleteConversation:l,onRenameConversation:c,isVisible:d,onToggle:u}=e,[m,x]=(0,o.useState)(null),[f,g]=(0,o.useState)(""),[b,h]=(0,o.useState)(null),[y,j]=(0,o.useState)(!1),[v,w]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=()=>{j(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let k=e=>{let a=Date.now()-e,t=Math.floor(a/6e4),r=Math.floor(a/36e5),n=Math.floor(a/864e5);return t<1?"agora":t<60?"".concat(t,"min"):r<24?"".concat(r,"h"):n<30?"".concat(n,"d"):new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})},S=e=>{x(e.id),g(e.title)},C=()=>{m&&f.trim()&&c(m,f.trim()),x(null),g("")},z=()=>{x(null),g("")},A=a.reduce((e,a)=>{let t=a.personaId;return e[t]||(e[t]=[]),e[t].push(a),e},{});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:u,style:{position:"fixed",top:"80px",left:d?"320px":"20px",zIndex:1001,background:"#1976d2",color:"white",border:"none",borderRadius:"50%",width:"48px",height:"48px",fontSize:"1.2rem",cursor:"pointer",boxShadow:"0 4px 12px rgba(25, 118, 210, 0.3)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.1)",e.currentTarget.style.boxShadow="0 6px 20px rgba(25, 118, 210, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 12px rgba(25, 118, 210, 0.3)"},children:d?"✕":"\uD83D\uDCAC"}),(0,r.jsxs)("div",{style:{position:"fixed",top:0,left:d?0:"-320px",width:"320px",height:"100vh",background:"white",borderRight:"1px solid #e0e0e0",boxShadow:"2px 0 10px rgba(0,0,0,0.1)",zIndex:1e3,transition:"left 0.3s ease",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,r.jsxs)("div",{style:{padding:"20px",background:"#f8f9fa",borderBottom:"1px solid #e0e0e0"},children:[(0,r.jsx)("h3",{style:{margin:0,fontSize:"1.2rem",color:"#333",display:"flex",alignItems:"center",gap:"8px"},children:"\uD83D\uDCAC Conversas"}),(0,r.jsxs)("p",{style:{margin:"5px 0 0 0",fontSize:"0.85rem",color:"#666"},children:[a.length," conversa",1!==a.length?"s":""]})]}),(0,r.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"10px 0"},children:[Object.entries(A).map(e=>{let[a,o]=e,c=n[a];return c?(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsxs)("div",{style:{padding:"10px 20px",display:"flex",alignItems:"center",gap:"10px",background:"#f5f7fa",borderBottom:"1px solid #e8eaf0"},children:[(0,r.jsx)(p,{persona:c,personaId:a,size:"small"}),(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"#333"},children:c.name}),(0,r.jsxs)("div",{style:{fontSize:"0.75rem",color:"#666"},children:[o.length," conversa",1!==o.length?"s":""]})]}),(0,r.jsx)("button",{onClick:()=>i(a),style:{background:"none",border:"none",color:"#1976d2",cursor:"pointer",fontSize:"1.2rem",padding:"4px",borderRadius:"4px"},title:"Nova conversa",children:"+"})]}),o.map(e=>(0,r.jsx)("div",{style:{padding:"12px 20px",borderBottom:"1px solid #f0f0f0",cursor:"pointer",background:e.id===t?"#e3f2fd":"transparent",borderLeft:e.id===t?"4px solid #1976d2":"4px solid transparent",position:"relative"},onMouseEnter:()=>h(e.id),onMouseLeave:()=>h(null),onClick:()=>s(e.id),children:m===e.id?(0,r.jsx)("div",{style:{display:"flex",gap:"5px"},children:(0,r.jsx)("input",{type:"text",value:f,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"===e.key&&C(),"Escape"===e.key&&z()},onBlur:C,autoFocus:!0,style:{flex:1,padding:"4px 8px",border:"1px solid #1976d2",borderRadius:"4px",fontSize:"0.9rem"}})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:e.id===t?"600":"normal",color:"#333",marginBottom:"4px",wordBreak:"break-word"},children:e.title}),(0,r.jsx)("div",{style:{fontSize:"0.75rem",color:"#666",marginBottom:"4px",wordBreak:"break-word"},children:e.lastMessage}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("span",{style:{fontSize:"0.7rem",color:"#999"},children:k(e.lastActivity)}),(0,r.jsxs)("span",{style:{fontSize:"0.7rem",color:"#999",background:"#f0f0f0",padding:"2px 6px",borderRadius:"10px"},children:[e.messageCount," msg"]})]}),b===e.id&&(0,r.jsxs)("div",{style:{position:"absolute",top:"8px",right:"8px",display:"flex",gap:"4px"},children:[(0,r.jsx)("button",{onClick:a=>{a.stopPropagation(),S(e)},style:{background:"white",border:"1px solid #ddd",borderRadius:"4px",padding:"4px 6px",fontSize:"0.7rem",cursor:"pointer"},title:"Renomear",children:"✏️"}),(0,r.jsx)("button",{onClick:a=>{a.stopPropagation(),confirm("Deseja excluir esta conversa?")&&l(e.id)},style:{background:"white",border:"1px solid #ddd",borderRadius:"4px",padding:"4px 6px",fontSize:"0.7rem",cursor:"pointer",color:"#d32f2f"},title:"Excluir",children:"\uD83D\uDDD1️"})]})]})},e.id))]},a):null}),0===a.length&&(0,r.jsxs)("div",{style:{padding:"40px 20px",textAlign:"center",color:"#666"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",marginBottom:"10px"},children:"\uD83D\uDCAC"}),(0,r.jsx)("p",{children:"Nenhuma conversa ainda"}),(0,r.jsx)("p",{style:{fontSize:"0.85rem",margin:0},children:"Comece uma nova conversa selecionando uma persona"})]})]})]}),d&&(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:999},onClick:u})]})}function f(e){var a,t;let{analysis:n,recommendedPersona:i,currentPersonaId:l,personas:c,onAcceptRouting:d,onRejectRouting:u,onShowExplanation:m,isMobile:x=!1,className:f=""}=e,[g,b]=(0,o.useState)(!0),[h,y]=(0,o.useState)(!1),[j,v]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=setTimeout(()=>{v(!0)},3e3);return()=>clearTimeout(e)},[]);let w=(0,o.useCallback)(()=>{d(n.recommendedPersonaId),b(!1)},[n.recommendedPersonaId,d]);(0,o.useCallback)(()=>{u(),b(!1)},[u]);let k=(0,o.useCallback)(()=>{y(!h),m()},[h,m]),S=l===n.recommendedPersonaId;return g?(0,r.jsxs)("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",border:"1px solid #2196f3",borderRadius:"12px",margin:x?"8px 0":"12px 0",padding:x?"12px":"16px",boxShadow:"0 2px 8px rgba(33, 150, 243, 0.2)",opacity:j?.7:1,transition:"all 0.3s ease",position:"relative"},role:"alert","aria-live":"polite",className:"jsx-37a81b79a982207d "+(f||""),children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:x?"8px":"12px",marginBottom:h?"12px":"0",flexWrap:x?"wrap":"nowrap"},className:"jsx-37a81b79a982207d",children:[(0,r.jsx)("div",{style:{fontSize:"1.2rem",animation:"spin 2s linear infinite"},className:"jsx-37a81b79a982207d",children:"\uD83D\uDD04"}),(0,r.jsx)(p,{persona:i,personaId:n.recommendedPersonaId,size:"small",showStatus:!1,ariaLabel:"Avatar de ".concat(i.name,", especialista recomendado")}),(0,r.jsxs)("div",{style:{flex:1,minWidth:0},className:"jsx-37a81b79a982207d",children:[(0,r.jsx)("div",{style:{fontSize:x?"0.85rem":"0.9rem",fontWeight:"bold",color:"#1976d2",marginBottom:"2px"},className:"jsx-37a81b79a982207d",children:S?"Continuando com ".concat(i.name):"Roteando para ".concat(i.name)}),(0,r.jsx)("div",{style:{fontSize:x?"0.75rem":"0.8rem",color:"#666"},className:"jsx-37a81b79a982207d",children:n.reasoning})]}),(0,r.jsxs)("div",{style:{fontSize:"0.7rem",padding:"2px 6px",borderRadius:"10px",background:(a=n.confidence)>=.8?"#4caf50":a>=.6?"#ff9800":"#f44336",color:"white",fontWeight:"bold",whiteSpace:"nowrap"},className:"jsx-37a81b79a982207d",children:[Math.round(100*n.confidence),"%"]})]}),!S&&(0,r.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:x?"wrap":"nowrap"},className:"jsx-37a81b79a982207d",children:[(0,r.jsx)("button",{onClick:w,style:{background:"#1976d2",color:"white",border:"none",borderRadius:"6px",padding:x?"6px 12px":"8px 16px",fontSize:x?"0.8rem":"0.85rem",fontWeight:"bold",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#1565c0"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#1976d2"},"aria-label":"Aceitar roteamento para ".concat(i.name),className:"jsx-37a81b79a982207d",children:"✓ Continuar"}),Object.keys(c).length>1&&(0,r.jsxs)("select",{onChange:e=>{e.target.value&&e.target.value!==n.recommendedPersonaId&&(d(e.target.value),b(!1))},style:{padding:x?"6px 8px":"8px 12px",borderRadius:"6px",border:"1px solid #ccc",fontSize:x?"0.8rem":"0.85rem",background:"white",cursor:"pointer"},"aria-label":"Escolher especialista alternativo",className:"jsx-37a81b79a982207d",children:[(0,r.jsx)("option",{value:"",className:"jsx-37a81b79a982207d",children:"Trocar por..."}),Object.entries(c).map(e=>{let[a,t]=e;return a!==n.recommendedPersonaId?(0,r.jsx)("option",{value:a,className:"jsx-37a81b79a982207d",children:t.name},a):null})]}),(0,r.jsx)("button",{onClick:k,style:{background:"transparent",border:"1px solid #1976d2",color:"#1976d2",borderRadius:"6px",padding:x?"6px 8px":"8px 12px",fontSize:x?"0.7rem":"0.8rem",cursor:"pointer",whiteSpace:"nowrap"},"aria-label":h?"Ocultar explica\xe7\xe3o":"Mostrar explica\xe7\xe3o",className:"jsx-37a81b79a982207d",children:h?"Ocultar":"Por qu\xea?"})]}),h&&(0,r.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(255, 255, 255, 0.7)",borderRadius:"8px",fontSize:x?"0.8rem":"0.85rem",lineHeight:"1.4"},className:"jsx-37a81b79a982207d",children:[(0,r.jsx)("div",{style:{marginBottom:"8px"},className:"jsx-37a81b79a982207d",children:(0,r.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"An\xe1lise de especializa\xe7\xe3o:"})}),(0,r.jsxs)("div",{style:{marginBottom:"8px"},className:"jsx-37a81b79a982207d",children:["• ",(0,r.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"Escopo:"})," ",n.scope]}),(0,r.jsxs)("div",{style:{marginBottom:"8px"},className:"jsx-37a81b79a982207d",children:["• ",(0,r.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"Confian\xe7a:"})," ",(t=n.confidence)>=.8?"Alta confian\xe7a":t>=.6?"M\xe9dia confian\xe7a":"Baixa confian\xe7a"," (",Math.round(100*n.confidence),"%)"]}),(0,r.jsxs)("div",{style:{marginBottom:"8px"},className:"jsx-37a81b79a982207d",children:["• ",(0,r.jsxs)("strong",{className:"jsx-37a81b79a982207d",children:["Expertise de ",i.name,":"]})," ",i.target_audience]}),n.alternatives.length>0&&(0,r.jsxs)("div",{className:"jsx-37a81b79a982207d",children:["• ",(0,r.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"Alternativas:"})," ",n.alternatives.map(e=>{var a;return null===(a=c[e.personaId])||void 0===a?void 0:a.name}).join(", ")]})]}),(0,r.jsx)("button",{onClick:()=>b(!1),style:{position:"absolute",top:"8px",right:"8px",background:"transparent",border:"none",fontSize:"1rem",cursor:"pointer",color:"#666",width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(0,0,0,0.1)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},"aria-label":"Fechar indicador de roteamento",className:"jsx-37a81b79a982207d",children:"✕"}),(0,r.jsx)(s(),{id:"37a81b79a982207d",children:"@-webkit-keyframes spin{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]}):null}var g=t(44),b=t(8223);let h="conversation-history",y={dr_gasnelio:{personaId:"dr_gasnelio",expertiseAreas:["clinical","dosage","protocols","diagnosis","treatment"],keywords:["dose","dosagem","mg","rifampicina","dapsona","clofazimina","protocolo","tratamento","diagn\xf3stico","cl\xednico","m\xe9dico","prescri\xe7\xe3o","posologia","terap\xeautica","PQT-U","PQT","multibacilar","paucibacilar","MB","PB","esquema","rea\xe7\xe3o","efeito colateral","contraindica\xe7\xe3o","intera\xe7\xe3o"],specialties:["Dosagens","Protocolos Cl\xednicos","Diagn\xf3stico"]},ga:{personaId:"ga",expertiseAreas:["education","dispensation","family","guidance","support"],keywords:["paciente","fam\xedlia","educa\xe7\xe3o","orienta\xe7\xe3o","ensino","dispensa\xe7\xe3o","farm\xe1cia","entrega","cronograma","organiza\xe7\xe3o","ader\xeancia","ades\xe3o","motiva\xe7\xe3o","apoio","comunica\xe7\xe3o","explicar","ensinar","orientar","acompanhar","conversar","d\xfavidas","medo","preconceito","estigma","social"],specialties:["Educa\xe7\xe3o do Paciente","Dispensa\xe7\xe3o","Apoio Familiar"]}};class j{set(e,a){let t=this.normalizeQuestion(e);this.cache.set(t,{analysis:a,timestamp:Date.now()}),this.cleanupExpired()}get(e){let a=this.normalizeQuestion(e),t=this.cache.get(a);return t&&Date.now()-t.timestamp<this.TTL?t.analysis:(t&&this.cache.delete(a),null)}normalizeQuestion(e){return e.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g," ").trim()}cleanupExpired(){let e=Date.now();Array.from(this.cache.entries()).forEach(a=>{let[t,r]=a;e-r.timestamp>=this.TTL&&this.cache.delete(t)})}constructor(){this.cache=new Map,this.TTL=3e5}}let v=new j;async function w(e,a){try{let t=v.get(e);if(t)return t;let r=k(e,a),n=null;try{n=await (0,b.$N)(e)}catch(e){console.warn("Backend scope detection failed, using local analysis:",e)}let s=function(e,a,t){if(!a||!a.recommended_persona)return e;let r=a.recommended_persona;if(t[r]){let t=a.confidence||.5,n=(e.confidence+t)/2;if(r===e.recommendedPersonaId)return{...e,confidence:Math.min(.95,n+.2),reasoning:"".concat(e.reasoning," (confirmado por IA)")};if(t>e.confidence)return{recommendedPersonaId:r,confidence:n,reasoning:a.reasoning||"Recomendado por an\xe1lise de IA",scope:a.scope||e.scope,alternatives:[{personaId:e.recommendedPersonaId,confidence:e.confidence,reasoning:e.reasoning},...e.alternatives]}}return e}(r,n,a);return v.set(e,s),s}catch(t){return console.error("Erro na an\xe1lise de roteamento:",t),k(e,a)}}function k(e,a){var t;let r=e.toLowerCase(),n={},s={};Object.keys(a).forEach(e=>{let a=y[e];if(!a)return;let t=0,o=[];a.keywords.forEach(e=>{r.includes(e.toLowerCase())&&(t+=e.length>6?2:1,o.push(e))}),a.expertiseAreas.forEach(e=>{r.includes(e)&&(t+=3,o.push(e))}),n[e]=t,s[e]=o});let o=Object.entries(n).sort((e,a)=>{let[,t]=e,[,r]=a;return r-t}).filter(e=>{let[,a]=e;return a>0});if(0===o.length){let e="dr_gasnelio";return{recommendedPersonaId:e,confidence:.3,reasoning:"Quest\xe3o geral - roteado para especialista cl\xednico",scope:"general",alternatives:Object.keys(a).filter(a=>a!==e).map(e=>({personaId:e,confidence:.2,reasoning:"Alternativa dispon\xedvel"}))}}let[i,l]=o[0],c=(null===(t=y[i])||void 0===t?void 0:t.keywords.length)||1,d=s[i]||[];return{recommendedPersonaId:i,confidence:Math.min(.95,l/c*.8+.2),reasoning:d.length>0?"Especialista em: ".concat(d.slice(0,3).join(", ")):"Melhor correspond\xeancia de expertise",scope:["dose","dosagem","mg","quantidade","posologia"].some(e=>r.includes(e))?"dosage":["diagn\xf3stico","sintoma","caso","tratamento","protocolo"].some(e=>r.includes(e))?"clinical":["paciente","fam\xedlia","explicar","ensinar","orientar"].some(e=>r.includes(e))?"education":["dispensar","farm\xe1cia","entrega","cronograma"].some(e=>r.includes(e))?"dispensation":"general",alternatives:o.slice(1,3).map(e=>{var a;let[t,r]=e;return{personaId:t,confidence:Math.min(.8,r/c*.6+.1),reasoning:(null===(a=s[t])||void 0===a?void 0:a.length)>0?"Tamb\xe9m especialista em: ".concat(s[t].slice(0,2).join(", ")):"Alternativa com expertise relacionada"}})}}function S(){let{personas:e,loading:a,error:t}=(0,g.H)(),{messages:n,loading:c,error:d,sendMessage:u}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{persistToLocalStorage:a=!0,storageKey:t="chat-history"}=e,[r,n]=(0,o.useState)(()=>{if(!a)return[];try{let e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(e){return console.error("Erro ao carregar hist\xf3rico do chat:",e),[]}}),[s,i]=(0,o.useState)(!1),[l,c]=(0,o.useState)(null),d=(0,o.useCallback)(e=>{if(a)try{localStorage.setItem(t,JSON.stringify(e))}catch(e){console.error("Erro ao salvar hist\xf3rico do chat:",e)}},[a,t]),p=(0,o.useCallback)(async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e.trim())return;let s={role:"user",content:e.trim(),timestamp:Date.now(),persona:a};if(0===t){let e=[...r,s];n(e),d(e)}i(!0),c(null);try{let o=0===t?[...r,s]:r,i={message:e.trim(),persona:a,conversation_history:o.slice(-10)},l=await (0,b.bE)(i),c={role:"assistant",content:l.response,timestamp:l.timestamp,persona:l.persona},p=[...o,c];n(p),d(p)}catch(r){if(console.error("Erro ao enviar mensagem (tentativa ".concat(t+1,"):"),r),t<3)setTimeout(()=>{p(e,a,t+1)},1e3*Math.pow(2,t)),c("Tentando novamente... (".concat(t+1,"/").concat(3,")"));else{let e=r instanceof Error?r.message:"Erro ao enviar mensagem";c("".concat(e," (Falha ap\xf3s ").concat(3," tentativas)")),i(!1)}}t>=3&&i(!1)},[r,d]),u=(0,o.useCallback)(()=>{n([]),a&&localStorage.removeItem(t)},[a,t]),m=(0,o.useCallback)(e=>r.filter(a=>a.persona===e),[r]);return{messages:r,loading:s,error:l,sendMessage:p,clearMessages:u,getMessagesForPersona:m}}({persistToLocalStorage:!1}),{createConversation:j,switchToConversation:v,deleteConversation:k,renameConversation:S,addMessageToConversation:C,getCurrentMessages:z,getConversationsForPersona:A,currentConversationId:N}=function(){let[e,a]=(0,o.useState)([]),[t,r]=(0,o.useState)(null),[n,s]=(0,o.useState)(!1),[i,l]=(0,o.useState)(null),c=(0,o.useRef)(null);(0,o.useEffect)(()=>{try{s(!0);let e=localStorage.getItem(h);if(e){let t=JSON.parse(e);if(Array.isArray(t)){let e=t.filter(e=>e&&"object"==typeof e&&e.id&&e.personaId).slice(0,50);a(e)}}l(null)}catch(e){console.error("Erro ao carregar hist\xf3rico de conversas:",e),l("Erro ao carregar hist\xf3rico de conversas"),a([])}finally{s(!1)}},[]);let d=(0,o.useCallback)(e=>{c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{try{let a=e.slice(0,50).map(e=>({...e,messages:e.messages.slice(-100)})),t=JSON.stringify(a);if(t.length>4718592){console.warn("Dados muito grandes para localStorage, limpando conversas antigas");let e=a.slice(0,Math.floor(25));localStorage.setItem(h,JSON.stringify(e))}else localStorage.setItem(h,t);l(null)}catch(a){console.error("Erro ao salvar hist\xf3rico de conversas:",a),l("Erro ao salvar hist\xf3rico de conversas");try{let a=e.slice(0,10);localStorage.setItem(h,JSON.stringify(a))}catch(e){console.error("Erro cr\xedtico ao salvar:",e)}}},300)},[]),p=(0,o.useCallback)(e=>{try{if(!e||"string"!=typeof e)return"Nova conversa";let a=e.replace(/[^\w\sÀ-ſ]/gi,"").trim().split(" ").filter(e=>e.length>0).slice(0,6).join(" ");return a.length>40&&(a=a.substring(0,37)+"..."),a.length<3&&(a="Nova conversa"),a}catch(e){return console.error("Erro ao gerar t\xedtulo da conversa:",e),"Nova conversa"}},[]),u=(0,o.useCallback)((t,n)=>{try{if(!t||"string"!=typeof t)throw Error("personaId \xe9 obrigat\xf3rio");let s="conv_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),o=Date.now(),i=[{id:s,personaId:t,title:n?p(n):"Nova conversa",messages:[],lastActivity:o,createdAt:o},...e];return a(i),d(i),r(s),l(null),s}catch(e){return console.error("Erro ao criar conversa:",e),l("Erro ao criar nova conversa"),""}},[e,d,p]),m=(0,o.useCallback)(()=>t&&e.find(e=>e.id===t)||null,[t,e]),x=(0,o.useCallback)(r=>{if(t&&r)try{if(!r.content||!r.role||!r.timestamp)throw Error("Mensagem inv\xe1lida");let n=e.map(e=>{if(e.id===t){let a={...e,messages:[...e.messages,r].slice(-100),lastActivity:Date.now()};return 0===e.messages.length&&"user"===r.role&&(a.title=p(r.content)),a}return e});a(n),d(n),l(null)}catch(e){console.error("Erro ao adicionar mensagem:",e),l("Erro ao adicionar mensagem \xe0 conversa")}},[t,e,d,p]),f=(0,o.useCallback)(()=>{let e=m();return(null==e?void 0:e.messages)||[]},[m]),g=(0,o.useCallback)(a=>e.filter(e=>e.personaId===a).sort((e,a)=>a.lastActivity-e.lastActivity).map(e=>({id:e.id,personaId:e.personaId,title:e.title,lastMessage:e.messages.length>0?e.messages[e.messages.length-1].content.substring(0,50)+"...":"Conversa vazia",lastActivity:e.lastActivity,messageCount:e.messages.length})),[e]),b=(0,o.useCallback)(e=>{r(e)},[]),y=(0,o.useCallback)(n=>{let s=e.filter(e=>e.id!==n);a(s),d(s),t===n&&r(null)},[e,t,d]),j=(0,o.useCallback)((t,r)=>{let n=e.map(e=>e.id===t?{...e,title:r.trim()||"Conversa sem t\xedtulo"}:e);a(n),d(n)},[e,d]),v=(0,o.useCallback)(()=>{a([]),r(null),localStorage.removeItem("conversation-history")},[]),w=(0,o.useCallback)(()=>({totalConversations:e.length,totalMessages:e.reduce((e,a)=>e+a.messages.length,0),personaStats:e.reduce((e,a)=>(e[a.personaId]=(e[a.personaId]||0)+1,e),{})}),[e]);return(0,o.useEffect)(()=>()=>{c.current&&clearTimeout(c.current)},[]),{conversations:e,currentConversationId:t,loading:n,error:i,getCurrentConversation:m,getCurrentMessages:f,createConversation:u,switchToConversation:b,deleteConversation:y,renameConversation:j,clearAllConversations:v,addMessageToConversation:x,getConversationsForPersona:g,getStatistics:w,clearError:()=>l(null)}}(),[E,I]=(0,o.useState)(""),[D,T]=(0,o.useState)(null),[R,P]=(0,o.useState)(!1),[M,B]=(0,o.useState)(!1),[O,L]=(0,o.useState)(!1),[_,W]=(0,o.useState)(!1),[H,F]=(0,o.useState)(""),Q=(0,o.useRef)(null),q=(0,o.useRef)(null);(0,o.useEffect)(()=>{let e=()=>{W(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let U=z(),{currentAnalysis:J,isAnalyzing:V,shouldShowRouting:Y,getRecommendedPersona:G,analyzeQuestion:K,acceptRecommendation:Z,rejectRecommendation:$,clearAnalysis:X,getExplanation:ee}=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{enabled:t=!0,debounceMs:r=800,minConfidenceThreshold:n=.4}=a,[s,i]=(0,o.useState)({currentAnalysis:null,isAnalyzing:!1,error:null,hasAnalyzed:!1}),l=(0,o.useRef)(null),c=(0,o.useRef)(""),d=(0,o.useRef)({acceptedRecommendations:0,rejectedRecommendations:0,totalAnalyses:0});(0,o.useEffect)(()=>()=>{l.current&&clearTimeout(l.current)},[]);let p=(0,o.useCallback)(async a=>{if(!t||!a.trim()||0===Object.keys(e).length)return;let s=a.trim();s!==c.current&&(c.current=s,l.current&&clearTimeout(l.current),l.current=setTimeout(async()=>{i(e=>({...e,isAnalyzing:!0,error:null}));try{let a=await w(s,e);a.confidence>=n?(i(e=>({...e,currentAnalysis:a,isAnalyzing:!1,hasAnalyzed:!0})),d.current.totalAnalyses++):i(e=>({...e,currentAnalysis:null,isAnalyzing:!1,hasAnalyzed:!0}))}catch(e){console.error("Erro na an\xe1lise de roteamento:",e),i(a=>({...a,currentAnalysis:null,isAnalyzing:!1,error:e instanceof Error?e.message:"Erro na an\xe1lise",hasAnalyzed:!0}))}},r))},[t,e,n,r]),u=(0,o.useCallback)(()=>{s.currentAnalysis&&(d.current.acceptedRecommendations++,console.log("Routing recommendation accepted:",{personaId:s.currentAnalysis.recommendedPersonaId,confidence:s.currentAnalysis.confidence,scope:s.currentAnalysis.scope}))},[s.currentAnalysis]),m=(0,o.useCallback)(e=>{s.currentAnalysis&&(d.current.rejectedRecommendations++,console.log("Routing recommendation rejected:",{recommended:s.currentAnalysis.recommendedPersonaId,selected:e,confidence:s.currentAnalysis.confidence,scope:s.currentAnalysis.scope,reasoning:s.currentAnalysis.reasoning})),i(e=>({...e,currentAnalysis:null}))},[s.currentAnalysis]),x=(0,o.useCallback)(()=>{i(e=>({...e,currentAnalysis:null,error:null,hasAnalyzed:!1})),c.current="",l.current&&clearTimeout(l.current)},[]),f=(0,o.useCallback)(()=>s.currentAnalysis?function(e,a){let t=a[e.recommendedPersonaId];if(!t)return e.reasoning;let r=y[e.recommendedPersonaId]||null,n=(null==r?void 0:r.specialties.join(", "))||"quest\xf5es especializadas";return"".concat(t.name," especializa-se em ").concat(n,". ").concat(e.reasoning)}(s.currentAnalysis,e):"Nenhuma an\xe1lise dispon\xedvel",[s.currentAnalysis,e]),g=(0,o.useCallback)(()=>!!s.currentAnalysis&&s.currentAnalysis.confidence<.6,[s.currentAnalysis]),b=(0,o.useCallback)(()=>{let e=d.current,a=e.totalAnalyses>0?e.acceptedRecommendations/e.totalAnalyses*100:0;return{...e,acceptanceRate:Math.round(a)}},[]),h=(0,o.useCallback)(()=>!!(s.currentAnalysis&&s.currentAnalysis.confidence>=n&&!s.isAnalyzing),[s.currentAnalysis,s.isAnalyzing,n]),j=(0,o.useCallback)(()=>s.currentAnalysis&&e[s.currentAnalysis.recommendedPersonaId]||null,[s.currentAnalysis,e]),v=(0,o.useCallback)(()=>s.currentAnalysis?s.currentAnalysis.alternatives.filter(a=>e[a.personaId]).map(a=>({...a,persona:e[a.personaId]})):[],[s.currentAnalysis,e]);return{currentAnalysis:s.currentAnalysis,isAnalyzing:s.isAnalyzing,error:s.error,hasAnalyzed:s.hasAnalyzed,analyzeQuestion:p,acceptRecommendation:u,rejectRecommendation:m,clearAnalysis:x,getExplanation:f,isAmbiguous:g,getAnalytics:b,shouldShowRouting:h,getRecommendedPersona:j,getAlternatives:v}}(e,{enabled:!0,debounceMs:1e3,minConfidenceThreshold:.6});(0,o.useEffect)(()=>{!D&&E.length>10&&K(E)},[E,D,K]),(0,o.useEffect)(()=>{{let a=localStorage.getItem("selectedPersona");a&&e[a]&&(T(a),N||j(a))}},[e,N,j]),(0,o.useEffect)(()=>{var e;null===(e=Q.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[U]),(0,o.useEffect)(()=>{n.forEach(e=>{C(e)})},[n,C]);let ea=async e=>{if(e.preventDefault(),!E.trim())return;let a=E.trim();if(!D){F(a),await K(a);return}if(!c){I(""),P(!1),B(!0);try{await u(a,D)}finally{B(!1)}}},et=e=>{T(e),localStorage.setItem("selectedPersona",e),j(e),X(),H&&(I(H),F(""))},er=(0,o.useCallback)(e=>{Z(),et(e)},[Z]),en=(0,o.useCallback)(()=>{$(D||"")},[$,D]),es=(0,o.useCallback)(()=>{console.log("Explica\xe7\xe3o do roteamento:",ee())},[ee]);if(a)return(0,r.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",marginBottom:"20px"},children:"⏳"}),(0,r.jsx)("p",{children:"Carregando chat..."})]})});if(t)return(0,r.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",marginBottom:"20px"},children:"⚠️"}),(0,r.jsxs)("p",{children:["Erro ao carregar chat: ",t]}),(0,r.jsx)(i.default,{href:"/",style:{color:"#1976d2",textDecoration:"underline"},children:"Voltar ao in\xedcio"})]})});let eo=D?e[D]:null;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{currentPersona:null==eo?void 0:eo.name}),(0,r.jsx)(x,{conversations:Object.values(e).flatMap(a=>{let t=Object.keys(e).find(t=>e[t]===a);return t?A(t):[]}),currentConversationId:N,personas:e,onConversationSelect:a=>{v(a);let t=Object.values(e).flatMap(a=>A(Object.keys(e).find(t=>e[t]===a)||"")).find(e=>e.id===a);t&&(T(t.personaId),localStorage.setItem("selectedPersona",t.personaId)),X()},onNewConversation:e=>{j(e),T(e),localStorage.setItem("selectedPersona",e)},onDeleteConversation:k,onRenameConversation:S,isVisible:O,onToggle:()=>L(!O)}),(0,r.jsxs)("div",{style:{height:"100vh",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",marginLeft:O&&!_?"320px":"0",transition:"margin-left 0.3s ease"},className:"jsx-81480df78bbb953a main-content",children:[(0,r.jsxs)("div",{style:{background:"#1976d2",color:"white",padding:_?"12px 15px":"15px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",minHeight:"60px"},className:"jsx-81480df78bbb953a",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"15px"},className:"jsx-81480df78bbb953a",children:[(0,r.jsx)(i.default,{href:"/",style:{color:"white",textDecoration:"none",fontSize:"1.5rem"},children:"←"}),eo&&D&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p,{persona:eo,personaId:D,size:"medium",showStatus:!0,isTyping:M}),(0,r.jsxs)("div",{style:{minWidth:0,flex:1},className:"jsx-81480df78bbb953a",children:[(0,r.jsx)("h2",{style:{margin:0,fontSize:_?"1rem":"1.2rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},className:"jsx-81480df78bbb953a",children:eo.name}),!_&&(0,r.jsx)("p",{style:{margin:0,fontSize:"0.9rem",opacity:.8},className:"jsx-81480df78bbb953a",children:eo.personality})]})]})]}),(0,r.jsxs)("select",{value:D||"",onChange:e=>et(e.target.value),style:{padding:_?"6px 10px":"8px 12px",borderRadius:"8px",border:"none",background:"rgba(255,255,255,0.2)",color:"white",fontSize:_?"0.8rem":"0.9rem",maxWidth:_?"140px":"auto"},className:"jsx-81480df78bbb953a",children:[(0,r.jsx)("option",{value:"",className:"jsx-81480df78bbb953a",children:"Escolher assistente..."}),Object.entries(e).map(e=>{let[a,t]=e;return(0,r.jsx)("option",{value:a,style:{color:"black"},className:"jsx-81480df78bbb953a",children:t.name},a)})]})]}),(0,r.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:_?"15px 10px":"20px",display:"flex",flexDirection:"column",gap:_?"12px":"15px"},className:"jsx-81480df78bbb953a",children:[!D&&!Y()&&(0,r.jsx)("div",{style:{textAlign:"center",padding:"40px",background:"rgba(255,255,255,0.7)",borderRadius:"12px",margin:"20px"},className:"jsx-81480df78bbb953a",children:(0,r.jsx)("p",{style:{fontSize:"1.1rem",color:"#666"},className:"jsx-81480df78bbb953a",children:H?"Analisando sua pergunta para encontrar o melhor especialista...":"Digite sua pergunta ou selecione um assistente no menu acima"})}),Y()&&J&&G()&&(0,r.jsx)(f,{analysis:J,recommendedPersona:G(),currentPersonaId:D,personas:e,onAcceptRouting:er,onRejectRouting:en,onShowExplanation:es,isMobile:_}),U.map(e=>(0,r.jsx)("div",{style:{display:"flex",justifyContent:"user"===e.role?"flex-end":"flex-start",marginBottom:"10px"},className:"jsx-81480df78bbb953a",children:(0,r.jsxs)("div",{style:{maxWidth:_?"85%":"70%",padding:_?"10px 14px":"12px 16px",borderRadius:"18px",background:"user"===e.role?"#1976d2":"white",color:"user"===e.role?"white":"#333",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontSize:_?"0.9rem":"0.95rem",lineHeight:"1.4",wordBreak:"break-word"},className:"jsx-81480df78bbb953a",children:["assistant"===e.role&&eo&&D&&(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},className:"jsx-81480df78bbb953a",children:[(0,r.jsx)(p,{persona:eo,personaId:D,size:"small"}),(0,r.jsx)("span",{style:{fontSize:"0.8rem",fontWeight:"bold",color:"#1976d2"},className:"jsx-81480df78bbb953a",children:eo.name})]}),(0,r.jsx)("div",{style:{whiteSpace:"pre-wrap"},className:"jsx-81480df78bbb953a",children:e.content})]})},"".concat(e.role,"-").concat(e.timestamp))),c&&eo&&D&&(0,r.jsx)("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"10px"},className:"jsx-81480df78bbb953a",children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",borderRadius:"18px",background:"white",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},className:"jsx-81480df78bbb953a",children:[(0,r.jsx)(p,{persona:eo,personaId:D,size:"small",isTyping:!0}),(0,r.jsxs)("div",{style:{display:"flex",gap:"4px",alignItems:"center"},className:"jsx-81480df78bbb953a",children:[(0,r.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#4caf50",animation:"pulse 1.5s infinite"},className:"jsx-81480df78bbb953a"}),(0,r.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#4caf50",animation:"pulse 1.5s infinite 0.5s"},className:"jsx-81480df78bbb953a"}),(0,r.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#4caf50",animation:"pulse 1.5s infinite 1s"},className:"jsx-81480df78bbb953a"}),(0,r.jsxs)("span",{style:{marginLeft:"8px",fontSize:"0.9rem",color:"#666"},className:"jsx-81480df78bbb953a",children:[eo.name," est\xe1 pensando..."]})]})]})}),d&&(0,r.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",background:"#ffebee",color:"#c62828",textAlign:"center",margin:"10px 0"},className:"jsx-81480df78bbb953a",children:["Erro: ",d]}),(0,r.jsx)("div",{ref:Q,className:"jsx-81480df78bbb953a"})]}),(0,r.jsxs)("div",{style:{position:"relative",padding:_?"15px 10px":"20px",background:"white",borderTop:"1px solid #eee"},className:"jsx-81480df78bbb953a",children:[D&&eo&&(0,r.jsx)(m,{persona:eo,personaId:D,currentInput:E,onSuggestionClick:e=>{var a;I(e),null===(a=q.current)||void 0===a||a.focus()},isVisible:R&&(0===E.length||E.length>2)}),(0,r.jsxs)("form",{onSubmit:ea,style:{display:"flex",gap:_?"8px":"10px",alignItems:"flex-end"},className:"jsx-81480df78bbb953a",children:[(0,r.jsx)("input",{ref:q,type:"text",value:E,onChange:e=>I(e.target.value),onFocus:()=>P(!0),onBlur:()=>setTimeout(()=>P(!1),200),placeholder:D?"Pergunte ao ".concat(null==eo?void 0:eo.name,"..."):V?"Analisando pergunta...":"Digite sua pergunta aqui...",disabled:c,style:{flex:1,padding:_?"12px 14px":"12px 16px",borderRadius:"25px",border:"1px solid #ddd",fontSize:_?"16px":"1rem",outline:"none",background:D?"white":"#f5f5f5",minHeight:_?"44px":"auto"},className:"jsx-81480df78bbb953a"}),(0,r.jsx)("button",{type:"submit",disabled:!D||!E.trim()||c,style:{padding:_?"12px 18px":"12px 20px",borderRadius:"25px",border:"none",background:D&&E.trim()&&!c?"#1976d2":"#ccc",color:"white",cursor:D&&E.trim()&&!c?"pointer":"not-allowed",fontSize:_?"1.1rem":"1rem",fontWeight:"bold",minHeight:_?"44px":"auto",minWidth:_?"44px":"auto"},className:"jsx-81480df78bbb953a",children:c?"⏳":"➤"})]})]}),(0,r.jsx)(s(),{id:"81480df78bbb953a",children:"@-webkit-keyframes pulse{0%,80%,100%{opacity:.3}40%{opacity:1}}@-moz-keyframes pulse{0%,80%,100%{opacity:.3}40%{opacity:1}}@-o-keyframes pulse{0%,80%,100%{opacity:.3}40%{opacity:1}}@keyframes pulse{0%,80%,100%{opacity:.3}40%{opacity:1}}"})]})]})}},4768:function(e,a,t){"use strict";t.d(a,{Z:function(){return c}});var r=t(7437),n=t(29),s=t.n(n),o=t(7648),i=t(9376),l=t(2265);function c(e){let{currentPersona:a}=e,t=(0,i.usePathname)(),[n,c]=(0,l.useState)(!1),d=e=>"/"===e?"/"===t:t.startsWith(e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>c(!n),style:{position:"fixed",top:"20px",left:"20px",zIndex:1e3,background:"#1976d2",color:"white",border:"none",borderRadius:"50%",width:"50px",height:"50px",fontSize:"1.5rem",cursor:"pointer",boxShadow:"0 4px 12px rgba(0,0,0,0.2)",display:"block"},className:"jsx-8b16e275268ec1c7 lg:hidden",children:n?"✕":"☰"}),n&&(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:998},onClick:()=>c(!1),className:"jsx-8b16e275268ec1c7"}),(0,r.jsxs)("nav",{style:{position:"fixed",top:0,left:n?0:"-300px",width:"280px",height:"100vh",background:"linear-gradient(180deg, #1976d2 0%, #1565c0 100%)",color:"white",transition:"left 0.3s ease",zIndex:999,overflowY:"auto",boxShadow:"4px 0 20px rgba(0,0,0,0.1)"},className:"jsx-8b16e275268ec1c7 lg:left-0",children:[(0,r.jsxs)("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},className:"jsx-8b16e275268ec1c7",children:[(0,r.jsx)("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:"bold"},className:"jsx-8b16e275268ec1c7",children:"PQT-U Educacional"}),a&&(0,r.jsxs)("p",{style:{margin:"5px 0 0",fontSize:"0.9rem",opacity:.8},className:"jsx-8b16e275268ec1c7",children:["Assistente: ",a]})]}),(0,r.jsx)("div",{style:{padding:"20px 0"},className:"jsx-8b16e275268ec1c7",children:[{id:"home",label:"In\xedcio",href:"/",icon:"\uD83C\uDFE0",description:"Sele\xe7\xe3o de assistentes virtuais"},{id:"dashboard",label:"Dashboard",href:"/dashboard",icon:"\uD83D\uDCCA",description:"Progresso educacional e recursos"},{id:"chat",label:"Conversar",href:"/chat",icon:"\uD83D\uDCAC",description:"Chat com assistentes especializados"},{id:"modules",label:"M\xf3dulos",href:"/modules",icon:"\uD83D\uDCDA",description:"Conte\xfado educacional estruturado"},{id:"resources",label:"Recursos",href:"/resources",icon:"\uD83C\uDFAF",description:"Calculadoras, checklists e ferramentas"},{id:"progress",label:"Progresso",href:"/progress",icon:"\uD83D\uDCC8",description:"Acompanhe seu aprendizado"}].map(e=>(0,r.jsx)(o.default,{href:e.href,onClick:()=>c(!1),style:{display:"block",padding:"15px 20px",color:"white",textDecoration:"none",borderLeft:d(e.href)?"4px solid white":"4px solid transparent",background:d(e.href)?"rgba(255,255,255,0.1)":"transparent",transition:"all 0.3s ease"},onMouseEnter:a=>{d(e.href)||(a.currentTarget.style.background="rgba(255,255,255,0.05)")},onMouseLeave:a=>{d(e.href)||(a.currentTarget.style.background="transparent")},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},className:"jsx-8b16e275268ec1c7",children:[(0,r.jsx)("span",{style:{fontSize:"1.2rem"},className:"jsx-8b16e275268ec1c7",children:e.icon}),(0,r.jsxs)("div",{className:"jsx-8b16e275268ec1c7",children:[(0,r.jsx)("div",{style:{fontWeight:d(e.href)?"bold":"normal",fontSize:"1rem"},className:"jsx-8b16e275268ec1c7",children:e.label}),(0,r.jsx)("div",{style:{fontSize:"0.8rem",opacity:.7,marginTop:"2px"},className:"jsx-8b16e275268ec1c7",children:e.description})]})]})},e.id))}),(0,r.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"20px",borderTop:"1px solid rgba(255,255,255,0.1)",background:"rgba(0,0,0,0.1)"},className:"jsx-8b16e275268ec1c7",children:(0,r.jsxs)("div",{style:{fontSize:"0.8rem",opacity:.7,textAlign:"center"},className:"jsx-8b16e275268ec1c7",children:[(0,r.jsx)("p",{style:{margin:"0 0 5px"},className:"jsx-8b16e275268ec1c7",children:"Sistema Educacional"}),(0,r.jsx)("p",{style:{margin:0},className:"jsx-8b16e275268ec1c7",children:"Hansen\xedase PQT-U"})]})})]}),(0,r.jsx)(s(),{id:"8b16e275268ec1c7",children:"@media(min-width:1024px){.main-content{margin-left:280px;-webkit-transition:margin-left.3s ease;-moz-transition:margin-left.3s ease;-o-transition:margin-left.3s ease;transition:margin-left.3s ease}}"})]})}},3861:function(e,a,t){"use strict";t.d(a,{Qu:function(){return n},bt:function(){return o}});let r={dr_gasnelio:"https://i.postimg.cc/7Zp2Q8Vm/Dr-Gasnelio.png",ga:"https://i.postimg.cc/L6bNWcR8/G.png"},n=e=>r[e]||"",s=e=>e in r,o=e=>{let a={};return Object.entries(e).forEach(e=>{let[t,r]=e;s(t)&&(a[t]=r)}),a}},44:function(e,a,t){"use strict";t.d(a,{H:function(){return o}});var r=t(2265),n=t(8223),s=t(3861);function o(){let[e,a]=(0,r.useState)({}),[t,o]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async function(){try{o(!0),l(null);let e=await (0,n.H7)(),t=(0,s.bt)(e);a(t)}catch(e){console.error("Erro ao carregar personas:",e),l(e instanceof Error?e.message:"Erro desconhecido")}finally{o(!1)}})()},[]),{personas:e,loading:t,error:i,getPersonaById:a=>e[a]||null,getPersonasList:()=>Object.entries(e).map(e=>{let[a,t]=e;return{id:a,persona:t}}),getValidPersonasCount:()=>Object.keys(e).length,refetch:async()=>{try{o(!0),l(null);let e=await (0,n.H7)(),t=(0,s.bt)(e);a(t)}catch(e){console.error("Erro ao carregar personas:",e),l(e instanceof Error?e.message:"Erro desconhecido")}finally{o(!1)}}}}},8223:function(e,a,t){"use strict";t.d(a,{$N:function(){return o},H7:function(){return n},bE:function(){return s}});let r=t(257).env.NEXT_PUBLIC_API_URL||"https://roteiro-dispensacao-api-1016586236354.us-central1.run.app";async function n(){try{let e=await fetch("".concat(r,"/api/personas"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(e){throw console.error("Erro ao buscar personas:",e),e}}async function s(e){try{let a=await fetch("".concat(r,"/api/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return await a.json()}catch(e){throw console.error("Erro ao enviar mensagem:",e),e}}async function o(e){try{let a=await fetch("".concat(r,"/api/scope"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return await a.json()}catch(e){throw console.error("Erro ao detectar escopo:",e),e}}}},function(e){e.O(0,[29,448,971,117,744],function(){return e(e.s=1340)}),_N_E=e.O()}]);