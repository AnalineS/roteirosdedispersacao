(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{1340:function(e,t,a){Promise.resolve().then(a.bind(a,6174))},6174:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return el}});var r,o,n=a(7437),s=a(2265),i=a(7648),c=a(4768),l=a(29),d=a.n(l);let m={colors:{background:{primary:"#FFFFFF",secondary:"#F8FAFC",accent:"#F1F5F9"},personas:{gasnelio:{primary:"#0EA5E9",gradient:"linear-gradient(135deg, #0EA5E9 0%, #0284C7 100%)",bubble:"#EFF6FF",alpha:"rgba(14, 165, 233, 0.1)"},ga:{primary:"#10B981",gradient:"linear-gradient(135deg, #10B981 0%, #059669 100%)",bubble:"#ECFDF5",alpha:"rgba(16, 185, 129, 0.1)"}},neutral:{text:"#0F172A",textMuted:"#64748B",border:"#E2E8F0",divider:"#F1F5F9",surface:"#F8FAFC"},sentiment:{positive:"#10B981",neutral:"#6B7280",negative:"#EF4444",empathetic:"#8B5CF6"},status:{success:"#10B981",warning:"#F59E0B",error:"#EF4444",info:"#3B82F6"}},spacing:{xs:"4px",sm:"8px",md:"12px",lg:"16px",xl:"24px",xxl:"32px"},borderRadius:{sm:"8px",md:"12px",lg:"16px",xl:"20px",full:"50%",bubble:"20px"},typography:{message:{fontSize:"16px",lineHeight:"1.4",fontWeight:"400"},persona:{fontSize:"14px",lineHeight:"1.3",fontWeight:"600"},meta:{fontSize:"12px",lineHeight:"1.2",fontWeight:"400"}},shadows:{subtle:"0 1px 3px rgba(0, 0, 0, 0.04)",moderate:"0 2px 8px rgba(0, 0, 0, 0.08)",emphasis:"0 4px 16px rgba(0, 0, 0, 0.12)",floating:"0 8px 32px rgba(0, 0, 0, 0.12)"},transitions:{fast:"150ms ease",normal:"200ms ease",slow:"300ms ease",spring:"400ms cubic-bezier(0.4, 0, 0.2, 1)"},breakpoints:{mobile:"768px",tablet:"1024px",desktop:"1280px"},zIndex:{dropdown:1e3,sticky:1001,modal:1002,overlay:1003,tooltip:1004}},u=e=>{let t=m.colors.personas;return t[e]||t.gasnelio},p=()=>({"--color-bg-primary":m.colors.background.primary,"--color-bg-secondary":m.colors.background.secondary,"--color-bg-accent":m.colors.background.accent,"--color-text":m.colors.neutral.text,"--color-text-muted":m.colors.neutral.textMuted,"--color-border":m.colors.neutral.border,"--color-divider":m.colors.neutral.divider,"--color-surface":m.colors.neutral.surface,"--gasnelio-primary":m.colors.personas.gasnelio.primary,"--gasnelio-bubble":m.colors.personas.gasnelio.bubble,"--gasnelio-alpha":m.colors.personas.gasnelio.alpha,"--ga-primary":m.colors.personas.ga.primary,"--ga-bubble":m.colors.personas.ga.bubble,"--ga-alpha":m.colors.personas.ga.alpha,"--spacing-xs":m.spacing.xs,"--spacing-sm":m.spacing.sm,"--spacing-md":m.spacing.md,"--spacing-lg":m.spacing.lg,"--spacing-xl":m.spacing.xl,"--radius-sm":m.borderRadius.sm,"--radius-md":m.borderRadius.md,"--radius-lg":m.borderRadius.lg,"--radius-bubble":m.borderRadius.bubble,"--shadow-subtle":m.shadows.subtle,"--shadow-moderate":m.shadows.moderate,"--shadow-emphasis":m.shadows.emphasis,"--transition-fast":m.transitions.fast,"--transition-normal":m.transitions.normal,"--transition-slow":m.transitions.slow,"--transition-spring":m.transitions.spring});function g(e){let{personas:t,selected:a,onChange:r,isMobile:o=!1}=e,[i,c]=(0,s.useState)(!1);Object.keys(t);let l="dr_gasnelio"===(a||"ga");return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.md,background:"rgba(255, 255, 255, 0.95)",borderRadius:"50px",padding:"6px",backdropFilter:"blur(10px)",border:"1px solid ".concat(m.colors.neutral.border),boxShadow:m.shadows.subtle,transition:m.transitions.normal},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]])+" persona-switch-container",children:[(0,n.jsx)("span",{style:{padding:"0 ".concat(m.spacing.sm),fontSize:m.typography.meta.fontSize,fontWeight:l?"600":"400",color:l?m.colors.personas.gasnelio.primary:m.colors.neutral.textMuted,transition:"all 0.3s ease",whiteSpace:"nowrap",display:o?"none":"block"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:"Dr. Gasnelio"}),(0,n.jsx)("button",{onClick:()=>{if(i)return;c(!0);let e=l?"ga":"dr_gasnelio";setTimeout(()=>{r(e),c(!1)},200)},disabled:i,style:{position:"relative",width:"60px",height:"32px",borderRadius:"50px",border:"none",background:l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,cursor:i?"wait":"pointer",transition:"background 0.3s ease",padding:0,outline:"none",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.1)"},"aria-label":"Mudar para ".concat(l?"G\xe1":"Dr. Gasnelio"),"aria-pressed":l,className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]])+" toggle-switch",children:(0,n.jsx)("div",{style:{position:"absolute",top:"4px",left:l?"4px":"32px",width:"24px",height:"24px",borderRadius:"50%",background:"white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",transition:"left 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:l?"\uD83D\uDC68‍⚕️":"\uD83E\uDD1D"})}),(0,n.jsx)("span",{style:{padding:"0 ".concat(m.spacing.sm),fontSize:m.typography.meta.fontSize,fontWeight:l?"400":"600",color:l?m.colors.neutral.textMuted:m.colors.personas.ga.primary,transition:"all 0.3s ease",whiteSpace:"nowrap",display:o?"none":"block"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:"G\xe1"}),o&&(0,n.jsx)("span",{style:{marginLeft:m.spacing.sm,fontSize:m.typography.meta.fontSize,fontWeight:"600",color:l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,transition:"all 0.3s ease"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:l?"Dr. Gasnelio":"G\xe1"}),(0,n.jsx)(d(),{id:"a46f53fc3e694d7b",dynamic:[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile],children:".toggle-switch.__jsx-style-dynamic-selector:focus-visible{outline:2px solid ".concat(l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,";outline-offset:3px}.toggle-switch.__jsx-style-dynamic-selector:hover:not(:disabled){-webkit-filter:brightness(1.1);filter:brightness(1.1)}.toggle-switch.__jsx-style-dynamic-selector:active:not(:disabled){-webkit-transform:scale(.98);-moz-transform:scale(.98);-ms-transform:scale(.98);-o-transform:scale(.98);transform:scale(.98)}@media(max-width:").concat(m.breakpoints.mobile,"){.persona-switch-container.__jsx-style-dynamic-selector{padding:5px!important}}")})]})}let f=e=>{let{isMobile:t}=e;return(0,n.jsx)(i.default,{href:"/",style:{display:"flex",alignItems:"center",justifyContent:"center",width:t?"40px":"44px",height:t?"40px":"44px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.1)",color:"white",textDecoration:"none",fontSize:t?"1.2rem":"1.4rem",transition:m.transitions.normal,backdropFilter:"blur(10px)"},onMouseEnter:e=>{t||(e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",e.currentTarget.style.transform="scale(1.05)")},onMouseLeave:e=>{t||(e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="scale(1)")},"aria-label":"Voltar ao in\xedcio",children:"←"})},h=e=>{let{onToggle:t,isActive:a,isMobile:r}=e;return(0,n.jsx)("button",{onClick:t,style:{display:"flex",alignItems:"center",justifyContent:"center",width:r?"40px":"44px",height:r?"40px":"44px",borderRadius:"50%",background:a?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.1)",color:"white",border:"none",fontSize:r?"1.1rem":"1.2rem",cursor:"pointer",transition:m.transitions.normal,backdropFilter:"blur(10px)"},onMouseEnter:e=>{r||(e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",e.currentTarget.style.transform="scale(1.05)")},onMouseLeave:e=>{r||(e.currentTarget.style.background=a?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="scale(1)")},title:a?"Fechar conversas":"Mostrar conversas","aria-label":a?"Fechar conversas":"Mostrar conversas",children:"\uD83D\uDCAC"})},y=e=>{let{onExport:t,isMobile:a,disabled:r=!1}=e;return(0,n.jsx)("button",{onClick:t,disabled:r,style:{display:"flex",alignItems:"center",justifyContent:"center",width:a?"40px":"44px",height:a?"40px":"44px",borderRadius:"50%",background:r?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.1)",color:r?"rgba(255, 255, 255, 0.5)":"white",border:"none",fontSize:a?"1.1rem":"1.2rem",cursor:r?"not-allowed":"pointer",transition:m.transitions.normal,backdropFilter:"blur(10px)",opacity:r?.5:1},onMouseEnter:e=>{a||r||(e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",e.currentTarget.style.transform="scale(1.05)")},onMouseLeave:e=>{a||r||(e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="scale(1)")},title:r?"Nenhuma conversa para exportar":"Exportar conversa","aria-label":r?"Nenhuma conversa para exportar":"Exportar conversa",children:"\uD83D\uDCE4"})},b=e=>{let{persona:t,personaId:a,isMobile:r}=e;return t&&r?(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm,background:"rgba(255, 255, 255, 0.1)",padding:"".concat(m.spacing.xs," ").concat(m.spacing.sm),borderRadius:m.borderRadius.lg,backdropFilter:"blur(10px)"},children:[(0,n.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:u(a||"gasnelio").primary}}),(0,n.jsx)("span",{style:{color:"white",fontSize:m.typography.meta.fontSize,fontWeight:"500"},children:t.name})]}):null};function x(e){let{personas:t,selectedPersona:a,onPersonaChange:r,isMobile:o=!1,onHistoryToggle:s,onExport:i,showHistory:c=!1,hasMessages:l=!1}=e,p=a?t[a]:null,x=p?u(a||"gasnelio"):null;return(0,n.jsxs)("header",{style:{background:(null==x?void 0:x.gradient)||m.colors.personas.gasnelio.gradient,color:"white",padding:o?"".concat(m.spacing.md," ").concat(m.spacing.lg):"".concat(m.spacing.lg," ").concat(m.spacing.xl),display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:m.shadows.moderate,minHeight:o?"64px":"72px",position:"sticky",top:0,zIndex:m.zIndex.sticky,backdropFilter:"blur(20px)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},className:d().dynamic([["5b87b70aab4a2852",[m.breakpoints.mobile,m.spacing.sm,m.spacing.sm,m.transitions.spring]]])+" modern-chat-header",children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.md},className:d().dynamic([["5b87b70aab4a2852",[m.breakpoints.mobile,m.spacing.sm,m.spacing.sm,m.transitions.spring]]])+" header-left",children:[(0,n.jsx)(f,{isMobile:o}),(0,n.jsx)(b,{persona:p,personaId:a||void 0,isMobile:o})]}),(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",flex:1,margin:"0 ".concat(m.spacing.md)},className:d().dynamic([["5b87b70aab4a2852",[m.breakpoints.mobile,m.spacing.sm,m.spacing.sm,m.transitions.spring]]])+" header-center",children:(0,n.jsx)(g,{personas:t,selected:a,onChange:r,isMobile:o})}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm},className:d().dynamic([["5b87b70aab4a2852",[m.breakpoints.mobile,m.spacing.sm,m.spacing.sm,m.transitions.spring]]])+" header-right",children:[i&&(0,n.jsx)(y,{onExport:i,isMobile:o,disabled:!l}),s&&(0,n.jsx)(h,{onToggle:s,isActive:c,isMobile:o})]}),(0,n.jsx)(d(),{id:"5b87b70aab4a2852",dynamic:[m.breakpoints.mobile,m.spacing.sm,m.spacing.sm,m.transitions.spring],children:"@media(max-width:".concat(m.breakpoints.mobile,"){.header-center.__jsx-style-dynamic-selector{margin:0 ").concat(m.spacing.sm,"!important}.modern-chat-header.__jsx-style-dynamic-selector{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:").concat(m.spacing.sm,"}}.modern-chat-header.__jsx-style-dynamic-selector{-webkit-transition:background ").concat(m.transitions.spring,";-moz-transition:background ").concat(m.transitions.spring,";-o-transition:background ").concat(m.transitions.spring,";transition:background ").concat(m.transitions.spring,"}")})]})}var v=a(319);let k=e=>{let{timestamp:t}=e;return(0,n.jsx)("span",{style:{fontSize:m.typography.meta.fontSize,opacity:.7,fontWeight:"400"},children:(e=>{let t=new Date(e),a=new Date;if(t.toDateString()===a.toDateString())return t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});let r=new Date(a);return(r.setDate(r.getDate()-1),t.toDateString()===r.toDateString())?"Ontem "+t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})})(t)})},w=e=>{let{metadata:t}=e;if(!(null==t?void 0:t.isFallback))return null;let a=(e=>{switch(e){case"cache":return{icon:"\uD83D\uDD04",label:"Cache Local"};case"local_knowledge":return{icon:"\uD83D\uDCDA",label:"Base Local"};case"emergency":return{icon:"\uD83D\uDEA8",label:"Emerg\xeancia"};default:return{icon:"\uD83D\uDEE1️",label:"Fallback"}}})(t.fallbackSource);return(0,n.jsxs)("div",{style:{marginTop:m.spacing.sm,padding:"".concat(m.spacing.xs," ").concat(m.spacing.sm),backgroundColor:m.colors.status.warning+"15",border:"1px solid ".concat(m.colors.status.warning,"40"),borderRadius:m.borderRadius.sm,fontSize:m.typography.meta.fontSize,color:m.colors.status.warning,display:"flex",alignItems:"center",gap:m.spacing.xs},children:[(0,n.jsx)("span",{children:a.icon}),(0,n.jsxs)("span",{children:[a.label,t.confidence&&(0,n.jsxs)(n.Fragment,{children:[" - ",Math.round(100*t.confidence),"%"]})]})]})};function S(e){let{message:t,persona:a,personaId:r="gasnelio",isUser:o=!1,isMobile:i=!1,isLast:c=!1}=e,[l,d]=(0,s.useState)(!1);(0,s.useState)(()=>{setTimeout(()=>d(!0),50)});let p=a?u(r):null;return(0,n.jsxs)("div",{className:"message-wrapper ".concat(o?"user":"assistant"),style:{display:"flex",gap:m.spacing.md,marginBottom:c?m.spacing.lg:m.spacing.md,flexDirection:o?"row-reverse":"row",justifyContent:"flex-start",opacity:l?1:0,transform:l?"translateY(0)":"translateY(8px)",transition:m.transitions.spring,maxWidth:"100%"},children:[!o&&a&&(0,n.jsx)("div",{style:{flexShrink:0,alignSelf:"flex-end"},children:(0,n.jsx)(v.Z,{persona:a,personaId:r,size:"small",className:"message-avatar",style:{marginBottom:"4px"}})}),(0,n.jsxs)("div",{className:"message-bubble ".concat(o?"user-bubble":"assistant-bubble"),style:{maxWidth:i?"85%":"min(80%, 600px)",padding:"".concat(m.spacing.md," ").concat(m.spacing.lg),borderRadius:m.borderRadius.bubble,position:"relative",wordWrap:"break-word",lineHeight:m.typography.message.lineHeight,fontSize:m.typography.message.fontSize,...o?{background:(null==p?void 0:p.primary)||m.colors.personas.gasnelio.primary,color:"white",borderBottomRightRadius:m.borderRadius.sm,boxShadow:m.shadows.moderate}:{background:(null==p?void 0:p.bubble)||m.colors.background.secondary,color:m.colors.neutral.text,border:"1px solid ".concat(m.colors.neutral.border),borderBottomLeftRadius:m.borderRadius.sm,boxShadow:m.shadows.subtle},transition:m.transitions.normal},onMouseEnter:e=>{o||(e.currentTarget.style.boxShadow=m.shadows.moderate,e.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:e=>{o||(e.currentTarget.style.boxShadow=m.shadows.subtle,e.currentTarget.style.transform="translateY(0)")},children:[!o&&a&&(0,n.jsxs)("div",{className:"message-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:m.spacing.xs,fontSize:m.typography.persona.fontSize},children:[(0,n.jsx)("span",{className:"persona-name",style:{fontWeight:m.typography.persona.fontWeight,color:(null==p?void 0:p.primary)||m.colors.personas.gasnelio.primary},children:a.name}),(0,n.jsx)(k,{timestamp:t.timestamp})]}),(0,n.jsx)("div",{className:"message-content",style:{whiteSpace:"pre-wrap",margin:0},children:t.content}),(0,n.jsx)(w,{metadata:t.metadata}),o&&(0,n.jsx)("div",{style:{marginTop:m.spacing.xs,textAlign:"right",opacity:.8},children:(0,n.jsx)(k,{timestamp:t.timestamp})})]})]})}let j=e=>{let{persona:t}=e;if(!t)return null;let a=u("Dr. Gasnelio"===t.name?"gasnelio":"ga");return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm,background:a.bubble,padding:"".concat(m.spacing.sm," ").concat(m.spacing.md),borderRadius:m.borderRadius.lg,border:"1px solid ".concat(a.primary,"40"),animation:"fadeIn 300ms ease",boxShadow:m.shadows.subtle},children:[(0,n.jsx)(v.Z,{persona:t,personaId:"Dr. Gasnelio"===t.name?"gasnelio":"ga",size:"tiny",isTyping:!0}),(0,n.jsxs)("div",{style:{display:"flex",gap:"3px",alignItems:"center"},children:[(0,n.jsx)("div",{className:"typing-dot",style:{width:"6px",height:"6px",borderRadius:"50%",background:a.primary,animation:"typing 1.4s infinite ease-in-out",animationDelay:"-0.32s"}}),(0,n.jsx)("div",{className:"typing-dot",style:{width:"6px",height:"6px",borderRadius:"50%",background:a.primary,animation:"typing 1.4s infinite ease-in-out",animationDelay:"-0.16s"}}),(0,n.jsx)("div",{className:"typing-dot",style:{width:"6px",height:"6px",borderRadius:"50%",background:a.primary,animation:"typing 1.4s infinite ease-in-out"}})]}),(0,n.jsxs)("span",{style:{fontSize:m.typography.meta.fontSize,color:a.primary,fontWeight:"500"},children:[t.name," est\xe1 pensando..."]})]})},C=e=>{let{sentiment:t,confidence:a}=e,r=(e=>{switch(e.toLowerCase()){case"positive":return{color:m.colors.sentiment.positive,label:"Positivo",icon:"\uD83D\uDE0A",description:"Sentimento positivo detectado"};case"negative":return{color:m.colors.sentiment.negative,label:"Negativo",icon:"\uD83D\uDE14",description:"Sentimento negativo detectado"};case"empathetic":return{color:m.colors.sentiment.empathetic,label:"Emp\xe1tico",icon:"\uD83E\uDD17",description:"Tom emp\xe1tico recomendado"};default:return{color:m.colors.sentiment.neutral,label:"Neutro",icon:"\uD83D\uDE10",description:"Sentimento neutro"}}})(t),o=Math.round(100*a);return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm,padding:"".concat(m.spacing.xs," ").concat(m.spacing.sm),background:r.color+"15",borderRadius:m.borderRadius.md,fontSize:m.typography.meta.fontSize,color:r.color,border:"1px solid ".concat(r.color,"40"),cursor:"help"},title:"".concat(r.description," - Confian\xe7a: ").concat(o,"%"),children:[(0,n.jsx)("span",{style:{fontSize:"0.9rem"},children:r.icon}),(0,n.jsx)("span",{style:{fontWeight:"500"},children:r.label}),(0,n.jsxs)("span",{style:{fontSize:"0.75rem",opacity:.8,background:r.color+"20",padding:"1px 4px",borderRadius:"4px"},children:[o,"%"]})]})},z=e=>{let{isSearching:t,stats:a}=e;return t||a?(0,n.jsx)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.xs,fontSize:m.typography.meta.fontSize,color:m.colors.status.info},children:t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{width:"12px",height:"12px",border:"2px solid ".concat(m.colors.status.info,"40"),borderTop:"2px solid ".concat(m.colors.status.info),borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,n.jsx)("span",{children:"Buscando..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"\uD83D\uDCDA"}),(0,n.jsx)("span",{children:"Base de conhecimento"})]})}):null},E=e=>{let{type:t}=e,a=(e=>{switch(e){case"cache":return{icon:"\uD83D\uDD04",label:"Cache",color:m.colors.status.info};case"local_knowledge":return{icon:"\uD83D\uDCDA",label:"Local",color:m.colors.status.success};case"emergency":return{icon:"\uD83D\uDEA8",label:"Emerg\xeancia",color:m.colors.status.error};default:return{icon:"\uD83D\uDEE1️",label:"Fallback",color:m.colors.status.warning}}})(t);return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.xs,fontSize:m.typography.meta.fontSize,color:a.color},children:[(0,n.jsx)("span",{children:a.icon}),(0,n.jsx)("span",{children:a.label})]})},T=e=>{let{children:t}=e;return(0,n.jsx)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.md,background:"rgba(255, 255, 255, 0.95)",padding:"".concat(m.spacing.xs," ").concat(m.spacing.sm),borderRadius:m.borderRadius.md,border:"1px solid ".concat(m.colors.neutral.border),backdropFilter:"blur(10px)",fontSize:m.typography.meta.fontSize,boxShadow:m.shadows.subtle,animation:"slideUp 200ms ease"},children:t})};function D(e){let{sentiment:t,knowledge:a,fallback:r,isTyping:o,currentPersona:s,isMobile:i=!1}=e,c=(null==t?void 0:t.confidence)&&t.confidence>.7||(null==a?void 0:a.isSearching)||(null==r?void 0:r.isActive);return(0,n.jsxs)("div",{style:{position:"absolute",bottom:"100%",right:m.spacing.lg,marginBottom:m.spacing.sm,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:m.spacing.xs,zIndex:m.zIndex.dropdown,pointerEvents:"none"},className:d().dynamic([["3b7d4f2712a137b3",[m.breakpoints.mobile,m.spacing.md,m.spacing.md]]])+" smart-indicators",children:[o&&(0,n.jsx)(j,{persona:s}),c&&(0,n.jsxs)(T,{children:[(null==t?void 0:t.confidence)&&t.confidence>.7&&(0,n.jsx)(C,{sentiment:t.category,confidence:t.confidence}),a&&(0,n.jsx)(z,{isSearching:a.isSearching,stats:a.stats}),(null==r?void 0:r.isActive)&&(0,n.jsx)(E,{type:r.type})]}),(0,n.jsx)(d(),{id:"3b7d4f2712a137b3",dynamic:[m.breakpoints.mobile,m.spacing.md,m.spacing.md],children:"@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(4px);transform:translatey(4px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:translatey(4px);transform:translatey(4px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:translatey(4px);transform:translatey(4px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(4px);-moz-transform:translatey(4px);-o-transform:translatey(4px);transform:translatey(4px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@-webkit-keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideUp{from{opacity:0;-moz-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideUp{from{opacity:0;-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);-moz-transform:translatey(8px);-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@-webkit-keyframes typing{0%,80%,100%{-webkit-transform:scale(.8);transform:scale(.8);opacity:.5}40%{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@-moz-keyframes typing{0%,80%,100%{-moz-transform:scale(.8);transform:scale(.8);opacity:.5}40%{-moz-transform:scale(1);transform:scale(1);opacity:1}}@-o-keyframes typing{0%,80%,100%{-o-transform:scale(.8);transform:scale(.8);opacity:.5}40%{-o-transform:scale(1);transform:scale(1);opacity:1}}@keyframes typing{0%,80%,100%{-webkit-transform:scale(.8);-moz-transform:scale(.8);-o-transform:scale(.8);transform:scale(.8);opacity:.5}40%{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1);opacity:1}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@media(max-width:".concat(m.breakpoints.mobile,"){.smart-indicators.__jsx-style-dynamic-selector{right:").concat(m.spacing.md,"!important;left:").concat(m.spacing.md,"!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-moz-box-align:center!important;-ms-flex-align:center!important;align-items:center!important}}")})]})}let R=()=>(0,n.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("path",{d:"m22 2-7 20-4-9-9-4z"}),(0,n.jsx)("path",{d:"M22 2 11 13"})]}),A=()=>(0,n.jsx)("div",{style:{width:"16px",height:"16px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}),I=e=>{let{suggestions:t,onSuggestionClick:a,visible:r,persona:o,personaId:s}=e;if(!r||!(null==t?void 0:t.length)||!o)return null;let i=u(s||"gasnelio");return(0,n.jsxs)("div",{style:{position:"absolute",bottom:"100%",left:0,right:0,marginBottom:m.spacing.sm,background:"white",border:"1px solid ".concat(m.colors.neutral.border),borderRadius:m.borderRadius.lg,boxShadow:m.shadows.emphasis,overflow:"hidden",animation:"slideUp 200ms ease",zIndex:m.zIndex.dropdown},children:[(0,n.jsxs)("div",{style:{padding:m.spacing.sm,borderBottom:"1px solid ".concat(m.colors.neutral.divider),fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted,fontWeight:"500"},children:["\uD83D\uDCA1 Sugest\xf5es para ",o.name]}),t.slice(0,3).map((e,r)=>(0,n.jsx)("button",{onClick:()=>null==a?void 0:a(e),style:{display:"block",width:"100%",padding:m.spacing.md,border:"none",background:"transparent",textAlign:"left",cursor:"pointer",fontSize:m.typography.message.fontSize,lineHeight:m.typography.message.lineHeight,color:m.colors.neutral.text,transition:m.transitions.fast,borderBottom:r<t.length-1?"1px solid ".concat(m.colors.neutral.divider):"none"},onMouseEnter:e=>{e.currentTarget.style.background=i.alpha},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:e},r))]})};function N(e){let{value:t,onChange:a,onSubmit:r,persona:o,personaId:i="gasnelio",isLoading:c=!1,isMobile:l=!1,placeholder:p,suggestions:g,onSuggestionClick:f,showSuggestions:h=!1}=e,y=(0,s.useRef)(null),[b,x]=(0,s.useState)(!1),[v,k]=(0,s.useState)(!1),w=o?u(i):null;(0,s.useEffect)(()=>{o&&l&&y.current&&y.current.focus()},[o,l]);let S=!o||c,j=o&&t.trim()&&!c;return(0,n.jsxs)("div",{style:{position:"relative",background:"white",borderTop:"1px solid ".concat(m.colors.neutral.divider),padding:m.spacing.lg,paddingBottom:l?"max(".concat(m.spacing.lg,", env(safe-area-inset-bottom))"):m.spacing.lg},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]])+" modern-chat-input",children:[(0,n.jsx)(I,{suggestions:g,onSuggestionClick:f,visible:h&&b&&0===t.length,persona:o,personaId:i}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t.trim()&&!c&&(k(!0),setTimeout(()=>k(!1),300),r(e))},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]])+" input-form",children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"flex-end",gap:m.spacing.sm,background:b?"white":m.colors.neutral.surface,borderRadius:m.borderRadius.xl,border:"2px solid ".concat(b&&w?w.primary:"transparent"),transition:"all ".concat(m.transitions.normal),boxShadow:b?m.shadows.moderate:m.shadows.subtle,transform:v?"scale(0.98)":"scale(1)",opacity:S?.6:1},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]])+" input-wrapper",children:[(0,n.jsx)("input",{ref:y,type:"text",value:t,onChange:e=>a(e.target.value),onFocus:()=>{x(!0)},onBlur:()=>{setTimeout(()=>x(!1),200)},placeholder:p||(o?"Pergunte ao ".concat(o.name,"..."):"Digite sua pergunta aqui..."),disabled:S,maxLength:1e3,style:{flex:1,border:"none",background:"transparent",padding:"".concat(m.spacing.md," ").concat(m.spacing.lg),fontSize:"16px",lineHeight:m.typography.message.lineHeight,outline:"none",minHeight:l?"48px":"52px",color:m.colors.neutral.text,resize:"none"},autoComplete:"off",autoCapitalize:"sentences",spellCheck:"true",className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]])}),(0,n.jsx)("button",{type:"submit",disabled:!j,"aria-label":"Enviar mensagem",style:{width:"40px",height:"40px",borderRadius:"50%",border:"none",background:j?(null==w?void 0:w.primary)||m.colors.personas.gasnelio.primary:m.colors.neutral.textMuted,color:"white",margin:"4px",cursor:j?"pointer":"not-allowed",transition:"all ".concat(m.transitions.normal),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transform:j&&!l?"scale(1)":"scale(0.95)",touchAction:"manipulation"},onMouseEnter:e=>{j&&!l&&(e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 2px 8px ".concat((null==w?void 0:w.alpha)||"rgba(0,0,0,0.2)"))},onMouseLeave:e=>{j&&(e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="none")},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]]),children:c?(0,n.jsx)(A,{}):(0,n.jsx)(R,{})})]}),t.length>800&&(0,n.jsxs)("div",{style:{textAlign:"right",marginTop:m.spacing.xs,fontSize:m.typography.meta.fontSize,color:t.length>950?m.colors.status.warning:m.colors.neutral.textMuted},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]]),children:[t.length,"/1000"]})]}),(0,n.jsx)(d(),{id:"84b0a807d4a2bc23",dynamic:[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"],children:"@-webkit-keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideUp{from{opacity:0;-moz-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideUp{from{opacity:0;-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);-moz-transform:translatey(8px);-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@media(max-width:".concat(m.breakpoints.mobile,"){.modern-chat-input.__jsx-style-dynamic-selector{position:-webkit-sticky!important;position:sticky!important;bottom:0;z-index:").concat(m.zIndex.sticky,"}.input-wrapper.__jsx-style-dynamic-selector{min-height:52px!important}}.input-wrapper.__jsx-style-dynamic-selector:focus-within{outline:2px solid ").concat((null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)",";outline-offset:2px}")})]})}let _=(e,t)=>"# Conversa Educacional - Roteiros de Dispensa\xe7\xe3o PQT-U\n\n"+(t?"**Assistente:** ".concat(t.name," (").concat(t.personality,")\n"):"")+"**Data:** ".concat(new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),"\n\n---\n\n")+e.map((e,a)=>{var r;let o="user"===e.role?"**Usu\xe1rio**":"**".concat((null==t?void 0:t.name)||"Assistente","**"),n=new Date(e.timestamp).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),s="".concat(o," _(").concat(n,")_:\n").concat(e.content,"\n");return(null===(r=e.metadata)||void 0===r?void 0:r.isFallback)&&(s+="\n> ⚠️ _Resposta de fallback (".concat(e.metadata.fallbackSource,")_\n")),s}).join("\n")+"\n\n---\n\n_Gerado pelo Sistema Educacional Roteiros de Dispensa\xe7\xe3o - UnB/PPGCF_",F=async e=>{if(navigator.clipboard)await navigator.clipboard.writeText(e);else{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),t.remove()}},P=async(e,t)=>{let{jsPDF:r}=await Promise.all([a.e(505),a.e(553)]).then(a.bind(a,3375)),o=new r,n=o.internal.pageSize.getWidth();o.setFontSize(16),o.setFont("helvetica","bold"),o.text("Conversa Educacional - Roteiros de Dispensa\xe7\xe3o",20,20),o.setFontSize(10),o.setFont("helvetica","normal"),o.text("Gerado em: ".concat(new Date().toLocaleString("pt-BR")),20,30),o.setFontSize(11);let s=o.splitTextToSize(e,n-40),i=45;s.forEach(e=>{i>o.internal.pageSize.getHeight()-20&&(o.addPage(),i=20),o.text(e,20,i),i+=7});let c=o.getNumberOfPages();for(let e=1;e<=c;e++)o.setPage(e),o.setFontSize(8),o.text("Sistema Educacional - UnB/PPGCF - P\xe1gina ".concat(e," de ").concat(c),n/2,o.internal.pageSize.getHeight()-10,{align:"center"});o.save(t)},M=(e,t)=>{let a=encodeURIComponent(e),r=encodeURIComponent(t),o="mailto:?subject=".concat(r,"&body=").concat(a);window.open(o)};function L(e){let{isOpen:t,onClose:a,messages:r,currentPersona:o,isMobile:i=!1}=e,[c,l]=(0,s.useState)(null),[u,p]=(0,s.useState)(null);if(!t)return null;let g=_(r,o),f="conversa-".concat((null==o?void 0:o.name)||"chat","-").concat(new Date().toISOString().split("T")[0],".pdf"),h="Conversa Educacional - ".concat((null==o?void 0:o.name)||"Assistente"," - ").concat(new Date().toLocaleDateString("pt-BR")),y=async e=>{l(e),p(null);try{switch(e){case"copy":await F(g),p("Conversa copiada para a \xe1rea de transfer\xeancia!");break;case"pdf":await P(g,f),p("PDF gerado e baixado com sucesso!");break;case"email":M(g,h),p("Cliente de email aberto com a conversa!")}}catch(e){console.error("Erro ao exportar:",e),p("Erro ao exportar. Tente novamente.")}finally{l(null),setTimeout(()=>p(null),3e3)}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:m.zIndex.modal,display:"flex",alignItems:"center",justifyContent:"center",padding:m.spacing.lg,backdropFilter:"blur(4px)"},onClick:a,className:"jsx-b9522046e44b3f8f",children:(0,n.jsxs)("div",{style:{background:"white",borderRadius:m.borderRadius.lg,boxShadow:m.shadows.floating,padding:m.spacing.xl,width:"100%",maxWidth:i?"100%":"480px",maxHeight:"90vh",overflowY:"auto"},onClick:e=>e.stopPropagation(),className:"jsx-b9522046e44b3f8f",children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:m.spacing.lg,paddingBottom:m.spacing.md,borderBottom:"1px solid ".concat(m.colors.neutral.divider)},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsx)("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:"600",color:m.colors.neutral.text},className:"jsx-b9522046e44b3f8f",children:"\uD83D\uDCE4 Exportar Conversa"}),(0,n.jsx)("button",{onClick:a,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:m.colors.neutral.textMuted,width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:m.transitions.fast},onMouseEnter:e=>{e.currentTarget.style.background=m.colors.neutral.surface},onMouseLeave:e=>{e.currentTarget.style.background="none"},className:"jsx-b9522046e44b3f8f",children:"✕"})]}),(0,n.jsx)("div",{style:{background:m.colors.background.accent,padding:m.spacing.md,borderRadius:m.borderRadius.md,marginBottom:m.spacing.lg,border:"1px solid ".concat(m.colors.neutral.border)},className:"jsx-b9522046e44b3f8f",children:(0,n.jsxs)("p",{style:{margin:0,fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted,lineHeight:"1.5"},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsx)("strong",{className:"jsx-b9522046e44b3f8f",children:"Conversa com:"})," ",(null==o?void 0:o.name)||"Assistente",(0,n.jsx)("br",{className:"jsx-b9522046e44b3f8f"}),(0,n.jsx)("strong",{className:"jsx-b9522046e44b3f8f",children:"Total de mensagens:"})," ",r.length,(0,n.jsx)("br",{className:"jsx-b9522046e44b3f8f"}),(0,n.jsx)("strong",{className:"jsx-b9522046e44b3f8f",children:"Data:"})," ",new Date().toLocaleString("pt-BR")]})}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:m.spacing.md},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsxs)("button",{onClick:()=>y("copy"),disabled:null!==c,style:{display:"flex",alignItems:"center",gap:m.spacing.md,padding:m.spacing.lg,background:m.colors.background.secondary,border:"1px solid ".concat(m.colors.neutral.border),borderRadius:m.borderRadius.md,cursor:c?"wait":"pointer",transition:m.transitions.normal,opacity:c&&"copy"!==c?.5:1},onMouseEnter:e=>{c||(e.currentTarget.style.background=m.colors.neutral.surface,e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{c||(e.currentTarget.style.background=m.colors.background.secondary,e.currentTarget.style.transform="translateY(0)")},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsx)("div",{style:{fontSize:"1.5rem"},className:"jsx-b9522046e44b3f8f",children:"\uD83D\uDCCB"}),(0,n.jsxs)("div",{style:{flex:1,textAlign:"left"},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsx)("div",{style:{fontWeight:"600",marginBottom:"4px"},className:"jsx-b9522046e44b3f8f",children:"Copiar para \xc1rea de Transfer\xeancia"}),(0,n.jsx)("div",{style:{fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted},className:"jsx-b9522046e44b3f8f",children:"Copie o texto da conversa para colar em outros aplicativos"})]}),"copy"===c&&(0,n.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid #ccc",borderTop:"2px solid ".concat(m.colors.status.info),borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-b9522046e44b3f8f"})]}),(0,n.jsxs)("button",{onClick:()=>y("pdf"),disabled:null!==c,style:{display:"flex",alignItems:"center",gap:m.spacing.md,padding:m.spacing.lg,background:m.colors.background.secondary,border:"1px solid ".concat(m.colors.neutral.border),borderRadius:m.borderRadius.md,cursor:c?"wait":"pointer",transition:m.transitions.normal,opacity:c&&"pdf"!==c?.5:1},onMouseEnter:e=>{c||(e.currentTarget.style.background=m.colors.neutral.surface,e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{c||(e.currentTarget.style.background=m.colors.background.secondary,e.currentTarget.style.transform="translateY(0)")},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsx)("div",{style:{fontSize:"1.5rem"},className:"jsx-b9522046e44b3f8f",children:"\uD83D\uDCC4"}),(0,n.jsxs)("div",{style:{flex:1,textAlign:"left"},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsx)("div",{style:{fontWeight:"600",marginBottom:"4px"},className:"jsx-b9522046e44b3f8f",children:"Baixar como PDF"}),(0,n.jsx)("div",{style:{fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted},className:"jsx-b9522046e44b3f8f",children:"Gere um documento PDF formatado da conversa"})]}),"pdf"===c&&(0,n.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid #ccc",borderTop:"2px solid ".concat(m.colors.status.info),borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-b9522046e44b3f8f"})]}),(0,n.jsxs)("button",{onClick:()=>y("email"),disabled:null!==c,style:{display:"flex",alignItems:"center",gap:m.spacing.md,padding:m.spacing.lg,background:m.colors.background.secondary,border:"1px solid ".concat(m.colors.neutral.border),borderRadius:m.borderRadius.md,cursor:c?"wait":"pointer",transition:m.transitions.normal,opacity:c&&"email"!==c?.5:1},onMouseEnter:e=>{c||(e.currentTarget.style.background=m.colors.neutral.surface,e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{c||(e.currentTarget.style.background=m.colors.background.secondary,e.currentTarget.style.transform="translateY(0)")},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsx)("div",{style:{fontSize:"1.5rem"},className:"jsx-b9522046e44b3f8f",children:"\uD83D\uDCE7"}),(0,n.jsxs)("div",{style:{flex:1,textAlign:"left"},className:"jsx-b9522046e44b3f8f",children:[(0,n.jsx)("div",{style:{fontWeight:"600",marginBottom:"4px"},className:"jsx-b9522046e44b3f8f",children:"Enviar por Email"}),(0,n.jsx)("div",{style:{fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted},className:"jsx-b9522046e44b3f8f",children:"Abra seu cliente de email com a conversa anexada"})]}),"email"===c&&(0,n.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid #ccc",borderTop:"2px solid ".concat(m.colors.status.info),borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-b9522046e44b3f8f"})]})]}),u&&(0,n.jsxs)("div",{style:{marginTop:m.spacing.lg,padding:m.spacing.md,background:m.colors.status.success+"20",border:"1px solid ".concat(m.colors.status.success,"40"),borderRadius:m.borderRadius.md,color:m.colors.status.success,fontSize:m.typography.meta.fontSize,textAlign:"center",animation:"slideUp 300ms ease"},className:"jsx-b9522046e44b3f8f",children:["✅ ",u]}),(0,n.jsx)("div",{style:{marginTop:m.spacing.xl,paddingTop:m.spacing.md,borderTop:"1px solid ".concat(m.colors.neutral.divider),textAlign:"center"},className:"jsx-b9522046e44b3f8f",children:(0,n.jsx)("p",{style:{margin:0,fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted},className:"jsx-b9522046e44b3f8f",children:"Sistema Educacional - UnB/PPGCF"})})]})}),(0,n.jsx)(d(),{id:"b9522046e44b3f8f",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideUp{from{opacity:0;-moz-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideUp{from{opacity:0;-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);-moz-transform:translatey(8px);-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}"})]})}function O(e){let{personas:t,selectedPersona:a,onPersonaChange:r,messages:o,inputValue:i,onInputChange:c,onSendMessage:l,isLoading:u,isMobile:g,currentSentiment:f,knowledgeStats:h,isSearchingKnowledge:y,fallbackState:b,onHistoryToggle:v,showHistory:k,suggestions:w,showSuggestions:j,onSuggestionClick:C}=e,z=(0,s.useRef)(null),E=(0,s.useRef)(null),[T,R]=(0,s.useState)(!1),A=a?t[a]:null;return(0,s.useEffect)(()=>{var e;null===(e=z.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},[o]),(0,s.useEffect)(()=>{E.current&&Object.entries(p()).forEach(e=>{var t;let[a,r]=e;null===(t=E.current)||void 0===t||t.style.setProperty(a,r)})},[]),(0,n.jsxs)("div",{ref:E,style:{height:"100dvh",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, ".concat(m.colors.background.primary," 0%, ").concat(m.colors.background.secondary," 100%)"),position:"relative"},className:d().dynamic([["beabe735b9f2463a",[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha]]])+" modern-chat-container",children:[(0,n.jsx)(x,{personas:t,selectedPersona:a,onPersonaChange:r,isMobile:g,onHistoryToggle:v,onExport:()=>R(!0),showHistory:k,hasMessages:o.length>0}),a?(0,n.jsx)(()=>(0,n.jsxs)("div",{className:"messages-area",style:{flex:1,overflowY:"auto",padding:g?"".concat(m.spacing.lg," ").concat(m.spacing.md):"".concat(m.spacing.xl," ").concat(m.spacing.xl),scrollBehavior:"smooth",scrollPaddingBottom:m.spacing.xl},children:[o.map((e,t)=>(0,n.jsx)(S,{message:e,persona:"assistant"===e.role&&A||void 0,personaId:a||"gasnelio",isUser:"user"===e.role,isMobile:g,isLast:t===o.length-1},"".concat(e.role,"-").concat(e.timestamp,"-").concat(t))),u&&A&&(0,n.jsx)("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:m.spacing.lg},children:(0,n.jsx)(D,{isTyping:!0,currentPersona:A,isMobile:g})}),(0,n.jsx)("div",{ref:z})]}),{className:d().dynamic([["beabe735b9f2463a",[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha]]])}):(0,n.jsx)(()=>(0,n.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:m.spacing.xl,textAlign:"center"},children:(0,n.jsxs)("div",{style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.7)",padding:m.spacing.xl,borderRadius:m.borderRadius.lg,backdropFilter:"blur(10px)",border:"1px solid ".concat(m.colors.neutral.border)},children:[(0,n.jsx)("div",{style:{fontSize:"3rem",marginBottom:m.spacing.lg},children:"\uD83D\uDCAC"}),(0,n.jsx)("h3",{style:{margin:"0 0 ".concat(m.spacing.md),color:m.colors.neutral.text,fontSize:m.typography.persona.fontSize,fontWeight:m.typography.persona.fontWeight},children:"Selecione um Assistente"}),(0,n.jsx)("p",{style:{margin:0,color:m.colors.neutral.textMuted,fontSize:m.typography.meta.fontSize,lineHeight:"1.5"},children:"Escolha Dr. Gasnelio para suporte t\xe9cnico ou G\xe1 para uma abordagem mais emp\xe1tica"})]})}),{className:d().dynamic([["beabe735b9f2463a",[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha]]])}),(0,n.jsxs)("div",{style:{position:"relative"},className:d().dynamic([["beabe735b9f2463a",[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha]]]),children:[(0,n.jsx)(D,{sentiment:f,knowledge:{isSearching:y||!1,stats:h},fallback:b,currentPersona:A,isMobile:g}),(0,n.jsx)(N,{value:i,onChange:c,onSubmit:l,persona:A,personaId:a||"gasnelio",isLoading:u,isMobile:g,suggestions:w,showSuggestions:j,onSuggestionClick:C})]}),(0,n.jsx)(L,{isOpen:T,onClose:()=>R(!1),messages:o,currentPersona:A,isMobile:g}),(0,n.jsx)(d(),{id:"beabe735b9f2463a",dynamic:[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha],children:".messages-area::-webkit-scrollbar{width:6px}.messages-area::-webkit-scrollbar-track{background:transparent}.messages-area::-webkit-scrollbar-thumb{background:".concat(m.colors.neutral.border,";-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.messages-area::-webkit-scrollbar-thumb:hover{background:").concat(m.colors.neutral.textMuted,"}.messages-area{scroll-behavior:smooth}@media(max-width:").concat(m.breakpoints.mobile,'){.modern-chat-container{height:100vh!important;height:100dvh!important}.messages-area{-webkit-overflow-scrolling:touch;-ms-scroll-chaining:none;overscroll-behavior:contain}button,input,[role="button"]{min-height:44px!important;min-width:44px!important}}.modern-chat-container *:focus{outline:2px solid ').concat(m.colors.personas.gasnelio.alpha,";outline-offset:2px}@media(prefers-reduced-motion:reduce){.modern-chat-container *,.modern-chat-container *::before,.modern-chat-container *::after{-webkit-animation-duration:.01ms!important;-moz-animation-duration:.01ms!important;-o-animation-duration:.01ms!important;animation-duration:.01ms!important;-webkit-animation-iteration-count:1!important;-moz-animation-iteration-count:1!important;-o-animation-iteration-count:1!important;animation-iteration-count:1!important;-webkit-transition-duration:.01ms!important;-moz-transition-duration:.01ms!important;-o-transition-duration:.01ms!important;transition-duration:.01ms!important}}@media(prefers-color-scheme:dark){}")})]})}var B=a(2983),U=a(8223);(r=o||(o={})).POSITIVE="positive",r.NEUTRAL="neutral",r.CONCERNED="concerned",r.ANXIOUS="anxious",r.FRUSTRATED="frustrated";let H=new Map;class q{static getInstance(){return q.instance||(q.instance=new q),q.instance}async analyze(e){let t=e.toLowerCase().trim(),a=this.getCachedResult(t);if(a)return a;let r=await this.performLocalAnalysis(t);return this.cacheResult(t,r),r}async performLocalAnalysis(e){let{sentimentKeywords:t}=await a.e(543).then(a.bind(a,7543)),r=0,o=0,n=[],s=0;for(let[a,i]of Object.entries(t))for(let t of i){let a=RegExp("\\b".concat(t.word,"\\b"),"gi"),i=e.match(a);if(i){let e=t.weight*i.length;r+=e,o+=Math.abs(e),s+=i.length,n.push(t.word)}}s>0&&(r=Math.max(-1,Math.min(1,r/s)),o=Math.min(1,o/s));let i=this.analyzeEmojis(e);r=(r+i.score)/2,o=Math.max(o,i.magnitude);let c=this.determineCategory(r,o);return{score:r,magnitude:o,category:c,confidence:Math.min(1,(n.length+i.count)/5),keywords:n.slice(0,5)}}analyzeEmojis(e){let t=(e.match(/😊|😃|😄|😁|🙂|👍|❤️|💚|✅|🎉/g)||[]).length,a=(e.match(/😟|😰|😔|😢|😭|😡|😤|👎|❌|💔/g)||[]).length,r=t+a+(e.match(/🤔|😕|🧐|❓|⁉️/g)||[]).length;return 0===r?{score:0,magnitude:0,count:0}:{score:(t-a)/r,magnitude:Math.min(1,r/3),count:r}}determineCategory(e,t){if(t>.7){if(e>.3)return"positive";if(e<-.5)return"frustrated";if(e<-.2)return"anxious"}return e>.2?"positive":e<-.4?"frustrated":e<-.2?"anxious":.2>Math.abs(e)&&t>.3?"concerned":"neutral"}getCachedResult(e){let t=H.get(e);return t&&Date.now()-t.timestamp<3e5?t.result:(t&&H.delete(e),null)}cacheResult(e,t){if(H.size>=100){let e=H.keys().next().value;e&&H.delete(e)}H.set(e,{result:t,timestamp:Date.now()})}clearCache(){H.clear()}constructor(){}}let W=q.getInstance();class K{async searchContext(e){let t=Date.now(),a=this.generateCacheKey(e),r=this.getCachedResponse(a);if(r)return{...r,cached:!0,processing_time:Date.now()-t};try{let r=await this.simulateRAGResponse(e);return this.cacheResponse(a,r),{...r,cached:!1,processing_time:Date.now()-t}}catch(t){return console.error("Erro ao buscar contexto ASTRA:",t),this.localFallbackSearch(e)}}async sendFeedback(e){try{console.log("Feedback registrado:",e),await new Promise(e=>setTimeout(e,500))}catch(e){console.error("Erro ao enviar feedback:",e)}}async getStats(){try{return{cache_stats:{total_cached_responses:this.cache.size,cache_hits:45,cache_misses:15,hit_rate_percent:75},feedback_stats:{total_feedback:120,average_rating:4.2,rating_distribution:{1:5,2:10,3:20,4:50,5:35}},system_stats:{total_chunks:250,knowledge_base_size:5242880}}}catch(e){throw console.error("Erro ao obter estat\xedsticas:",e),e}}async simulateRAGResponse(e){await new Promise(e=>setTimeout(e,300));let t=e.question.toLowerCase(),a=[{content:"A Poliquimioterapia \xdanica (PQT-U) \xe9 o esquema padr\xe3o para tratamento da hansen\xedase, consistindo em rifampicina 600mg dose mensal supervisionada, clofazimina 300mg dose mensal supervisionada e 50mg di\xe1ria autoadministrada, e dapsona 100mg di\xe1ria autoadministrada.",section:"tratamento_pqtu",topics:["pqt-u","poliquimioterapia","dosagem","rifampicina","clofazimina","dapsona"]},{content:"A rifampicina pode causar colora\xe7\xe3o avermelhada na urina, suor e l\xe1grimas nas primeiras 48 horas ap\xf3s a dose, sendo um efeito esperado e n\xe3o prejudicial. Pacientes devem ser orientados para n\xe3o se alarmarem.",section:"efeitos_adversos_rifampicina",topics:["rifampicina","efeito adverso","colora\xe7\xe3o","urina"]},{content:"A clofazimina pode causar hiperpigmenta\xe7\xe3o cut\xe2nea e ressecamento da pele, que s\xe3o revers\xedveis ap\xf3s o t\xe9rmino do tratamento. O uso de hidratantes e protetor solar \xe9 recomendado.",section:"efeitos_adversos_clofazimina",topics:["clofazimina","efeito adverso","hiperpigmenta\xe7\xe3o","pele"]},{content:"A dapsona pode causar anemia hemol\xedtica, especialmente em pacientes com defici\xeancia de G6PD. Monitoramento com hemograma \xe9 recomendado no in\xedcio do tratamento.",section:"efeitos_adversos_dapsona",topics:["dapsona","efeito adverso","anemia","g6pd","hemograma"]},{content:"O tratamento da hansen\xedase com PQT-U tem dura\xe7\xe3o de 6 doses mensais supervisionadas. A ades\xe3o ao tratamento \xe9 fundamental para a cura e preven\xe7\xe3o de resist\xeancia medicamentosa.",section:"duracao_tratamento",topics:["tratamento","dura\xe7\xe3o","ades\xe3o","cura"]}].map(e=>{let a=0;e.topics.forEach(e=>{t.includes(e)&&(a+=2)});let r=e.content.toLowerCase().split(/\s+/),o=t.split(/\s+/);return o.forEach(e=>{r.includes(e)&&(a+=1)}),{...e,relevance_score:a/(o.length+e.topics.length),importance_score:.8}}).filter(e=>e.relevance_score>0).sort((e,t)=>t.relevance_score-e.relevance_score).slice(0,e.maxChunks||3),r=a.map(e=>"[".concat(e.section,"] ").concat(e.content)).join("\n\n");return{chunks:a,combined_context:r||"N\xe3o foram encontradas informa\xe7\xf5es espec\xedficas sobre esta pergunta na base de conhecimento.",confidence:a.length>0?Math.min(a[0].relevance_score,1):0,cached:!1,processing_time:0}}localFallbackSearch(e){let t="\n    Informa\xe7\xf5es b\xe1sicas sobre PQT-U para hansen\xedase:\n    - Esquema padr\xe3o com 3 medicamentos\n    - Dura\xe7\xe3o de 6 meses\n    - Doses supervisionadas mensais\n    \n    Para informa\xe7\xf5es mais espec\xedficas, consulte um profissional de sa\xfade.\n    ";return{chunks:[{content:t,section:"fallback",relevance_score:.3,topics:["pqt-u","hanseniase"],importance_score:.5}],combined_context:t,confidence:.3,cached:!1,processing_time:10}}generateCacheKey(e){return"".concat(e.question,"_").concat(e.persona||"default","_").concat(e.maxChunks||3).toLowerCase().replace(/\s+/g,"_")}getCachedResponse(e){let t=this.cache.get(e);return t?Date.now()-(t.processing_time||0)>this.cacheTimeout?(this.cache.delete(e),null):t:null}cacheResponse(e,t){if(this.cache.size>100){let e=this.cache.keys().next().value;e&&this.cache.delete(e)}this.cache.set(e,t)}clearCache(){this.cache.clear()}constructor(){this.cacheTimeout=3e5,this.baseUrl="https://roteiro-dispensacao-api-1016586236354.us-central1.run.app",this.cache=new Map}}let G=new K;class Q{static getInstance(){return Q.instance||(Q.instance=new Q),Q.instance}async searchKnowledge(e,t,a,r){let o=this.adjustSearchBySentiment(t,r),n={question:e,persona:a,maxChunks:o.maxChunks,...t&&{sentiment:{category:t.category,score:t.score,magnitude:t.magnitude}}},s=await G.searchContext(n);return o.minConfidence&&s.confidence<o.minConfidence?this.getFallbackResponse(e,a):s}async enrichMessage(e,t,a){try{let r=await this.searchKnowledge(e,t,a,{maxChunks:2,minConfidence:.5});if(!r.combined_context||r.confidence<.3)return{original:e,enriched:e,confidence:0,sources:[]};let o=this.buildEnrichedMessage(e,r,t);return{original:e,enriched:o.text,context:r.combined_context,confidence:r.confidence,sources:o.sources}}catch(t){return console.error("Erro ao enriquecer mensagem:",t),{original:e,enriched:e,confidence:0,sources:[]}}}adjustSearchBySentiment(e,t){let a={maxChunks:3,includeContext:!0,filterByTopics:[],minConfidence:.3};if(!e)return{...a,...t};switch(e.category){case o.ANXIOUS:return{...a,...t,maxChunks:4,minConfidence:.5};case o.FRUSTRATED:return{...a,...t,maxChunks:2,minConfidence:.6};case o.CONCERNED:return{...a,...t,maxChunks:5,includeContext:!0};default:return{...a,...t}}}buildEnrichedMessage(e,t,a){let r=[],n=e,s=t.chunks[0];return s&&s.relevance_score>.7&&(r.push(s.section),n=(null==a?void 0:a.category)===o.ANXIOUS?"Entendo sua preocupa\xe7\xe3o. ".concat(e,"\n\nInforma\xe7\xe3o importante: ").concat(this.simplifyContent(s.content)):(null==a?void 0:a.category)===o.FRUSTRATED?"".concat(e,"\n\nResumo: ").concat(this.extractKeyPoints(s.content)):"".concat(e,"\n\nContexto adicional: ").concat(s.content)),t.chunks.slice(1).forEach(e=>{e.relevance_score>.5&&r.push(e.section)}),{text:n,sources:r}}simplifyContent(e){let t=e;return[{from:/poliquimioterapia única|PQT-U/gi,to:"tratamento combinado"},{from:/hiperpigmentação/gi,to:"escurecimento da pele"},{from:/anemia hemolítica/gi,to:"redu\xe7\xe3o de gl\xf3bulos vermelhos"},{from:/dose supervisionada/gi,to:"dose tomada na presen\xe7a do profissional"}].forEach(e=>{let{from:a,to:r}=e;t=t.replace(a,r)}),t.length>200&&(t=t.substring(0,197)+"..."),t}extractKeyPoints(e){let t=e.split(/[.!?]+/),a=[];return t.forEach(e=>{(/\d+\s*(mg|ml|dose|mês|meses|dia|dias)/i.test(e)||/deve|precisa|importante|necessário/i.test(e))&&a.push(e.trim())}),a.slice(0,3).join(". ")+"."}getFallbackResponse(e,t){let a="ga"===t?"N\xe3o encontrei informa\xe7\xf5es espec\xedficas sobre isso, mas posso ajudar de outras formas. O que mais voc\xea gostaria de saber?":"N\xe3o h\xe1 informa\xe7\xf5es detalhadas sobre este t\xf3pico na base de conhecimento atual. Recomendo consultar as diretrizes oficiais ou um especialista.";return{chunks:[{content:a,section:"fallback",relevance_score:0,topics:[],importance_score:0}],combined_context:a,confidence:0,cached:!1,processing_time:0}}async prefetchCommonTopics(){await Promise.all(["Como funciona o tratamento PQT-U?","Quais s\xe3o os efeitos colaterais?","Quanto tempo dura o tratamento?","Posso tomar os rem\xe9dios em casa?"].map(e=>this.searchKnowledge(e,void 0,void 0,{maxChunks:2}).catch(e=>console.error("Erro no prefetch:",e))))}constructor(){}}let Y=Q.getInstance();class J{static getInstance(){return J.instance||(J.instance=new J),J.instance}async executeFallback(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{useLocalKnowledge:o=!0,includeEmergencyContacts:n=!0,adaptToSentiment:s=!0,maxRetries:i=3,timeoutMs:c=5e3}=r;switch(this.recordFailure(),t){case"network":case"timeout":return this.handleNetworkFallback(e,a,r);case"server_error":return this.handleServerErrorFallback(e,a,r);case"data_corruption":return this.handleDataCorruptionFallback(e,a,r);default:return this.handleGenericFallback(e,a,r)}}async handleNetworkFallback(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let a=this.searchLocalCache(e);if(a)return{success:!0,response:this.adaptResponseToSentiment(a,t),source:"cache",confidence:.8,suggestion:"Resposta baseada em cache local. Conex\xe3o pode estar inst\xe1vel."};let r=this.searchLocalKnowledge(e);return r?{success:!0,response:this.adaptResponseToSentiment(r,t),source:"local_knowledge",confidence:.6,suggestion:"Resposta baseada em conhecimento local. Recomendo tentar novamente quando a conex\xe3o melhorar."}:this.getEmergencyResponse(e,"network",t)}async handleServerErrorFallback(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let a=this.searchLocalKnowledge(e);return a?{success:!0,response:this.adaptResponseToSentiment(a,t),source:"local_knowledge",confidence:.7,suggestion:"Sistema principal temporariamente indispon\xedvel. Resposta baseada em conhecimento local."}:this.getEmergencyResponse(e,"server_error",t)}async handleDataCorruptionFallback(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let a=this.searchLocalKnowledge(e);return a?{success:!0,response:this.adaptResponseToSentiment(a,t),source:"local_knowledge",confidence:.6,suggestion:"Detectado problema nos dados. Usando conhecimento local verificado."}:this.getEmergencyResponse(e,"data_corruption",t)}async handleGenericFallback(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],this.getEmergencyResponse(e,"unknown",t)}searchLocalCache(e){let t=e.toLowerCase().trim();for(let e of[{key:"rifampicina dose",response:"A rifampicina \xe9 administrada na dose de 600mg uma vez por m\xeas, sempre sob supervis\xe3o profissional."},{key:"clofazimina efeito",response:"A clofazimina pode causar hiperpigmenta\xe7\xe3o da pele, que \xe9 revers\xedvel ap\xf3s o tratamento."},{key:"dapsona dose",response:"A dapsona \xe9 administrada na dose de 100mg diariamente por via oral."},{key:"tratamento dura\xe7\xe3o",response:"O tratamento PQT-U tem dura\xe7\xe3o de 6 doses mensais supervisionadas."}])if(t.includes(e.key.split(" ")[0])&&t.includes(e.key.split(" ")[1]))return e.response;return null}searchLocalKnowledge(e){let t=e.toLowerCase();for(let e of[{keywords:["rifampin","dose","quantidade"],response:"A rifampicina \xe9 o medicamento principal do esquema PQT-U, administrada mensalmente sob supervis\xe3o. Para informa\xe7\xf5es espec\xedficas de dosagem, consulte um profissional de sa\xfade."},{keywords:["clofazimin","pele","cor","escura"],response:"A clofazimina pode causar escurecimento tempor\xe1rio da pele. Este efeito \xe9 normal e revers\xedvel. Continue o tratamento conforme orienta\xe7\xe3o m\xe9dica."},{keywords:["dapsona","di\xe1rio","casa"],response:"A dapsona \xe9 tomada diariamente em casa. \xc9 importante n\xe3o interromper o uso sem orienta\xe7\xe3o m\xe9dica."},{keywords:["efeito","colateral","adverso","rea\xe7\xe3o"],response:"Efeitos adversos podem ocorrer durante o tratamento. Os mais comuns s\xe3o colora\xe7\xe3o da urina (rifampicina) e escurecimento da pele (clofazimina). Procure orienta\xe7\xe3o m\xe9dica se tiver d\xfavidas."},{keywords:["tempo","dura\xe7\xe3o","quanto","meses"],response:"O tratamento PQT-U dura 6 meses, com doses mensais supervisionadas. \xc9 fundamental completar todo o tratamento para garantir a cura."},{keywords:["gravidez","gestante","gr\xe1vida"],response:"O tratamento para hansen\xedase pode ser realizado durante a gravidez com adapta\xe7\xf5es. \xc9 essencial acompanhamento m\xe9dico especializado."}])if(e.keywords.some(e=>t.includes(e)))return e.response;return null}getEmergencyResponse(e,t,a){let r="",n="";return(null==a?void 0:a.category)===o.ANXIOUS?(r="Compreendo sua preocupa\xe7\xe3o. Embora eu n\xe3o possa acessar todas as informa\xe7\xf5es no momento, posso assegurar que o tratamento para hansen\xedase \xe9 seguro e eficaz quando seguido corretamente.",n="Para informa\xe7\xf5es urgentes, procure: Posto de Sa\xfade mais pr\xf3ximo ou ligue 136 (Disque Sa\xfade)"):(null==a?void 0:a.category)===o.FRUSTRATED?(r="Entendo sua frustra\xe7\xe3o. O sistema est\xe1 temporariamente indispon\xedvel, mas posso orientar sobre o b\xe1sico do tratamento PQT-U.",n="Para respostas mais espec\xedficas: Unidade B\xe1sica de Sa\xfade ou Ambulat\xf3rio de Hansen\xedase"):(r="Sistema temporariamente indispon\xedvel. O tratamento para hansen\xedase (PQT-U) \xe9 padronizado e eficaz - continue seguindo as orienta\xe7\xf5es do seu m\xe9dico.",n="Para mais informa\xe7\xf5es: Minist\xe9rio da Sa\xfade - Disque 136"),e.toLowerCase().includes("dose")||e.toLowerCase().includes("quantidade")?r+=" Lembre-se: n\xe3o altere doses sem orienta\xe7\xe3o m\xe9dica.":(e.toLowerCase().includes("efeito")||e.toLowerCase().includes("rea\xe7\xe3o"))&&(r+=" Se apresentar rea\xe7\xf5es adversas intensas, procure atendimento m\xe9dico."),{success:!0,response:r,source:"emergency",confidence:.4,suggestion:"Sistema indispon\xedvel. Recomendo consultar profissional de sa\xfade para informa\xe7\xf5es espec\xedficas.",emergency_contact:n}}adaptResponseToSentiment(e,t){if(!t)return e;switch(t.category){case o.ANXIOUS:return"Entendo sua preocupa\xe7\xe3o. ".concat(e," Lembre-se que voc\xea n\xe3o est\xe1 sozinho(a) neste tratamento.");case o.FRUSTRATED:return"".concat(e," Espero que isso esclare\xe7a sua d\xfavida de forma mais direta.");case o.POSITIVE:return"".concat(e," Fico feliz em poder ajudar!");default:return e}}initializeLocalKnowledge(){["O tratamento PQT-U \xe9 seguro e eficaz quando seguido corretamente","Nunca interrompa o tratamento sem orienta\xe7\xe3o m\xe9dica","Efeitos como colora\xe7\xe3o da urina e escurecimento da pele s\xe3o normais","O tratamento dura 6 meses com doses mensais supervisionadas","A hansen\xedase tem cura quando tratada adequadamente"].forEach((e,t)=>{this.localKnowledge.set("essential_".concat(t),e)})}initializeEmergencyResponses(){this.emergencyResponses.set("network","Conex\xe3o temporariamente indispon\xedvel. Continue seu tratamento normalmente e tente novamente mais tarde."),this.emergencyResponses.set("server_error","Sistema em manuten\xe7\xe3o. Para d\xfavidas urgentes, procure seu posto de sa\xfade."),this.emergencyResponses.set("data_corruption","Problema nos dados detectado. Recomendo consultar profissional de sa\xfade.")}recordFailure(){this.failureCount++,this.lastFailureTime=Date.now()}getFailureStats(){let e=Date.now()-this.lastFailureTime,t="good";return this.failureCount>10&&e<3e5?t="degraded":this.failureCount>20&&(t="critical"),{count:this.failureCount,lastFailure:this.lastFailureTime,systemHealth:t}}resetFailureCount(){this.failureCount=0,this.lastFailureTime=0}constructor(){this.failureCount=0,this.lastFailureTime=0,this.localKnowledge=new Map,this.emergencyResponses=new Map,this.initializeLocalKnowledge(),this.initializeEmergencyResponses()}}let V=J.getInstance();async function X(e,t,a){let r="unknown";return t.message.includes("network")||t.message.includes("fetch")?r="network":t.message.includes("timeout")?r="timeout":t.message.includes("500")||t.message.includes("502")||t.message.includes("503")?r="server_error":(t.message.includes("corrupt")||t.message.includes("invalid"))&&(r="data_corruption"),V.executeFallback(e,r,a)}let Z="conversation-history",$={dr_gasnelio:{personaId:"dr_gasnelio",expertiseAreas:["clinical","dosage","protocols","diagnosis","treatment"],keywords:["dose","dosagem","mg","rifampicina","dapsona","clofazimina","protocolo","tratamento","diagn\xf3stico","cl\xednico","m\xe9dico","prescri\xe7\xe3o","posologia","terap\xeautica","PQT-U","PQT","multibacilar","paucibacilar","MB","PB","esquema","rea\xe7\xe3o","efeito colateral","contraindica\xe7\xe3o","intera\xe7\xe3o"],specialties:["Dosagens","Protocolos Cl\xednicos","Diagn\xf3stico"]},ga:{personaId:"ga",expertiseAreas:["education","dispensation","family","guidance","support"],keywords:["paciente","fam\xedlia","educa\xe7\xe3o","orienta\xe7\xe3o","ensino","dispensa\xe7\xe3o","farm\xe1cia","entrega","cronograma","organiza\xe7\xe3o","ader\xeancia","ades\xe3o","motiva\xe7\xe3o","apoio","comunica\xe7\xe3o","explicar","ensinar","orientar","acompanhar","conversar","d\xfavidas","medo","preconceito","estigma","social"],specialties:["Educa\xe7\xe3o do Paciente","Dispensa\xe7\xe3o","Apoio Familiar"]}};class ee{set(e,t){let a=this.normalizeQuestion(e);this.cache.set(a,{analysis:t,timestamp:Date.now()}),this.cleanupExpired()}get(e){let t=this.normalizeQuestion(e),a=this.cache.get(t);return a&&Date.now()-a.timestamp<this.TTL?a.analysis:(a&&this.cache.delete(t),null)}normalizeQuestion(e){return e.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g," ").trim()}cleanupExpired(){let e=Date.now();Array.from(this.cache.entries()).forEach(t=>{let[a,r]=t;e-r.timestamp>=this.TTL&&this.cache.delete(a)})}constructor(){this.cache=new Map,this.TTL=3e5}}let et=new ee;async function ea(e,t){try{let a=et.get(e);if(a)return a;let r=er(e,t),o=null;try{o=await (0,U.$N)(e)}catch(e){console.warn("Backend scope detection failed, using local analysis:",e)}let n=function(e,t,a){if(!t||!t.recommended_persona)return e;let r=t.recommended_persona;if(a[r]){let a=t.confidence||.5,o=(e.confidence+a)/2;if(r===e.recommendedPersonaId)return{...e,confidence:Math.min(.95,o+.2),reasoning:"".concat(e.reasoning," (confirmado por IA)")};if(a>e.confidence)return{recommendedPersonaId:r,confidence:o,reasoning:t.reasoning||"Recomendado por an\xe1lise de IA",scope:t.scope||e.scope,alternatives:[{personaId:e.recommendedPersonaId,confidence:e.confidence,reasoning:e.reasoning},...e.alternatives]}}return e}(r,o,t);return et.set(e,n),n}catch(a){return console.error("Erro na an\xe1lise de roteamento:",a),er(e,t)}}function er(e,t){var a;let r=e.toLowerCase(),o={},n={};Object.keys(t).forEach(e=>{let t=$[e];if(!t)return;let a=0,s=[];t.keywords.forEach(e=>{r.includes(e.toLowerCase())&&(a+=e.length>6?2:1,s.push(e))}),t.expertiseAreas.forEach(e=>{r.includes(e)&&(a+=3,s.push(e))}),o[e]=a,n[e]=s});let s=Object.entries(o).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).filter(e=>{let[,t]=e;return t>0});if(0===s.length){let e="dr_gasnelio";return{recommendedPersonaId:e,confidence:.3,reasoning:"Quest\xe3o geral - roteado para especialista cl\xednico",scope:"general",alternatives:Object.keys(t).filter(t=>t!==e).map(e=>({personaId:e,confidence:.2,reasoning:"Alternativa dispon\xedvel"}))}}let[i,c]=s[0],l=(null===(a=$[i])||void 0===a?void 0:a.keywords.length)||1,d=n[i]||[];return{recommendedPersonaId:i,confidence:Math.min(.95,c/l*.8+.2),reasoning:d.length>0?"Especialista em: ".concat(d.slice(0,3).join(", ")):"Melhor correspond\xeancia de expertise",scope:["dose","dosagem","mg","quantidade","posologia"].some(e=>r.includes(e))?"dosage":["diagn\xf3stico","sintoma","caso","tratamento","protocolo"].some(e=>r.includes(e))?"clinical":["paciente","fam\xedlia","explicar","ensinar","orientar"].some(e=>r.includes(e))?"education":["dispensar","farm\xe1cia","entrega","cronograma"].some(e=>r.includes(e))?"dispensation":"general",alternatives:s.slice(1,3).map(e=>{var t;let[a,r]=e;return{personaId:a,confidence:Math.min(.8,r/l*.6+.1),reasoning:(null===(t=n[a])||void 0===t?void 0:t.length)>0?"Tamb\xe9m especialista em: ".concat(n[a].slice(0,2).join(", ")):"Alternativa com expertise relacionada"}})}}var eo=a(8497),en=a(5121);let es=e=>{let{size:t="medium",color:a=en.rS.colors.primary[500],message:r,inline:o=!1}=e,s={small:"16px",medium:"24px",large:"32px"},i={display:o?"inline-flex":"flex",alignItems:"center",justifyContent:"center",gap:"8px",...!o&&{minHeight:"40px",padding:"8px"}},c={width:s[t],height:s[t],border:"2px solid ".concat(a,"20"),borderTop:"2px solid ".concat(a),borderRadius:"50%",animation:"spin 1s linear infinite"};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d(),{id:"d732791046adfab6",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"}),(0,n.jsxs)("div",{style:i,className:"jsx-d732791046adfab6",children:[(0,n.jsx)("div",{style:c,className:"jsx-d732791046adfab6"}),r&&(0,n.jsx)("span",{style:{fontSize:"0.9rem",color:en.rS.colors.neutral[600],fontWeight:500},className:"jsx-d732791046adfab6",children:r})]})]})},ei=()=>(0,n.jsx)("div",{style:{padding:"20px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:en.rS.colors.neutral[50],borderRadius:"8px"},children:(0,n.jsx)(es,{size:"medium",message:"Carregando hist\xf3rico..."})}),ec=(0,s.lazy)(()=>a.e(824).then(a.bind(a,824)));function el(){let{personas:e,loading:t,error:a}=(0,B.H)(),{createConversation:r,switchToConversation:l,deleteConversation:d,renameConversation:m,addMessageToConversation:u,getCurrentMessages:p,getConversationsForPersona:g,currentConversationId:f}=function(){let[e,t]=(0,s.useState)([]),[a,r]=(0,s.useState)(null),[o,n]=(0,s.useState)(!1),[i,c]=(0,s.useState)(null),l=(0,s.useRef)(null);(0,s.useEffect)(()=>{try{n(!0);let e=localStorage.getItem(Z);if(e){let a=JSON.parse(e);if(Array.isArray(a)){let e=a.filter(e=>e&&"object"==typeof e&&e.id&&e.personaId).slice(0,50);t(e)}}c(null)}catch(e){console.error("Erro ao carregar hist\xf3rico de conversas:",e),c("Erro ao carregar hist\xf3rico de conversas"),t([])}finally{n(!1)}},[]);let d=(0,s.useCallback)(e=>{l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{try{let t=e.slice(0,50).map(e=>({...e,messages:e.messages.slice(-100)})),a=JSON.stringify(t);if(a.length>4718592){console.warn("Dados muito grandes para localStorage, limpando conversas antigas");let e=t.slice(0,Math.floor(25));localStorage.setItem(Z,JSON.stringify(e))}else localStorage.setItem(Z,a);c(null)}catch(t){console.error("Erro ao salvar hist\xf3rico de conversas:",t),c("Erro ao salvar hist\xf3rico de conversas");try{let t=e.slice(0,10);localStorage.setItem(Z,JSON.stringify(t))}catch(e){console.error("Erro cr\xedtico ao salvar:",e)}}},300)},[]),m=(0,s.useCallback)(e=>{try{if(!e||"string"!=typeof e)return"Nova conversa";let t=e.replace(/[^\w\sÀ-ſ]/gi,"").trim().split(" ").filter(e=>e.length>0).slice(0,6).join(" ");return t.length>40&&(t=t.substring(0,37)+"..."),t.length<3&&(t="Nova conversa"),t}catch(e){return console.error("Erro ao gerar t\xedtulo da conversa:",e),"Nova conversa"}},[]),u=(0,s.useCallback)((a,o)=>{try{if(!a||"string"!=typeof a)throw Error("personaId \xe9 obrigat\xf3rio");let n="conv_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),s=Date.now(),i=[{id:n,personaId:a,title:o?m(o):"Nova conversa",messages:[],lastActivity:s,createdAt:s},...e];return t(i),d(i),r(n),c(null),n}catch(e){return console.error("Erro ao criar conversa:",e),c("Erro ao criar nova conversa"),""}},[e,d,m]),p=(0,s.useCallback)(()=>a&&e.find(e=>e.id===a)||null,[a,e]),g=(0,s.useCallback)(r=>{if(a&&r)try{if(!r.content||!r.role||!r.timestamp)throw Error("Mensagem inv\xe1lida");let o=e.map(e=>{if(e.id===a){let t={...e,messages:[...e.messages,r].slice(-100),lastActivity:Date.now()};return 0===e.messages.length&&"user"===r.role&&(t.title=m(r.content)),t}return e});t(o),d(o),c(null)}catch(e){console.error("Erro ao adicionar mensagem:",e),c("Erro ao adicionar mensagem \xe0 conversa")}},[a,e,d,m]),f=(0,s.useCallback)(()=>{let e=p();return(null==e?void 0:e.messages)||[]},[p]),h=(0,s.useCallback)(t=>e.filter(e=>e.personaId===t).sort((e,t)=>t.lastActivity-e.lastActivity).map(e=>({id:e.id,personaId:e.personaId,title:e.title,lastMessage:e.messages.length>0?e.messages[e.messages.length-1].content.substring(0,50)+"...":"Conversa vazia",lastActivity:e.lastActivity,messageCount:e.messages.length})),[e]),y=(0,s.useCallback)(e=>{r(e)},[]),b=(0,s.useCallback)(o=>{let n=e.filter(e=>e.id!==o);t(n),d(n),a===o&&r(null)},[e,a,d]),x=(0,s.useCallback)((a,r)=>{let o=e.map(e=>e.id===a?{...e,title:r.trim()||"Conversa sem t\xedtulo"}:e);t(o),d(o)},[e,d]),v=(0,s.useCallback)(()=>{t([]),r(null),localStorage.removeItem("conversation-history")},[]),k=(0,s.useCallback)(()=>({totalConversations:e.length,totalMessages:e.reduce((e,t)=>e+t.messages.length,0),personaStats:e.reduce((e,t)=>(e[t.personaId]=(e[t.personaId]||0)+1,e),{})}),[e]);return(0,s.useEffect)(()=>()=>{l.current&&clearTimeout(l.current)},[]),{conversations:e,currentConversationId:a,loading:o,error:i,getCurrentConversation:p,getCurrentMessages:f,createConversation:u,switchToConversation:y,deleteConversation:b,renameConversation:x,clearAllConversations:v,addMessageToConversation:g,getConversationsForPersona:h,getStatistics:k,clearError:()=>c(null)}}(),{profile:h,updateProfile:y,getRecommendedPersona:b}=(0,eo.Gr)(),{loading:x,error:v,sendMessage:k,currentSentiment:w,personaSwitchSuggestion:S,knowledgeStats:j,lastSearchResult:C,isSearchingKnowledge:z,fallbackState:E,resetFallback:T,resetSystemFailures:D}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{persistToLocalStorage:t=!0,storageKey:a="chat-history",enableSentimentAnalysis:r=!0,enableKnowledgeEnrichment:n=!0,onMessageReceived:i}=e,c=(0,s.useCallback)(()=>{if(!t)return[];try{let e=localStorage.getItem(a);return e?JSON.parse(e):[]}catch(e){return console.error("Erro ao carregar hist\xf3rico do chat:",e),[]}},[t,a]),[l,d]=(0,s.useState)(c),m=(0,s.useRef)(l),[u,p]=(0,s.useState)(!1),[g,f]=(0,s.useState)(null),[h,y]=(0,s.useState)(null);(0,s.useEffect)(()=>{m.current=l},[l]);let{currentSentiment:b,analyzeSentiment:x,sentimentHistory:v,clearHistory:k}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{debounceMs:t=500,maxHistorySize:a=10,autoAnalyze:r=!0}=e,[n,i]=(0,s.useState)(null),[c,l]=(0,s.useState)([]),[d,m]=(0,s.useState)(!1),u=(0,s.useRef)(null),p=(0,s.useRef)(""),g=(0,s.useCallback)(async e=>{if(!e||e.trim().length<3){let e={score:0,magnitude:0,category:o.NEUTRAL,confidence:0,keywords:[]};return i(e),e}if(e===p.current&&n)return n;m(!0);try{let t=await W.analyze(e);return i(t),p.current=e,l(r=>[{timestamp:Date.now(),text:e.substring(0,100),result:t},...r].slice(0,a)),t}catch(t){console.error("Erro ao analisar sentimento:",t);let e={score:0,magnitude:0,category:o.NEUTRAL,confidence:0,keywords:[]};return i(e),e}finally{m(!1)}},[n,a]);(0,s.useCallback)(e=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{g(e)},t)},[g,t]);let f=(0,s.useCallback)(()=>{l([]),i(null),p.current=""},[]),h=c.length>0?(()=>{let e;let t=c.reduce((e,t)=>e+t.result.score,0)/c.length;return e=t>.2?o.POSITIVE:t<-.4?o.FRUSTRATED:t<-.2?o.ANXIOUS:o.NEUTRAL,{score:t,category:e}})():null;return(0,s.useEffect)(()=>()=>{u.current&&clearTimeout(u.current)},[]),{currentSentiment:n,sentimentHistory:c,analyzeSentiment:g,clearHistory:f,isAnalyzing:d,averageSentiment:h}}({debounceMs:300,autoAnalyze:r}),{searchKnowledge:w,enrichMessage:S,isSearching:j,lastSearchResult:C,stats:z}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{prefetchCommon:t=!0,autoEnrich:a=!0,cacheTimeout:r=3e5}=e,[o,n]=(0,s.useState)(!1),[i,c]=(0,s.useState)(null),[l,d]=(0,s.useState)(null),[m,u]=(0,s.useState)(null),p=(0,s.useRef)(null);(0,s.useEffect)(()=>{t&&Y.prefetchCommonTopics().catch(e=>console.error("Erro no prefetch:",e)),y()},[t]);let g=(0,s.useCallback)(async(e,t,a)=>{n(!0),u(null),p.current&&clearTimeout(p.current);try{let r=await Y.searchKnowledge(e,t,a,{maxChunks:3,minConfidence:.3});return c(r),console.log("Knowledge search completed:",{question:e.substring(0,50)+"...",confidence:r.confidence,chunks:r.chunks.length,cached:r.cached}),r}catch(t){u(t instanceof Error?t.message:"Erro ao buscar conhecimento"),console.error("Erro na busca de conhecimento:",t);let e={chunks:[],combined_context:"",confidence:0,cached:!1,processing_time:0};return c(e),e}finally{n(!1)}},[]),f=(0,s.useCallback)(async(e,t,r)=>{if(!a)return{original:e,enriched:e,confidence:0,sources:[]};try{return await Y.enrichMessage(e,t,r)}catch(t){return console.error("Erro ao enriquecer mensagem:",t),{original:e,enriched:e,confidence:0,sources:[]}}},[a]),h=(0,s.useCallback)(async(e,t,a,r)=>{try{await G.sendFeedback({query:e,response:t,rating:a,comments:r}),setTimeout(()=>y(),1e3)}catch(e){console.error("Erro ao enviar avalia\xe7\xe3o:",e),u("Erro ao enviar avalia\xe7\xe3o")}},[]),y=(0,s.useCallback)(async()=>{try{let e=await G.getStats();d(e)}catch(e){console.error("Erro ao buscar estat\xedsticas:",e)}},[]),b=(0,s.useCallback)(()=>{G.clearCache(),c(null),console.log("Cache de conhecimento limpo")},[]);return(0,s.useEffect)(()=>()=>{p.current&&clearTimeout(p.current)},[]),{isSearching:o,lastSearchResult:i,stats:l,error:m,searchKnowledge:g,enrichMessage:f,rateResponse:h,refreshStats:y,clearCache:b}}({prefetchCommon:!0,autoEnrich:n}),{withFallback:E,shouldUseFallback:T,state:D,reset:R,getSystemStats:A,resetSystemFailures:I}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{maxRetries:t=3,retryDelay:a=1e3,autoReset:r=!0}=e,[o,n]=(0,s.useState)({isActive:!1,result:null,attempts:0,lastFailureType:null,systemHealth:"good"}),i=(0,s.useRef)(),c=(0,s.useCallback)(async(e,t,a)=>{n(e=>({...e,isActive:!0,attempts:e.attempts+1}));try{let o=await X(e,t,a);return n(e=>({...e,result:o,lastFailureType:t.message,systemHealth:V.getFailureStats().systemHealth})),r&&setTimeout(()=>{n(e=>({...e,isActive:!1,result:null}))},5e3),o}catch(t){console.error("Fallback tamb\xe9m falhou:",t);let e={success:!1,response:"Sistema temporariamente indispon\xedvel. Tente novamente em alguns minutos ou consulte um profissional de sa\xfade.",source:"emergency",confidence:.1,emergency_contact:"Disque Sa\xfade: 136"};return n(t=>({...t,result:e,systemHealth:"critical"})),e}},[r]),l=(0,s.useCallback)(async(e,t,a)=>{try{let t=await e();return o.attempts>0&&r&&n(e=>({...e,attempts:0,isActive:!1,result:null})),t}catch(e){return console.warn("Opera\xe7\xe3o falhou, executando fallback:",e),await c(t,e,a)}},[c,o.attempts,r]),d=(0,s.useCallback)(e=>{let t=V.getFailureStats();if("degraded"===t.systemHealth||"critical"===t.systemHealth)return!0;if(e){let t=e.message.toLowerCase();return t.includes("network")||t.includes("timeout")||t.includes("500")||t.includes("502")||t.includes("503")}return!1},[]),m=(0,s.useCallback)(e=>{let t=e.message.toLowerCase();return t.includes("network")?"Verifique sua conex\xe3o com a internet":t.includes("timeout")?"Tente novamente - o servidor pode estar ocupado":t.includes("500")||t.includes("502")||t.includes("503")?"Sistema em manuten\xe7\xe3o - tente novamente em alguns minutos":t.includes("404")?"Recurso n\xe3o encontrado - pode ser um problema tempor\xe1rio":"Erro inesperado - tente novamente ou consulte suporte"},[]),u=(0,s.useCallback)(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;try{return await e()}catch(n){if(r>=t)throw n;let o=a*Math.pow(2,r-1);return new Promise((t,a)=>{i.current=setTimeout(async()=>{try{let a=await u(e,r+1);t(a)}catch(e){a(e)}},o)})}},[t,a]),p=(0,s.useCallback)(()=>{i.current&&clearTimeout(i.current),n({isActive:!1,result:null,attempts:0,lastFailureType:null,systemHealth:V.getFailureStats().systemHealth})},[]),g=(0,s.useCallback)(()=>V.getFailureStats(),[]),f=(0,s.useCallback)(()=>{V.resetFailureCount(),n(e=>({...e,systemHealth:"good"}))},[]);return{state:o,isActive:o.isActive,result:o.result,attempts:o.attempts,systemHealth:o.systemHealth,executeFallback:c,withFallback:l,shouldUseFallback:d,getFailureSuggestion:m,retryWithBackoff:u,reset:p,getSystemStats:g,resetSystemFailures:f}}({maxRetries:2,retryDelay:1e3,autoReset:!0}),N=(0,s.useRef)(""),_=(0,s.useCallback)(e=>{if(t)try{localStorage.setItem(a,JSON.stringify(e))}catch(e){console.error("Erro ao salvar hist\xf3rico do chat:",e)}},[t,a]);(0,s.useEffect)(()=>{var e;r&&b&&N.current&&("dr-gasnelio"===(e=N.current)&&("anxious"===b.category||"frustrated"===b.category)&&b.confidence>.7||"ga"===e&&"neutral"===b.category&&b.magnitude<.3&&b.confidence>.7?y("dr-gasnelio"===N.current?"ga":"dr-gasnelio"):y(null))},[b,r]);let F=(0,s.useCallback)(async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e.trim())return;let o=null;if(r&&0===a)try{o=await x(e)}catch(e){console.error("Erro na an\xe1lise de sentimento:",e)}let s=null;if(n&&0===a)try{let a=await w(e,o||void 0,t);a.confidence>.3&&a.combined_context&&(s={context:a.combined_context,confidence:a.confidence,sources:a.chunks.map(e=>e.section)})}catch(e){console.error("Erro ao buscar contexto:",e)}N.current=t;let c={role:"user",content:e.trim(),timestamp:Date.now(),persona:t};0===a&&d(e=>{let t=[...e,c];return m.current=t,_(t),t}),p(!0),f(null);try{let r=0===a?[...m.current,c]:m.current,n={question:e.trim(),personality_id:t,conversation_history:r.slice(-10),...o&&{sentiment:{category:o.category,score:o.score,magnitude:o.magnitude}},...s&&{knowledge_context:s}},l=await E(()=>(0,U.bE)(n),e.trim(),o||void 0);if(l&&"object"==typeof l&&"source"in l){let e={role:"assistant",content:l.response,timestamp:Date.now(),persona:t,metadata:{isFallback:!0,fallbackSource:l.source,confidence:l.confidence,suggestion:l.suggestion,emergency_contact:l.emergency_contact}};d(t=>{let a=[...t,e];return m.current=a,_(a),i&&i(e),a}),p(!1);return}let u={role:"assistant",content:l.answer,timestamp:l.timestamp?new Date(l.timestamp).getTime():Date.now(),persona:l.persona};d(e=>{let t=[...e,u];return m.current=t,_(t),i&&i(u),t}),p(!1)}catch(r){if(console.error("Erro ao enviar mensagem (tentativa ".concat(a+1,"):"),r),a<3)setTimeout(()=>{F(e,t,a+1)},1e3*Math.pow(2,a)),f("Tentando novamente... (".concat(a+1,"/").concat(3,")"));else{let e=r instanceof Error?r.message:"Erro ao enviar mensagem";f("".concat(e," (Falha ap\xf3s ").concat(3," tentativas)")),p(!1)}}a>=3&&p(!1)},[_,x,r]);return{messages:l,loading:u,error:g,sendMessage:F,clearMessages:(0,s.useCallback)(()=>{d([]),t&&localStorage.removeItem(a),r&&k()},[t,a,r,k]),getMessagesForPersona:(0,s.useCallback)(e=>m.current.filter(t=>t.persona===e),[]),currentSentiment:b,sentimentHistory:v,personaSwitchSuggestion:h,knowledgeStats:z,lastSearchResult:C,isSearchingKnowledge:j,fallbackState:D,resetFallback:R,getSystemStats:A,resetSystemFailures:I}}({persistToLocalStorage:!1,enableSentimentAnalysis:!0,enableKnowledgeEnrichment:!0,onMessageReceived:(0,s.useCallback)(e=>{u(e)},[u])}),[R,A]=(0,s.useState)(""),[I,N]=(0,s.useState)("ga"),[_,F]=(0,s.useState)(!1),[P,M]=(0,s.useState)(!1),[L,H]=(0,s.useState)(""),q=(0,s.useCallback)(()=>{if(!e||0===Object.keys(e).length)return[];try{return Object.keys(e).flatMap(t=>t&&e[t]?g(t):[])}catch(e){return console.error("Erro ao obter conversas:",e),[]}},[e,g]);(0,s.useEffect)(()=>{let e=()=>{M(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let K=p(),{currentAnalysis:Q,isAnalyzing:J,shouldShowRouting:ee,getRecommendedPersona:et,analyzeQuestion:er,acceptRecommendation:es,rejectRecommendation:el,clearAnalysis:ed,getExplanation:em}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{enabled:a=!0,debounceMs:r=800,minConfidenceThreshold:o=.4}=t,[n,i]=(0,s.useState)({currentAnalysis:null,isAnalyzing:!1,error:null,hasAnalyzed:!1}),c=(0,s.useRef)(null),l=(0,s.useRef)(""),d=(0,s.useRef)({acceptedRecommendations:0,rejectedRecommendations:0,totalAnalyses:0});(0,s.useEffect)(()=>()=>{c.current&&clearTimeout(c.current)},[]);let m=(0,s.useCallback)(async t=>{if(!a||!t.trim()||0===Object.keys(e).length)return;let n=t.trim();n!==l.current&&(l.current=n,c.current&&clearTimeout(c.current),c.current=setTimeout(async()=>{i(e=>({...e,isAnalyzing:!0,error:null}));try{let t=await ea(n,e);t.confidence>=o?(i(e=>({...e,currentAnalysis:t,isAnalyzing:!1,hasAnalyzed:!0})),d.current.totalAnalyses++):i(e=>({...e,currentAnalysis:null,isAnalyzing:!1,hasAnalyzed:!0}))}catch(e){console.error("Erro na an\xe1lise de roteamento:",e),i(t=>({...t,currentAnalysis:null,isAnalyzing:!1,error:e instanceof Error?e.message:"Erro na an\xe1lise",hasAnalyzed:!0}))}},r))},[a,e,o,r]),u=(0,s.useCallback)(()=>{n.currentAnalysis&&(d.current.acceptedRecommendations++,console.log("Routing recommendation accepted:",{personaId:n.currentAnalysis.recommendedPersonaId,confidence:n.currentAnalysis.confidence,scope:n.currentAnalysis.scope}))},[n.currentAnalysis]),p=(0,s.useCallback)(e=>{n.currentAnalysis&&(d.current.rejectedRecommendations++,console.log("Routing recommendation rejected:",{recommended:n.currentAnalysis.recommendedPersonaId,selected:e,confidence:n.currentAnalysis.confidence,scope:n.currentAnalysis.scope,reasoning:n.currentAnalysis.reasoning})),i(e=>({...e,currentAnalysis:null}))},[n.currentAnalysis]),g=(0,s.useCallback)(()=>{i(e=>({...e,currentAnalysis:null,error:null,hasAnalyzed:!1})),l.current="",c.current&&clearTimeout(c.current)},[]),f=(0,s.useCallback)(()=>n.currentAnalysis?function(e,t){let a=t[e.recommendedPersonaId];if(!a)return e.reasoning;let r=$[e.recommendedPersonaId]||null,o=(null==r?void 0:r.specialties.join(", "))||"quest\xf5es especializadas";return"".concat(a.name," especializa-se em ").concat(o,". ").concat(e.reasoning)}(n.currentAnalysis,e):"Nenhuma an\xe1lise dispon\xedvel",[n.currentAnalysis,e]),h=(0,s.useCallback)(()=>!!n.currentAnalysis&&n.currentAnalysis.confidence<.6,[n.currentAnalysis]),y=(0,s.useCallback)(()=>{let e=d.current,t=e.totalAnalyses>0?e.acceptedRecommendations/e.totalAnalyses*100:0;return{...e,acceptanceRate:Math.round(t)}},[]),b=(0,s.useCallback)(()=>!!(n.currentAnalysis&&n.currentAnalysis.confidence>=o&&!n.isAnalyzing),[n.currentAnalysis,n.isAnalyzing,o]),x=(0,s.useCallback)(()=>n.currentAnalysis&&e[n.currentAnalysis.recommendedPersonaId]||null,[n.currentAnalysis,e]),v=(0,s.useCallback)(()=>n.currentAnalysis?n.currentAnalysis.alternatives.filter(t=>e[t.personaId]).map(t=>({...t,persona:e[t.personaId]})):[],[n.currentAnalysis,e]);return{currentAnalysis:n.currentAnalysis,isAnalyzing:n.isAnalyzing,error:n.error,hasAnalyzed:n.hasAnalyzed,analyzeQuestion:m,acceptRecommendation:u,rejectRecommendation:p,clearAnalysis:g,getExplanation:f,isAmbiguous:h,getAnalytics:y,shouldShowRouting:b,getRecommendedPersona:x,getAlternatives:v}}(e,{enabled:!0,debounceMs:1e3,minConfidenceThreshold:.6});(0,s.useEffect)(()=>{!I&&R.length>10&&er(R)},[R,I,er]),(0,s.useEffect)(()=>{if(e&&Object.keys(e).length>0&&!I){let t=null;if(h&&h.selectedPersona&&e[h.selectedPersona])t=h.selectedPersona;else if(h){let a=b();a&&e[a]&&(t=a)}if(!t){let a=localStorage.getItem("selectedPersona");a&&e[a]&&(t=a)}t||(t=e.ga?"ga":e.dr_gasnelio?"dr_gasnelio":Object.keys(e)[0]),t&&(console.log("[ChatPage] Setting initial persona:",t),N(t),localStorage.setItem("selectedPersona",t),h&&h.selectedPersona!==t&&y({selectedPersona:t}),f||r(t))}},[e]);let eu=(0,s.useCallback)(async(e,t)=>{u({role:"user",content:e,timestamp:Date.now(),persona:t});try{await k(e,t)}catch(e){console.error("Erro ao enviar mensagem:",e)}},[k,u]),ep=async e=>{if(e.preventDefault(),!R.trim())return;let t=R.trim();if(!I){H(t),await er(t);return}if(!x){A("");try{await eu(t,I)}catch(e){console.error("Erro ao enviar mensagem:",e)}}},eg=e=>{N(e),localStorage.setItem("selectedPersona",e),r(e),ed(),L&&(A(L),H(""))};if((0,s.useCallback)(e=>{es(),eg(e)},[es]),(0,s.useCallback)(()=>{el(I||"")},[el,I]),(0,s.useCallback)(()=>{console.log("Explica\xe7\xe3o do roteamento:",em())},[em]),t)return(0,n.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:"2rem",marginBottom:"20px"},children:"⏳"}),(0,n.jsx)("p",{children:"Carregando chat..."})]})});if(a)return(0,n.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:"2rem",marginBottom:"20px"},children:"⚠️"}),(0,n.jsxs)("p",{children:["Erro ao carregar chat: ",a]}),(0,n.jsx)(i.default,{href:"/",style:{color:en.rS.colors.primary[500],textDecoration:"underline"},children:"Voltar ao in\xedcio"})]})});let ef=I?e[I]:null;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,{currentPersona:null==ef?void 0:ef.name}),(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(ei,{}),children:(0,n.jsx)(ec,{conversations:q(),currentConversationId:f,personas:e,onConversationSelect:e=>{l(e);let t=q().find(t=>t.id===e);t&&(N(t.personaId),localStorage.setItem("selectedPersona",t.personaId)),ed()},onNewConversation:e=>{r(e),N(e),localStorage.setItem("selectedPersona",e)},onDeleteConversation:d,onRenameConversation:m,isVisible:_,onToggle:()=>F(!_)})}),(0,n.jsx)("div",{style:{marginLeft:_&&!P?"320px":"0",transition:"margin-left 0.3s ease",position:"relative"},children:(0,n.jsx)(O,{personas:e,selectedPersona:I,onPersonaChange:eg,messages:K,inputValue:R,onInputChange:A,onSendMessage:ep,isLoading:x,isMobile:P,currentSentiment:w,knowledgeStats:j,isSearchingKnowledge:z,fallbackState:E,onHistoryToggle:()=>F(!_),showHistory:_})})]})}},319:function(e,t,a){"use strict";var r=a(7437),o=a(29),n=a.n(o),s=a(2265),i=a(3861),c=a(5121);let l=(0,s.memo)(function(e){let{persona:t,personaId:a,size:o="medium",showStatus:l=!1,isTyping:d=!1,onClick:m,ariaLabel:u,className:p="",style:g={}}=e,[f,h]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!1),x=(0,s.useMemo)(()=>{let e=(0,i.Qu)(a);return console.log("[PersonaAvatar] personaId: ".concat(a,", avatarUrl: ").concat(e)),e||null},[a]),v=(0,s.useMemo)(()=>(0,c.pf)(a),[a]),k=(0,s.useMemo)(()=>{switch(o){case"tiny":return{width:"24px",height:"24px",fontSize:"0.75rem"};case"small":return{width:"32px",height:"32px",fontSize:"1rem"};case"large":return{width:"64px",height:"64px",fontSize:"2rem"};default:return{width:"48px",height:"48px",fontSize:"1.5rem"}}},[o]),w=(0,s.useCallback)(()=>{h(!1),b(!1)},[]),S=(0,s.useCallback)(()=>{console.warn("Erro ao carregar avatar para persona ".concat(a,":"),x),h(!0),b(!1)},[a,x]),j=(0,s.useCallback)(()=>{b(!0)},[]),C=(0,s.useCallback)(()=>{m&&!y&&m()},[m,y]),z=(0,s.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&m&&!y&&(e.preventDefault(),m())},[m,y]),E="Avatar de ".concat(t.name).concat(d?", digitando":"").concat(l?", online":"");return(0,r.jsxs)("div",{role:m?"button":"img",tabIndex:m?0:-1,"aria-label":u||E,style:{position:"relative",display:"inline-block",cursor:m?"pointer":"default",outline:"none",...g},onClick:C,onKeyDown:z,className:"jsx-5912179cbb9301c9 "+(p||""),children:[(0,r.jsxs)("div",{style:{...k,borderRadius:"50%",background:f||!x?"linear-gradient(135deg, ".concat(v.primaryColor," 0%, ").concat(v.secondaryColor," 100%)"):"white",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",boxShadow:"0 4px 12px ".concat(v.primaryColor,"30"),transition:"all 0.3s ease",border:d?"3px solid ".concat(c.rS.colors.educational.success):"3px solid ".concat(v.accentColor,"40"),animation:d?"pulse 2s infinite":"none",overflow:"hidden"},onMouseEnter:e=>{m&&!y&&(e.currentTarget.style.transform="scale(1.1)",e.currentTarget.style.boxShadow="0 6px 20px ".concat(v.primaryColor,"40"))},onMouseLeave:e=>{m&&(e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 12px ".concat(v.primaryColor,"30"))},onFocus:e=>{m&&(e.currentTarget.style.outline="2px solid ".concat(v.primaryColor),e.currentTarget.style.outlineOffset="2px")},onBlur:e=>{m&&(e.currentTarget.style.outline="none")},className:"jsx-5912179cbb9301c9",children:[y&&(0,r.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.8rem",color:"white"},className:"jsx-5912179cbb9301c9",children:"⏳"}),!f&&x?(0,r.jsx)("img",{src:x,alt:"Avatar de ".concat(t.name,", especialista em ").concat(t.target_audience||"sa\xfade"),loading:"lazy",decoding:"async",width:parseInt(k.width),height:parseInt(k.height),style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%",opacity:y?.5:1,transition:"opacity 0.3s ease"},onError:S,onLoad:w,onLoadStart:j,className:"jsx-5912179cbb9301c9"}):(0,r.jsx)("span",{style:{fontSize:k.fontSize,color:"white",fontWeight:"bold",userSelect:"none"},"aria-hidden":"true",className:"jsx-5912179cbb9301c9",children:t.avatar||t.name.charAt(0).toUpperCase()})]}),l&&(0,r.jsx)("div",{"aria-label":d?"Digitando":"Online",style:{position:"absolute",bottom:"2px",right:"2px",width:"tiny"===o?"6px":"small"===o?"8px":"large"===o?"16px":"12px",height:"tiny"===o?"6px":"small"===o?"8px":"large"===o?"16px":"12px",borderRadius:"50%",background:d?"#4caf50":"#2196f3",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",animation:d?"pulse 2s infinite":"none"},className:"jsx-5912179cbb9301c9"}),d&&(0,r.jsx)("div",{"aria-live":"polite","aria-label":"Digitando",style:{position:"absolute",top:"-8px",right:"-8px",background:"#4caf50",color:"white",borderRadius:"12px",padding:"2px 6px",fontSize:"0.7rem",fontWeight:"bold",animation:"bounce 1s infinite",userSelect:"none",pointerEvents:"none"},className:"jsx-5912179cbb9301c9",children:(0,r.jsx)("span",{"aria-hidden":"true",className:"jsx-5912179cbb9301c9",children:"..."})}),(0,r.jsx)(n(),{id:"5912179cbb9301c9",children:"@-webkit-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-moz-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-o-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-webkit-keyframes bounce{0%,20%,50%,80%,100%{-webkit-transform:translatey(0);transform:translatey(0)}40%{-webkit-transform:translatey(-4px);transform:translatey(-4px)}60%{-webkit-transform:translatey(-2px);transform:translatey(-2px)}}@-moz-keyframes bounce{0%,20%,50%,80%,100%{-moz-transform:translatey(0);transform:translatey(0)}40%{-moz-transform:translatey(-4px);transform:translatey(-4px)}60%{-moz-transform:translatey(-2px);transform:translatey(-2px)}}@-o-keyframes bounce{0%,20%,50%,80%,100%{-o-transform:translatey(0);transform:translatey(0)}40%{-o-transform:translatey(-4px);transform:translatey(-4px)}60%{-o-transform:translatey(-2px);transform:translatey(-2px)}}@keyframes bounce{0%,20%,50%,80%,100%{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}40%{-webkit-transform:translatey(-4px);-moz-transform:translatey(-4px);-o-transform:translatey(-4px);transform:translatey(-4px)}60%{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px)}}"})]})});t.Z=l},2983:function(e,t,a){"use strict";a.d(t,{H:function(){return l}});var r=a(2265),o=a(8223),n=a(3861);class s{generateKey(e,t){let a=t?JSON.stringify(t):"";return"".concat(e).concat(a)}isExpired(e){return Date.now()-e.timestamp>e.ttl}cleanup(){let e=[];this.cache.forEach((t,a)=>{this.isExpired(t)&&e.push(a)}),e.forEach(e=>this.cache.delete(e))}evictOldest(){if(this.cache.size>=this.maxSize){let e=null,t=1/0;this.cache.forEach((a,r)=>{a.timestamp<t&&(t=a.timestamp,e=r)}),e&&this.cache.delete(e)}}get(e,t){this.cleanup();let a=this.generateKey(e,t),r=this.cache.get(a);return!r||this.isExpired(r)?(r&&this.cache.delete(a),null):(r.timestamp=Date.now(),r.data)}set(e,t,a,r){this.evictOldest();let o=this.generateKey(e,a),n={data:t,timestamp:Date.now(),ttl:r||this.defaultTTL,key:o};this.cache.set(o,n)}delete(e,t){let a=this.generateKey(e,t);this.cache.delete(a)}clear(){this.cache.clear()}getStats(){let e=[];return this.cache.forEach((t,a)=>e.push(a)),{size:this.cache.size,maxSize:this.maxSize,keys:e,hitRate:0}}preload(e,t,a,r){this.set(e,t,a,r)}constructor(){this.cache=new Map,this.maxSize=50,this.defaultTTL=3e5}}let i=new s,c={get:()=>i.get("personas",void 0),set:e=>i.set("personas",e,void 0,18e5)};function l(){let[e,t]=(0,r.useState)({}),[a,s]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async function(){try{s(!0),l(null);let e=c.get();if(e){t(e),s(!1);return}let a=await (0,o.H7)(),r=(0,n.bt)(a);c.set(r),t(r)}catch(e){console.error("Erro ao carregar personas:",e),l(e instanceof Error?e.message:"Erro desconhecido")}finally{s(!1)}})()},[]),{personas:e,loading:a,error:i,getPersonaById:t=>e[t]||null,getPersonasList:()=>Object.entries(e).map(e=>{let[t,a]=e;return{id:t,persona:a}}),getValidPersonasCount:()=>{let t=Object.keys(e).length;return console.log("[usePersonas] getValidPersonasCount:",{personas:e,count:t}),t>0?t:2},refetch:async()=>{try{s(!0),l(null);let e=await (0,o.H7)(),a=(0,n.bt)(e);t(a)}catch(e){console.error("Erro ao carregar personas:",e),l(e instanceof Error?e.message:"Erro desconhecido")}finally{s(!1)}}}}},8497:function(e,t,a){"use strict";a.d(t,{Gr:function(){return s}});var r=a(2265);let o="userProfile",n={language:"simple",notifications:!0,theme:"auto"};function s(){let[e,t]=(0,r.useState)(null),[a,s]=(0,r.useState)(!0);(0,r.useEffect)(()=>{try{let e=localStorage.getItem(o);if(e){let a=JSON.parse(e);"1.0"===a.version?t(a.profile):(console.log("Migrando perfil para nova vers\xe3o"),localStorage.removeItem(o))}}catch(e){console.error("Erro ao carregar perfil do usu\xe1rio:",e),localStorage.removeItem(o)}finally{s(!1)}},[]);let i=a=>{try{var r,s;let i={...a,preferences:{...n,...a.preferences},history:{lastPersona:a.selectedPersona||"ga",conversationCount:((null==e?void 0:null===(r=e.history)||void 0===r?void 0:r.conversationCount)||0)+1,lastAccess:new Date().toISOString(),preferredTopics:(null==e?void 0:null===(s=e.history)||void 0===s?void 0:s.preferredTopics)||[]}},c={version:"1.0",profile:i,savedAt:new Date().toISOString()};localStorage.setItem(o,JSON.stringify(c)),t(i)}catch(e){console.error("Erro ao salvar perfil do usu\xe1rio:",e)}};return{profile:e,isLoading:a,saveProfile:i,updateProfile:t=>{var a,r,o;e&&i({...e,...t,history:{lastPersona:t.selectedPersona||(null===(a=e.history)||void 0===a?void 0:a.lastPersona)||"ga",conversationCount:(null===(r=e.history)||void 0===r?void 0:r.conversationCount)||0,lastAccess:new Date().toISOString(),preferredTopics:(null===(o=e.history)||void 0===o?void 0:o.preferredTopics)||[]}})},clearProfile:()=>{try{localStorage.removeItem(o),t(null)}catch(e){console.error("Erro ao limpar perfil do usu\xe1rio:",e)}},getRecommendedPersona:()=>{if(!e)return"ga";let{type:t,focus:a,history:r}=e;return(null==r?void 0:r.lastPersona)&&r.conversationCount>2?r.lastPersona:"professional"===t||"student"===t?"technical"===a?"dr_gasnelio":"practical"===a?"ga":"dr_gasnelio":"technical"===a?"dr_gasnelio":"ga"},hasProfile:null!==e}}},8223:function(e,t,a){"use strict";a.d(t,{$N:function(){return s},H7:function(){return o},bE:function(){return n}});let r="https://roteiro-dispensacao-api-1016586236354.us-central1.run.app";async function o(){try{let e=await fetch("".concat(r,"/api/personas"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();return t.personas||t}catch(e){throw console.error("Erro ao buscar personas:",e),e}}async function n(e){try{let t=await fetch("".concat(r,"/api/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}catch(e){throw console.error("Erro ao enviar mensagem:",e),e}}async function s(e){try{let t=await fetch("".concat(r,"/api/scope"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}catch(e){throw console.error("Erro ao detectar escopo:",e),e}}}},function(e){e.O(0,[29,448,145,768,971,117,744],function(){return e(e.s=1340)}),_N_E=e.O()}]);