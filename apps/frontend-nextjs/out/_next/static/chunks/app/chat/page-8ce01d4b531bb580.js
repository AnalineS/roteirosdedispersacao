(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{1340:function(e,a,t){Promise.resolve().then(t.bind(t,1122))},1122:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return eh}});var r,s,o=t(7437),n=t(2265),i=t(7648),c=t(4768),l=t(29),d=t.n(l);let m={colors:{background:{primary:"#FFFFFF",secondary:"#F8FAFC",accent:"#F1F5F9"},personas:{gasnelio:{primary:"#0EA5E9",gradient:"linear-gradient(135deg, #0EA5E9 0%, #0284C7 100%)",bubble:"#EFF6FF",alpha:"rgba(14, 165, 233, 0.1)"},ga:{primary:"#10B981",gradient:"linear-gradient(135deg, #10B981 0%, #059669 100%)",bubble:"#ECFDF5",alpha:"rgba(16, 185, 129, 0.1)"}},neutral:{text:"#0F172A",textMuted:"#64748B",border:"#E2E8F0",divider:"#F1F5F9",surface:"#F8FAFC"},sentiment:{positive:"#10B981",neutral:"#6B7280",negative:"#EF4444",empathetic:"#8B5CF6"},status:{success:"#10B981",warning:"#F59E0B",error:"#EF4444",info:"#3B82F6"}},spacing:{xs:"4px",sm:"8px",md:"12px",lg:"16px",xl:"24px",xxl:"32px"},borderRadius:{sm:"8px",md:"12px",lg:"16px",xl:"20px",full:"50%",bubble:"20px"},typography:{message:{fontSize:"16px",lineHeight:"1.4",fontWeight:"400"},persona:{fontSize:"14px",lineHeight:"1.3",fontWeight:"600"},meta:{fontSize:"12px",lineHeight:"1.2",fontWeight:"400"}},shadows:{subtle:"0 1px 3px rgba(0, 0, 0, 0.04)",moderate:"0 2px 8px rgba(0, 0, 0, 0.08)",emphasis:"0 4px 16px rgba(0, 0, 0, 0.12)",floating:"0 8px 32px rgba(0, 0, 0, 0.12)"},transitions:{fast:"150ms ease",normal:"200ms ease",slow:"300ms ease",spring:"400ms cubic-bezier(0.4, 0, 0.2, 1)"},breakpoints:{mobile:"768px",tablet:"1024px",desktop:"1280px"},zIndex:{dropdown:1e3,sticky:1001,modal:1002,overlay:1003,tooltip:1004}},u=e=>{let a=m.colors.personas;return a[e]||a.gasnelio},p=()=>({"--color-bg-primary":m.colors.background.primary,"--color-bg-secondary":m.colors.background.secondary,"--color-bg-accent":m.colors.background.accent,"--color-text":m.colors.neutral.text,"--color-text-muted":m.colors.neutral.textMuted,"--color-border":m.colors.neutral.border,"--color-divider":m.colors.neutral.divider,"--color-surface":m.colors.neutral.surface,"--gasnelio-primary":m.colors.personas.gasnelio.primary,"--gasnelio-bubble":m.colors.personas.gasnelio.bubble,"--gasnelio-alpha":m.colors.personas.gasnelio.alpha,"--ga-primary":m.colors.personas.ga.primary,"--ga-bubble":m.colors.personas.ga.bubble,"--ga-alpha":m.colors.personas.ga.alpha,"--spacing-xs":m.spacing.xs,"--spacing-sm":m.spacing.sm,"--spacing-md":m.spacing.md,"--spacing-lg":m.spacing.lg,"--spacing-xl":m.spacing.xl,"--radius-sm":m.borderRadius.sm,"--radius-md":m.borderRadius.md,"--radius-lg":m.borderRadius.lg,"--radius-bubble":m.borderRadius.bubble,"--shadow-subtle":m.shadows.subtle,"--shadow-moderate":m.shadows.moderate,"--shadow-emphasis":m.shadows.emphasis,"--transition-fast":m.transitions.fast,"--transition-normal":m.transitions.normal,"--transition-slow":m.transitions.slow,"--transition-spring":m.transitions.spring});function g(e){let{personas:a,selected:t,onChange:r,isMobile:s=!1}=e,[i,c]=(0,n.useState)(!1);Object.keys(a);let l="dr_gasnelio"===(t||"ga");return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.md,background:"rgba(255, 255, 255, 0.95)",borderRadius:"50px",padding:"8px",backdropFilter:"blur(10px)",border:"1px solid ".concat(m.colors.neutral.border),boxShadow:m.shadows.subtle,transition:m.transitions.normal},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]])+" persona-switch-container",children:[(0,o.jsx)("span",{style:{padding:"0 ".concat(m.spacing.sm),fontSize:m.typography.meta.fontSize,fontWeight:l?"600":"400",color:l?m.colors.personas.gasnelio.primary:m.colors.neutral.textMuted,transition:"all 0.3s ease",whiteSpace:"nowrap",display:s?"none":"block"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:"Dr. Gasnelio"}),(0,o.jsx)("button",{onClick:()=>{if(i)return;c(!0);let e=l?"ga":"dr_gasnelio";setTimeout(()=>{r(e),c(!1)},200)},disabled:i,style:{position:"relative",width:"60px",height:"32px",borderRadius:"50px",border:"none",background:l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,cursor:i?"wait":"pointer",transition:"background 0.3s ease",padding:0,outline:"none",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.1)"},"aria-label":"Mudar para ".concat(l?"G\xe1":"Dr. Gasnelio"),"aria-pressed":l,className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]])+" toggle-switch",children:(0,o.jsx)("div",{style:{position:"absolute",top:"4px",left:l?"4px":"32px",width:"24px",height:"24px",borderRadius:"50%",background:"white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",transition:"left 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:(0,o.jsx)("img",{src:l?"/images/avatars/dr-gasnelio.png":"/images/avatars/ga.png",alt:l?"Dr. Gasnelio":"G\xe1",style:{width:"20px",height:"20px",borderRadius:"50%",objectFit:"cover"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]])})})}),(0,o.jsx)("span",{style:{padding:"0 ".concat(m.spacing.sm),fontSize:m.typography.meta.fontSize,fontWeight:l?"400":"600",color:l?m.colors.neutral.textMuted:m.colors.personas.ga.primary,transition:"all 0.3s ease",whiteSpace:"nowrap",display:s?"none":"block"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:"G\xe1"}),s&&(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm,marginLeft:m.spacing.sm},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:[(0,o.jsx)("img",{src:l?"/images/avatars/dr-gasnelio.png":"/images/avatars/ga.png",alt:l?"Dr. Gasnelio":"G\xe1",style:{width:"20px",height:"20px",borderRadius:"50%",objectFit:"cover"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]])}),(0,o.jsx)("span",{style:{fontSize:m.typography.meta.fontSize,fontWeight:"600",color:l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,transition:"all 0.3s ease"},className:d().dynamic([["a46f53fc3e694d7b",[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile]]]),children:l?"Dr. Gasnelio":"G\xe1"})]}),(0,o.jsx)(d(),{id:"a46f53fc3e694d7b",dynamic:[l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,m.breakpoints.mobile],children:".toggle-switch.__jsx-style-dynamic-selector:focus-visible{outline:2px solid ".concat(l?m.colors.personas.gasnelio.primary:m.colors.personas.ga.primary,";outline-offset:3px}.toggle-switch.__jsx-style-dynamic-selector:hover:not(:disabled){-webkit-filter:brightness(1.1);filter:brightness(1.1)}.toggle-switch.__jsx-style-dynamic-selector:active:not(:disabled){-webkit-transform:scale(.98);-moz-transform:scale(.98);-ms-transform:scale(.98);-o-transform:scale(.98);transform:scale(.98)}@media(max-width:").concat(m.breakpoints.mobile,"){.persona-switch-container.__jsx-style-dynamic-selector{padding:5px!important}}")})]})}let f=e=>{let{size:a=20,color:t="currentColor",className:r}=e;return(0,o.jsx)("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:(0,o.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})})},h=e=>{let{size:a=20,color:t="currentColor",className:r}=e;return(0,o.jsx)("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:(0,o.jsx)("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})},y=e=>{let{size:a=20,color:t="currentColor",className:r}=e;return(0,o.jsxs)("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[(0,o.jsx)("path",{d:"M3 12a9 9 0 1015-6.3M3 12v-3m0 3h3"}),(0,o.jsx)("path",{d:"M12 7v5l4 2"})]})},b=e=>{let{size:a=20,color:t="currentColor",className:r}=e;return(0,o.jsx)("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:(0,o.jsx)("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"})})},x=e=>{let{size:a=20,color:t="currentColor",className:r}=e;return(0,o.jsxs)("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})},v=e=>{let{size:a=20,color:t="currentColor",className:r}=e;return(0,o.jsxs)("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[(0,o.jsx)("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),(0,o.jsx)("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),(0,o.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})},k=e=>{let{size:a=20,color:t="currentColor",className:r,spinning:s=!0}=e;return(0,o.jsx)("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",className:"".concat(r," ").concat(s?"animate-spin":""),children:(0,o.jsxs)("circle",{cx:"12",cy:"12",r:"10",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"31.416",strokeDashoffset:"31.416",children:[(0,o.jsx)("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 31.416;15.708 15.708;0 31.416;0 31.416",repeatCount:"indefinite"}),(0,o.jsx)("animate",{attributeName:"stroke-dashoffset",dur:"2s",values:"0;-15.708;-31.416;-31.416",repeatCount:"indefinite"})]})})},w=e=>{let{isMobile:a}=e;return(0,o.jsxs)(i.default,{href:"/",style:{display:"flex",alignItems:"center",gap:m.spacing.sm,padding:"".concat(m.spacing.sm," ").concat(a?m.spacing.sm:m.spacing.md),borderRadius:m.borderRadius.md,background:"rgba(255, 255, 255, 0.1)",color:"white",textDecoration:"none",fontSize:m.typography.meta.fontSize,fontWeight:"500",transition:m.transitions.normal,backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)"},onMouseEnter:e=>{a||(e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)")},onMouseLeave:e=>{a||(e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)")},"aria-label":"Voltar ao in\xedcio",children:[(0,o.jsx)(f,{size:16}),!a&&(0,o.jsx)("span",{children:"In\xedcio"})]})},j=e=>{let{onToggle:a,isActive:t,isMobile:r}=e;return(0,o.jsxs)("button",{onClick:a,style:{display:"flex",alignItems:"center",gap:m.spacing.sm,padding:"".concat(m.spacing.sm," ").concat(r?m.spacing.sm:m.spacing.md),borderRadius:m.borderRadius.md,background:t?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.1)",color:"white",border:"1px solid ".concat(t?"rgba(255, 255, 255, 0.3)":"rgba(255, 255, 255, 0.1)"),fontSize:m.typography.meta.fontSize,fontWeight:"500",cursor:"pointer",transition:m.transitions.normal,backdropFilter:"blur(10px)"},onMouseEnter:e=>{r||(e.currentTarget.style.background="rgba(255, 255, 255, 0.25)",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.4)")},onMouseLeave:e=>{r||(e.currentTarget.style.background=t?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.borderColor=t?"rgba(255, 255, 255, 0.3)":"rgba(255, 255, 255, 0.1)")},title:t?"Fechar hist\xf3rico":"Mostrar hist\xf3rico","aria-label":t?"Fechar hist\xf3rico":"Mostrar hist\xf3rico",children:[t?(0,o.jsx)(x,{size:16}):(0,o.jsx)(y,{size:16}),!r&&(0,o.jsx)("span",{children:t?"Fechar":"Hist\xf3rico"})]})},S=e=>{let{onExport:a,isMobile:t,disabled:r=!1}=e;return(0,o.jsxs)("button",{onClick:a,disabled:r,style:{display:"flex",alignItems:"center",gap:m.spacing.sm,padding:"".concat(m.spacing.sm," ").concat(t?m.spacing.sm:m.spacing.md),borderRadius:m.borderRadius.md,background:r?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.1)",color:r?"rgba(255, 255, 255, 0.5)":"white",border:"1px solid ".concat(r?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.1)"),fontSize:m.typography.meta.fontSize,fontWeight:"500",cursor:r?"not-allowed":"pointer",transition:m.transitions.normal,backdropFilter:"blur(10px)",opacity:r?.6:1},onMouseEnter:e=>{t||r||(e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)")},onMouseLeave:e=>{t||r||(e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)")},title:r?"Nenhuma conversa para exportar":"Exportar conversa","aria-label":r?"Nenhuma conversa para exportar":"Exportar conversa",children:[(0,o.jsx)(b,{size:16}),!t&&(0,o.jsx)("span",{children:"Exportar"})]})},C=e=>{let{persona:a,personaId:t,isMobile:r}=e;return a&&r?(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm,background:"rgba(255, 255, 255, 0.15)",padding:"".concat(m.spacing.xs," ").concat(m.spacing.sm),borderRadius:m.borderRadius.lg,backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,o.jsx)("img",{src:"dr_gasnelio"===t?"/images/avatars/dr-gasnelio.png":"/images/avatars/ga.png",alt:a.name,style:{width:"20px",height:"20px",borderRadius:"50%",objectFit:"cover"}}),(0,o.jsx)("span",{style:{color:"white",fontSize:m.typography.meta.fontSize,fontWeight:"500"},children:a.name})]}):null};function z(e){let{personas:a,selectedPersona:t,onPersonaChange:r,isMobile:s=!1,onHistoryToggle:n,onExport:i,showHistory:c=!1,hasMessages:l=!1}=e,p=t?a[t]:null,f=p?u(t||"gasnelio"):null;return(0,o.jsxs)("header",{style:{background:(null==f?void 0:f.gradient)||m.colors.personas.gasnelio.gradient,color:"white",padding:s?"".concat(m.spacing.md," ").concat(m.spacing.lg):"".concat(m.spacing.lg," ").concat(m.spacing.xl),display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:m.shadows.moderate,minHeight:s?"80px":"96px",position:"sticky",top:0,zIndex:m.zIndex.sticky,backdropFilter:"blur(20px)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},className:d().dynamic([["43f919a306fb0302",[m.breakpoints.mobile,m.spacing.sm,m.spacing.xs,m.spacing.md,m.spacing.md,m.spacing.sm,m.transitions.spring]]])+" modern-chat-header",children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",marginBottom:s?"0":m.spacing.sm},className:d().dynamic([["43f919a306fb0302",[m.breakpoints.mobile,m.spacing.sm,m.spacing.xs,m.spacing.md,m.spacing.md,m.spacing.sm,m.transitions.spring]]])+" header-top",children:[(0,o.jsx)("div",{className:d().dynamic([["43f919a306fb0302",[m.breakpoints.mobile,m.spacing.sm,m.spacing.xs,m.spacing.md,m.spacing.md,m.spacing.sm,m.transitions.spring]]])+" header-navigation",children:(0,o.jsx)(w,{isMobile:s})}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm},className:d().dynamic([["43f919a306fb0302",[m.breakpoints.mobile,m.spacing.sm,m.spacing.xs,m.spacing.md,m.spacing.md,m.spacing.sm,m.transitions.spring]]])+" header-actions",children:[i&&(0,o.jsx)(S,{onExport:i,isMobile:s,disabled:!l}),n&&(0,o.jsx)(j,{onToggle:n,isActive:c,isMobile:s})]})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:s?"space-between":"center",width:"100%"},className:d().dynamic([["43f919a306fb0302",[m.breakpoints.mobile,m.spacing.sm,m.spacing.xs,m.spacing.md,m.spacing.md,m.spacing.sm,m.transitions.spring]]])+" header-personas",children:[s&&(0,o.jsx)(C,{persona:p,personaId:t||void 0,isMobile:s}),(0,o.jsx)("div",{style:{flex:s?"0 0 auto":1,display:"flex",justifyContent:"center"},className:d().dynamic([["43f919a306fb0302",[m.breakpoints.mobile,m.spacing.sm,m.spacing.xs,m.spacing.md,m.spacing.md,m.spacing.sm,m.transitions.spring]]]),children:(0,o.jsx)(g,{personas:a,selected:t,onChange:r,isMobile:s})}),s&&(0,o.jsx)("div",{style:{width:"120px"},className:d().dynamic([["43f919a306fb0302",[m.breakpoints.mobile,m.spacing.sm,m.spacing.xs,m.spacing.md,m.spacing.md,m.spacing.sm,m.transitions.spring]]])})," "]}),(0,o.jsx)(d(),{id:"43f919a306fb0302",dynamic:[m.breakpoints.mobile,m.spacing.sm,m.spacing.xs,m.spacing.md,m.spacing.md,m.spacing.sm,m.transitions.spring],children:"@media(max-width:".concat(m.breakpoints.mobile,"){.header-top.__jsx-style-dynamic-selector{margin-bottom:").concat(m.spacing.sm,"!important}.header-actions.__jsx-style-dynamic-selector{gap:").concat(m.spacing.xs,"!important}.modern-chat-header.__jsx-style-dynamic-selector{padding:").concat(m.spacing.md," ").concat(m.spacing.md,"!important;min-height:88px!important}.header-personas.__jsx-style-dynamic-selector{margin-top:").concat(m.spacing.sm,"}}.modern-chat-header.__jsx-style-dynamic-selector{-webkit-transition:background ").concat(m.transitions.spring,";-moz-transition:background ").concat(m.transitions.spring,";-o-transition:background ").concat(m.transitions.spring,";transition:background ").concat(m.transitions.spring,"}.header-actions.__jsx-style-dynamic-selector button.__jsx-style-dynamic-selector:hover,.header-navigation.__jsx-style-dynamic-selector a.__jsx-style-dynamic-selector:hover{-webkit-box-shadow:0 2px 8px rgba(0,0,0,.1);-moz-box-shadow:0 2px 8px rgba(0,0,0,.1);box-shadow:0 2px 8px rgba(0,0,0,.1)}")})]})}var E=t(319);let T=e=>{let{timestamp:a}=e;return(0,o.jsx)("span",{style:{fontSize:m.typography.meta.fontSize,opacity:.7,fontWeight:"400"},children:(e=>{let a=new Date(e),t=new Date;if(a.toDateString()===t.toDateString())return a.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});let r=new Date(t);return(r.setDate(r.getDate()-1),a.toDateString()===r.toDateString())?"Ontem "+a.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):a.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})})(a)})},R=e=>{let{metadata:a}=e;if(!(null==a?void 0:a.isFallback))return null;let t=(e=>{switch(e){case"cache":return{icon:"\uD83D\uDD04",label:"Cache Local"};case"local_knowledge":return{icon:"\uD83D\uDCDA",label:"Base Local"};case"emergency":return{icon:"\uD83D\uDEA8",label:"Emerg\xeancia"};default:return{icon:"\uD83D\uDEE1️",label:"Fallback"}}})(a.fallbackSource);return(0,o.jsxs)("div",{style:{marginTop:m.spacing.sm,padding:"".concat(m.spacing.xs," ").concat(m.spacing.sm),backgroundColor:m.colors.status.warning+"15",border:"1px solid ".concat(m.colors.status.warning,"40"),borderRadius:m.borderRadius.sm,fontSize:m.typography.meta.fontSize,color:m.colors.status.warning,display:"flex",alignItems:"center",gap:m.spacing.xs},children:[(0,o.jsx)("span",{children:t.icon}),(0,o.jsxs)("span",{children:[t.label,a.confidence&&(0,o.jsxs)(o.Fragment,{children:[" - ",Math.round(100*a.confidence),"%"]})]})]})};function D(e){let{message:a,persona:t,personaId:r="gasnelio",isUser:s=!1,isMobile:i=!1,isLast:c=!1}=e,[l,d]=(0,n.useState)(!1);(0,n.useState)(()=>{setTimeout(()=>d(!0),50)});let p=t?u(r):null;return(0,o.jsxs)("div",{className:"message-wrapper ".concat(s?"user":"assistant"),style:{display:"flex",gap:m.spacing.md,marginBottom:c?m.spacing.lg:m.spacing.md,flexDirection:s?"row-reverse":"row",justifyContent:"flex-start",opacity:l?1:0,transform:l?"translateY(0)":"translateY(8px)",transition:m.transitions.spring,maxWidth:"100%"},children:[!s&&t&&(0,o.jsx)("div",{style:{flexShrink:0,alignSelf:"flex-end"},children:(0,o.jsx)(E.Z,{persona:t,personaId:r,size:"small",className:"message-avatar",style:{marginBottom:"4px"}})}),(0,o.jsxs)("div",{className:"message-bubble ".concat(s?"user-bubble":"assistant-bubble"),style:{maxWidth:i?"85%":"min(80%, 600px)",padding:"".concat(m.spacing.md," ").concat(m.spacing.lg),borderRadius:m.borderRadius.bubble,position:"relative",wordWrap:"break-word",lineHeight:m.typography.message.lineHeight,fontSize:m.typography.message.fontSize,...s?{background:(null==p?void 0:p.primary)||m.colors.personas.gasnelio.primary,color:"white",borderBottomRightRadius:m.borderRadius.sm,boxShadow:m.shadows.moderate}:{background:(null==p?void 0:p.bubble)||m.colors.background.secondary,color:m.colors.neutral.text,border:"1px solid ".concat(m.colors.neutral.border),borderBottomLeftRadius:m.borderRadius.sm,boxShadow:m.shadows.subtle},transition:m.transitions.normal},onMouseEnter:e=>{s||(e.currentTarget.style.boxShadow=m.shadows.moderate,e.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:e=>{s||(e.currentTarget.style.boxShadow=m.shadows.subtle,e.currentTarget.style.transform="translateY(0)")},children:[!s&&t&&(0,o.jsxs)("div",{className:"message-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:m.spacing.xs,fontSize:m.typography.persona.fontSize},children:[(0,o.jsx)("span",{className:"persona-name",style:{fontWeight:m.typography.persona.fontWeight,color:(null==p?void 0:p.primary)||m.colors.personas.gasnelio.primary},children:t.name}),(0,o.jsx)(T,{timestamp:a.timestamp})]}),(0,o.jsx)("div",{className:"message-content",style:{whiteSpace:"pre-wrap",margin:0},children:a.content}),(0,o.jsx)(R,{metadata:a.metadata}),s&&(0,o.jsx)("div",{style:{marginTop:m.spacing.xs,textAlign:"right",opacity:.8},children:(0,o.jsx)(T,{timestamp:a.timestamp})})]})]})}let A=e=>{let{persona:a}=e;if(!a)return null;let t=u("Dr. Gasnelio"===a.name?"gasnelio":"ga");return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm,background:t.bubble,padding:"".concat(m.spacing.sm," ").concat(m.spacing.md),borderRadius:m.borderRadius.lg,border:"1px solid ".concat(t.primary,"40"),animation:"fadeIn 300ms ease",boxShadow:m.shadows.subtle},children:[(0,o.jsx)(E.Z,{persona:a,personaId:"Dr. Gasnelio"===a.name?"gasnelio":"ga",size:"tiny",isTyping:!0}),(0,o.jsxs)("div",{style:{display:"flex",gap:"3px",alignItems:"center"},children:[(0,o.jsx)("div",{className:"typing-dot",style:{width:"6px",height:"6px",borderRadius:"50%",background:t.primary,animation:"typing 1.4s infinite ease-in-out",animationDelay:"-0.32s"}}),(0,o.jsx)("div",{className:"typing-dot",style:{width:"6px",height:"6px",borderRadius:"50%",background:t.primary,animation:"typing 1.4s infinite ease-in-out",animationDelay:"-0.16s"}}),(0,o.jsx)("div",{className:"typing-dot",style:{width:"6px",height:"6px",borderRadius:"50%",background:t.primary,animation:"typing 1.4s infinite ease-in-out"}})]}),(0,o.jsxs)("span",{style:{fontSize:m.typography.meta.fontSize,color:t.primary,fontWeight:"500"},children:[a.name," est\xe1 pensando..."]})]})},I=e=>{let{sentiment:a,confidence:t}=e,r=(e=>{switch(e.toLowerCase()){case"positive":return{color:m.colors.sentiment.positive,label:"Positivo",icon:"\uD83D\uDE0A",description:"Sentimento positivo detectado"};case"negative":return{color:m.colors.sentiment.negative,label:"Negativo",icon:"\uD83D\uDE14",description:"Sentimento negativo detectado"};case"empathetic":return{color:m.colors.sentiment.empathetic,label:"Emp\xe1tico",icon:"\uD83E\uDD17",description:"Tom emp\xe1tico recomendado"};default:return{color:m.colors.sentiment.neutral,label:"Neutro",icon:"\uD83D\uDE10",description:"Sentimento neutro"}}})(a),s=Math.round(100*t);return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.sm,padding:"".concat(m.spacing.xs," ").concat(m.spacing.sm),background:r.color+"15",borderRadius:m.borderRadius.md,fontSize:m.typography.meta.fontSize,color:r.color,border:"1px solid ".concat(r.color,"40"),cursor:"help"},title:"".concat(r.description," - Confian\xe7a: ").concat(s,"%"),children:[(0,o.jsx)("span",{style:{fontSize:"0.9rem"},children:r.icon}),(0,o.jsx)("span",{style:{fontWeight:"500"},children:r.label}),(0,o.jsxs)("span",{style:{fontSize:"0.75rem",opacity:.8,background:r.color+"20",padding:"1px 4px",borderRadius:"4px"},children:[s,"%"]})]})},N=e=>{let{isSearching:a,stats:t}=e;return a||t?(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.xs,fontSize:m.typography.meta.fontSize,color:m.colors.status.info},children:a?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{width:"12px",height:"12px",border:"2px solid ".concat(m.colors.status.info,"40"),borderTop:"2px solid ".concat(m.colors.status.info),borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,o.jsx)("span",{children:"Buscando..."})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"\uD83D\uDCDA"}),(0,o.jsx)("span",{children:"Base de conhecimento"})]})}):null},_=e=>{let{type:a}=e,t=(e=>{switch(e){case"cache":return{icon:"\uD83D\uDD04",label:"Cache",color:m.colors.status.info};case"local_knowledge":return{icon:"\uD83D\uDCDA",label:"Local",color:m.colors.status.success};case"emergency":return{icon:"\uD83D\uDEA8",label:"Emerg\xeancia",color:m.colors.status.error};default:return{icon:"\uD83D\uDEE1️",label:"Fallback",color:m.colors.status.warning}}})(a);return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.xs,fontSize:m.typography.meta.fontSize,color:t.color},children:[(0,o.jsx)("span",{children:t.icon}),(0,o.jsx)("span",{children:t.label})]})},F=e=>{let{children:a}=e;return(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",gap:m.spacing.md,background:"rgba(255, 255, 255, 0.95)",padding:"".concat(m.spacing.xs," ").concat(m.spacing.sm),borderRadius:m.borderRadius.md,border:"1px solid ".concat(m.colors.neutral.border),backdropFilter:"blur(10px)",fontSize:m.typography.meta.fontSize,boxShadow:m.shadows.subtle,animation:"slideUp 200ms ease"},children:a})};function M(e){let{sentiment:a,knowledge:t,fallback:r,isTyping:s,currentPersona:n,isMobile:i=!1}=e,c=(null==a?void 0:a.confidence)&&a.confidence>.7||(null==t?void 0:t.isSearching)||(null==r?void 0:r.isActive);return(0,o.jsxs)("div",{style:{position:"absolute",bottom:"100%",right:m.spacing.lg,marginBottom:m.spacing.sm,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:m.spacing.xs,zIndex:m.zIndex.dropdown,pointerEvents:"none"},className:d().dynamic([["3b7d4f2712a137b3",[m.breakpoints.mobile,m.spacing.md,m.spacing.md]]])+" smart-indicators",children:[s&&(0,o.jsx)(A,{persona:n}),c&&(0,o.jsxs)(F,{children:[(null==a?void 0:a.confidence)&&a.confidence>.7&&(0,o.jsx)(I,{sentiment:a.category,confidence:a.confidence}),t&&(0,o.jsx)(N,{isSearching:t.isSearching,stats:t.stats}),(null==r?void 0:r.isActive)&&(0,o.jsx)(_,{type:r.type})]}),(0,o.jsx)(d(),{id:"3b7d4f2712a137b3",dynamic:[m.breakpoints.mobile,m.spacing.md,m.spacing.md],children:"@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(4px);transform:translatey(4px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:translatey(4px);transform:translatey(4px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:translatey(4px);transform:translatey(4px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(4px);-moz-transform:translatey(4px);-o-transform:translatey(4px);transform:translatey(4px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@-webkit-keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideUp{from{opacity:0;-moz-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideUp{from{opacity:0;-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);-moz-transform:translatey(8px);-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@-webkit-keyframes typing{0%,80%,100%{-webkit-transform:scale(.8);transform:scale(.8);opacity:.5}40%{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@-moz-keyframes typing{0%,80%,100%{-moz-transform:scale(.8);transform:scale(.8);opacity:.5}40%{-moz-transform:scale(1);transform:scale(1);opacity:1}}@-o-keyframes typing{0%,80%,100%{-o-transform:scale(.8);transform:scale(.8);opacity:.5}40%{-o-transform:scale(1);transform:scale(1);opacity:1}}@keyframes typing{0%,80%,100%{-webkit-transform:scale(.8);-moz-transform:scale(.8);-o-transform:scale(.8);transform:scale(.8);opacity:.5}40%{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1);opacity:1}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@media(max-width:".concat(m.breakpoints.mobile,"){.smart-indicators.__jsx-style-dynamic-selector{right:").concat(m.spacing.md,"!important;left:").concat(m.spacing.md,"!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-moz-box-align:center!important;-ms-flex-align:center!important;align-items:center!important}}")})]})}let P=()=>(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,o.jsx)("path",{d:"m22 2-7 20-4-9-9-4z"}),(0,o.jsx)("path",{d:"M22 2 11 13"})]}),L=()=>(0,o.jsx)("div",{style:{width:"16px",height:"16px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}),B=e=>{let{suggestions:a,onSuggestionClick:t,visible:r,persona:s,personaId:n}=e;if(!r||!(null==a?void 0:a.length)||!s)return null;let i=u(n||"gasnelio");return(0,o.jsxs)("div",{style:{position:"absolute",bottom:"100%",left:0,right:0,marginBottom:m.spacing.sm,background:"white",border:"1px solid ".concat(m.colors.neutral.border),borderRadius:m.borderRadius.lg,boxShadow:m.shadows.emphasis,overflow:"hidden",animation:"slideUp 200ms ease",zIndex:m.zIndex.dropdown},children:[(0,o.jsxs)("div",{style:{padding:m.spacing.sm,borderBottom:"1px solid ".concat(m.colors.neutral.divider),fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted,fontWeight:"500"},children:["\uD83D\uDCA1 Sugest\xf5es para ",s.name]}),a.slice(0,3).map((e,r)=>(0,o.jsx)("button",{onClick:()=>null==t?void 0:t(e),style:{display:"block",width:"100%",padding:m.spacing.md,border:"none",background:"transparent",textAlign:"left",cursor:"pointer",fontSize:m.typography.message.fontSize,lineHeight:m.typography.message.lineHeight,color:m.colors.neutral.text,transition:m.transitions.fast,borderBottom:r<a.length-1?"1px solid ".concat(m.colors.neutral.divider):"none"},onMouseEnter:e=>{e.currentTarget.style.background=i.alpha},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:e},r))]})};function O(e){let{value:a,onChange:t,onSubmit:r,persona:s,personaId:i="gasnelio",isLoading:c=!1,isMobile:l=!1,placeholder:p,suggestions:g,onSuggestionClick:f,showSuggestions:h=!1}=e,y=(0,n.useRef)(null),[b,x]=(0,n.useState)(!1),[v,k]=(0,n.useState)(!1),w=s?u(i):null;(0,n.useEffect)(()=>{s&&l&&y.current&&y.current.focus()},[s,l]);let j=!s||c,S=s&&a.trim()&&!c;return(0,o.jsxs)("div",{style:{position:"relative",background:"white",borderTop:"1px solid ".concat(m.colors.neutral.divider),padding:m.spacing.lg,paddingBottom:l?"max(".concat(m.spacing.lg,", env(safe-area-inset-bottom))"):m.spacing.lg},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]])+" modern-chat-input",children:[(0,o.jsx)(B,{suggestions:g,onSuggestionClick:f,visible:h&&b&&0===a.length,persona:s,personaId:i}),(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a.trim()&&!c&&(k(!0),setTimeout(()=>k(!1),300),r(e))},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]])+" input-form",children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"flex-end",gap:m.spacing.sm,background:b?"white":m.colors.neutral.surface,borderRadius:m.borderRadius.xl,border:"2px solid ".concat(b&&w?w.primary:"transparent"),transition:"all ".concat(m.transitions.normal),boxShadow:b?m.shadows.moderate:m.shadows.subtle,transform:v?"scale(0.98)":"scale(1)",opacity:j?.6:1},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]])+" input-wrapper",children:[(0,o.jsx)("input",{ref:y,type:"text",value:a,onChange:e=>t(e.target.value),onFocus:()=>{x(!0)},onBlur:()=>{setTimeout(()=>x(!1),200)},placeholder:p||(s?"Pergunte ao ".concat(s.name,"..."):"Digite sua pergunta aqui..."),disabled:j,maxLength:1e3,style:{flex:1,border:"none",background:"transparent",padding:"".concat(m.spacing.md," ").concat(m.spacing.lg),fontSize:"16px",lineHeight:m.typography.message.lineHeight,outline:"none",minHeight:l?"48px":"52px",color:m.colors.neutral.text,resize:"none"},autoComplete:"off",autoCapitalize:"sentences",spellCheck:"true",className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]])}),(0,o.jsx)("button",{type:"submit",disabled:!S,"aria-label":"Enviar mensagem",style:{width:"40px",height:"40px",borderRadius:"50%",border:"none",background:S?(null==w?void 0:w.primary)||m.colors.personas.gasnelio.primary:m.colors.neutral.textMuted,color:"white",margin:"4px",cursor:S?"pointer":"not-allowed",transition:"all ".concat(m.transitions.normal),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transform:S&&!l?"scale(1)":"scale(0.95)",touchAction:"manipulation"},onMouseEnter:e=>{S&&!l&&(e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 2px 8px ".concat((null==w?void 0:w.alpha)||"rgba(0,0,0,0.2)"))},onMouseLeave:e=>{S&&(e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="none")},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]]),children:c?(0,o.jsx)(L,{}):(0,o.jsx)(P,{})})]}),a.length>800&&(0,o.jsxs)("div",{style:{textAlign:"right",marginTop:m.spacing.xs,fontSize:m.typography.meta.fontSize,color:a.length>950?m.colors.status.warning:m.colors.neutral.textMuted},className:d().dynamic([["84b0a807d4a2bc23",[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"]]]),children:[a.length,"/1000"]})]}),(0,o.jsx)(d(),{id:"84b0a807d4a2bc23",dynamic:[m.breakpoints.mobile,m.zIndex.sticky,(null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)"],children:"@-webkit-keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideUp{from{opacity:0;-moz-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideUp{from{opacity:0;-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);-moz-transform:translatey(8px);-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@media(max-width:".concat(m.breakpoints.mobile,"){.modern-chat-input.__jsx-style-dynamic-selector{position:-webkit-sticky!important;position:sticky!important;bottom:0;z-index:").concat(m.zIndex.sticky,"}.input-wrapper.__jsx-style-dynamic-selector{min-height:52px!important}}.input-wrapper.__jsx-style-dynamic-selector:focus-within{outline:2px solid ").concat((null==w?void 0:w.alpha)||"rgba(59, 130, 246, 0.3)",";outline-offset:2px}")})]})}let U=(e,a)=>"# Conversa Educacional - Roteiros de Dispensa\xe7\xe3o PQT-U\n\n"+(a?"**Assistente:** ".concat(a.name," (").concat(a.personality,")\n"):"")+"**Data:** ".concat(new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),"\n\n---\n\n")+e.map((e,t)=>{var r;let s="user"===e.role?"**Usu\xe1rio**":"**".concat((null==a?void 0:a.name)||"Assistente","**"),o=new Date(e.timestamp).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),n="".concat(s," _(").concat(o,")_:\n").concat(e.content,"\n");return(null===(r=e.metadata)||void 0===r?void 0:r.isFallback)&&(n+="\n> ⚠️ _Resposta de fallback (".concat(e.metadata.fallbackSource,")_\n")),n}).join("\n")+"\n\n---\n\n_Gerado pelo Sistema Educacional Roteiros de Dispensa\xe7\xe3o - UnB/PPGCF_",H=async e=>{if(navigator.clipboard)await navigator.clipboard.writeText(e);else{let a=document.createElement("textarea");a.value=e,a.style.position="fixed",a.style.left="-999999px",a.style.top="-999999px",document.body.appendChild(a),a.focus(),a.select(),document.execCommand("copy"),a.remove()}},W=async(e,a)=>{let{jsPDF:r}=await Promise.all([t.e(505),t.e(553)]).then(t.bind(t,3375)),s=new r,o=s.internal.pageSize.getWidth();s.setFontSize(16),s.setFont("helvetica","bold"),s.text("Conversa Educacional - Roteiros de Dispensa\xe7\xe3o",20,20),s.setFontSize(10),s.setFont("helvetica","normal"),s.text("Gerado em: ".concat(new Date().toLocaleString("pt-BR")),20,30),s.setFontSize(11);let n=s.splitTextToSize(e,o-40),i=45;n.forEach(e=>{i>s.internal.pageSize.getHeight()-20&&(s.addPage(),i=20),s.text(e,20,i),i+=7});let c=s.getNumberOfPages();for(let e=1;e<=c;e++)s.setPage(e),s.setFontSize(8),s.text("Sistema Educacional - UnB/PPGCF - P\xe1gina ".concat(e," de ").concat(c),o/2,s.internal.pageSize.getHeight()-10,{align:"center"});s.save(a)},q=(e,a)=>{let t=encodeURIComponent(e),r=encodeURIComponent(a),s="mailto:?subject=".concat(r,"&body=").concat(t);window.open(s)};function G(e){let{isOpen:a,onClose:t,messages:r,currentPersona:s,isMobile:i=!1}=e,[c,l]=(0,n.useState)(null),[u,p]=(0,n.useState)(null);if(!a)return null;let g=U(r,s),f="conversa-".concat((null==s?void 0:s.name)||"chat","-").concat(new Date().toISOString().split("T")[0],".pdf"),h="Conversa Educacional - ".concat((null==s?void 0:s.name)||"Assistente"," - ").concat(new Date().toLocaleDateString("pt-BR")),y=async e=>{l(e),p(null);try{switch(e){case"copy":await H(g),p("Conversa copiada para a \xe1rea de transfer\xeancia!");break;case"pdf":await W(g,f),p("PDF gerado e baixado com sucesso!");break;case"email":q(g,h),p("Cliente de email aberto com a conversa!")}}catch(e){console.error("Erro ao exportar:",e),p("Erro ao exportar. Tente novamente.")}finally{l(null),setTimeout(()=>p(null),3e3)}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:m.zIndex.modal,display:"flex",alignItems:"center",justifyContent:"center",padding:m.spacing.lg,backdropFilter:"blur(4px)"},onClick:t,className:"jsx-b9522046e44b3f8f",children:(0,o.jsxs)("div",{style:{background:"white",borderRadius:m.borderRadius.lg,boxShadow:m.shadows.floating,padding:m.spacing.xl,width:"100%",maxWidth:i?"100%":"480px",maxHeight:"90vh",overflowY:"auto"},onClick:e=>e.stopPropagation(),className:"jsx-b9522046e44b3f8f",children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:m.spacing.lg,paddingBottom:m.spacing.md,borderBottom:"1px solid ".concat(m.colors.neutral.divider)},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsx)("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:"600",color:m.colors.neutral.text},className:"jsx-b9522046e44b3f8f",children:"\uD83D\uDCE4 Exportar Conversa"}),(0,o.jsx)("button",{onClick:t,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:m.colors.neutral.textMuted,width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:m.transitions.fast},onMouseEnter:e=>{e.currentTarget.style.background=m.colors.neutral.surface},onMouseLeave:e=>{e.currentTarget.style.background="none"},className:"jsx-b9522046e44b3f8f",children:"✕"})]}),(0,o.jsx)("div",{style:{background:m.colors.background.accent,padding:m.spacing.md,borderRadius:m.borderRadius.md,marginBottom:m.spacing.lg,border:"1px solid ".concat(m.colors.neutral.border)},className:"jsx-b9522046e44b3f8f",children:(0,o.jsxs)("p",{style:{margin:0,fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted,lineHeight:"1.5"},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsx)("strong",{className:"jsx-b9522046e44b3f8f",children:"Conversa com:"})," ",(null==s?void 0:s.name)||"Assistente",(0,o.jsx)("br",{className:"jsx-b9522046e44b3f8f"}),(0,o.jsx)("strong",{className:"jsx-b9522046e44b3f8f",children:"Total de mensagens:"})," ",r.length,(0,o.jsx)("br",{className:"jsx-b9522046e44b3f8f"}),(0,o.jsx)("strong",{className:"jsx-b9522046e44b3f8f",children:"Data:"})," ",new Date().toLocaleString("pt-BR")]})}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:m.spacing.md},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsxs)("button",{onClick:()=>y("copy"),disabled:null!==c,style:{display:"flex",alignItems:"center",gap:m.spacing.md,padding:m.spacing.lg,background:m.colors.background.secondary,border:"1px solid ".concat(m.colors.neutral.border),borderRadius:m.borderRadius.md,cursor:c?"wait":"pointer",transition:m.transitions.normal,opacity:c&&"copy"!==c?.5:1},onMouseEnter:e=>{c||(e.currentTarget.style.background=m.colors.neutral.surface,e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{c||(e.currentTarget.style.background=m.colors.background.secondary,e.currentTarget.style.transform="translateY(0)")},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem"},className:"jsx-b9522046e44b3f8f",children:"\uD83D\uDCCB"}),(0,o.jsxs)("div",{style:{flex:1,textAlign:"left"},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsx)("div",{style:{fontWeight:"600",marginBottom:"4px"},className:"jsx-b9522046e44b3f8f",children:"Copiar para \xc1rea de Transfer\xeancia"}),(0,o.jsx)("div",{style:{fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted},className:"jsx-b9522046e44b3f8f",children:"Copie o texto da conversa para colar em outros aplicativos"})]}),"copy"===c&&(0,o.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid #ccc",borderTop:"2px solid ".concat(m.colors.status.info),borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-b9522046e44b3f8f"})]}),(0,o.jsxs)("button",{onClick:()=>y("pdf"),disabled:null!==c,style:{display:"flex",alignItems:"center",gap:m.spacing.md,padding:m.spacing.lg,background:m.colors.background.secondary,border:"1px solid ".concat(m.colors.neutral.border),borderRadius:m.borderRadius.md,cursor:c?"wait":"pointer",transition:m.transitions.normal,opacity:c&&"pdf"!==c?.5:1},onMouseEnter:e=>{c||(e.currentTarget.style.background=m.colors.neutral.surface,e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{c||(e.currentTarget.style.background=m.colors.background.secondary,e.currentTarget.style.transform="translateY(0)")},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem"},className:"jsx-b9522046e44b3f8f",children:"\uD83D\uDCC4"}),(0,o.jsxs)("div",{style:{flex:1,textAlign:"left"},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsx)("div",{style:{fontWeight:"600",marginBottom:"4px"},className:"jsx-b9522046e44b3f8f",children:"Baixar como PDF"}),(0,o.jsx)("div",{style:{fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted},className:"jsx-b9522046e44b3f8f",children:"Gere um documento PDF formatado da conversa"})]}),"pdf"===c&&(0,o.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid #ccc",borderTop:"2px solid ".concat(m.colors.status.info),borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-b9522046e44b3f8f"})]}),(0,o.jsxs)("button",{onClick:()=>y("email"),disabled:null!==c,style:{display:"flex",alignItems:"center",gap:m.spacing.md,padding:m.spacing.lg,background:m.colors.background.secondary,border:"1px solid ".concat(m.colors.neutral.border),borderRadius:m.borderRadius.md,cursor:c?"wait":"pointer",transition:m.transitions.normal,opacity:c&&"email"!==c?.5:1},onMouseEnter:e=>{c||(e.currentTarget.style.background=m.colors.neutral.surface,e.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:e=>{c||(e.currentTarget.style.background=m.colors.background.secondary,e.currentTarget.style.transform="translateY(0)")},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem"},className:"jsx-b9522046e44b3f8f",children:"\uD83D\uDCE7"}),(0,o.jsxs)("div",{style:{flex:1,textAlign:"left"},className:"jsx-b9522046e44b3f8f",children:[(0,o.jsx)("div",{style:{fontWeight:"600",marginBottom:"4px"},className:"jsx-b9522046e44b3f8f",children:"Enviar por Email"}),(0,o.jsx)("div",{style:{fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted},className:"jsx-b9522046e44b3f8f",children:"Abra seu cliente de email com a conversa anexada"})]}),"email"===c&&(0,o.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid #ccc",borderTop:"2px solid ".concat(m.colors.status.info),borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-b9522046e44b3f8f"})]})]}),u&&(0,o.jsxs)("div",{style:{marginTop:m.spacing.lg,padding:m.spacing.md,background:m.colors.status.success+"20",border:"1px solid ".concat(m.colors.status.success,"40"),borderRadius:m.borderRadius.md,color:m.colors.status.success,fontSize:m.typography.meta.fontSize,textAlign:"center",animation:"slideUp 300ms ease"},className:"jsx-b9522046e44b3f8f",children:["✅ ",u]}),(0,o.jsx)("div",{style:{marginTop:m.spacing.xl,paddingTop:m.spacing.md,borderTop:"1px solid ".concat(m.colors.neutral.divider),textAlign:"center"},className:"jsx-b9522046e44b3f8f",children:(0,o.jsx)("p",{style:{margin:0,fontSize:m.typography.meta.fontSize,color:m.colors.neutral.textMuted},className:"jsx-b9522046e44b3f8f",children:"Sistema Educacional - UnB/PPGCF"})})]})}),(0,o.jsx)(d(),{id:"b9522046e44b3f8f",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideUp{from{opacity:0;-moz-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideUp{from{opacity:0;-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideUp{from{opacity:0;-webkit-transform:translatey(8px);-moz-transform:translatey(8px);-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}"})]})}function K(e){let{personas:a,selectedPersona:t,onPersonaChange:r,messages:s,inputValue:i,onInputChange:c,onSendMessage:l,isLoading:u,isMobile:g,currentSentiment:f,knowledgeStats:y,isSearchingKnowledge:b,fallbackState:x,onHistoryToggle:v,showHistory:k,suggestions:w,showSuggestions:j,onSuggestionClick:S}=e,C=(0,n.useRef)(null),E=(0,n.useRef)(null),[T,R]=(0,n.useState)(!1),A=t?a[t]:null;return(0,n.useEffect)(()=>{var e;null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},[s]),(0,n.useEffect)(()=>{E.current&&Object.entries(p()).forEach(e=>{var a;let[t,r]=e;null===(a=E.current)||void 0===a||a.style.setProperty(t,r)})},[]),(0,o.jsxs)("div",{ref:E,style:{height:"100dvh",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, ".concat(m.colors.background.primary," 0%, ").concat(m.colors.background.secondary," 100%)"),position:"relative"},className:d().dynamic([["beabe735b9f2463a",[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha]]])+" modern-chat-container",children:[(0,o.jsx)(z,{personas:a,selectedPersona:t,onPersonaChange:r,isMobile:g,onHistoryToggle:v,onExport:()=>R(!0),showHistory:k,hasMessages:s.length>0}),t?(0,o.jsx)(()=>(0,o.jsxs)("div",{className:"messages-area",style:{flex:1,overflowY:"auto",padding:g?"".concat(m.spacing.lg," ").concat(m.spacing.md):"".concat(m.spacing.xl," ").concat(m.spacing.xl),scrollBehavior:"smooth",scrollPaddingBottom:m.spacing.xl},children:[s.map((e,a)=>(0,o.jsx)(D,{message:e,persona:"assistant"===e.role&&A||void 0,personaId:t||"gasnelio",isUser:"user"===e.role,isMobile:g,isLast:a===s.length-1},"".concat(e.role,"-").concat(e.timestamp,"-").concat(a))),u&&A&&(0,o.jsx)("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:m.spacing.lg},children:(0,o.jsx)(M,{isTyping:!0,currentPersona:A,isMobile:g})}),(0,o.jsx)("div",{ref:C})]}),{className:d().dynamic([["beabe735b9f2463a",[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha]]])}):(0,o.jsx)(()=>(0,o.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:m.spacing.xl,textAlign:"center"},children:(0,o.jsxs)("div",{style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.7)",padding:m.spacing.xl,borderRadius:m.borderRadius.lg,backdropFilter:"blur(10px)",border:"1px solid ".concat(m.colors.neutral.border)},children:[(0,o.jsx)("div",{style:{marginBottom:m.spacing.lg},children:(0,o.jsx)(h,{size:48,color:m.colors.neutral.textMuted})}),(0,o.jsx)("h3",{style:{margin:"0 0 ".concat(m.spacing.md),color:m.colors.neutral.text,fontSize:m.typography.persona.fontSize,fontWeight:m.typography.persona.fontWeight},children:"Selecione um Assistente"}),(0,o.jsx)("p",{style:{margin:0,color:m.colors.neutral.textMuted,fontSize:m.typography.meta.fontSize,lineHeight:"1.5"},children:"Escolha Dr. Gasnelio para suporte t\xe9cnico ou G\xe1 para uma abordagem mais emp\xe1tica"})]})}),{className:d().dynamic([["beabe735b9f2463a",[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha]]])}),(0,o.jsxs)("div",{style:{position:"relative"},className:d().dynamic([["beabe735b9f2463a",[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha]]]),children:[(0,o.jsx)(M,{sentiment:f,knowledge:{isSearching:b||!1,stats:y},fallback:x,currentPersona:A,isMobile:g}),(0,o.jsx)(O,{value:i,onChange:c,onSubmit:l,persona:A,personaId:t||"gasnelio",isLoading:u,isMobile:g,suggestions:w,showSuggestions:j,onSuggestionClick:S})]}),(0,o.jsx)(G,{isOpen:T,onClose:()=>R(!1),messages:s,currentPersona:A,isMobile:g}),(0,o.jsx)(d(),{id:"beabe735b9f2463a",dynamic:[m.colors.neutral.border,m.colors.neutral.textMuted,m.breakpoints.mobile,m.colors.personas.gasnelio.alpha],children:".messages-area::-webkit-scrollbar{width:6px}.messages-area::-webkit-scrollbar-track{background:transparent}.messages-area::-webkit-scrollbar-thumb{background:".concat(m.colors.neutral.border,";-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.messages-area::-webkit-scrollbar-thumb:hover{background:").concat(m.colors.neutral.textMuted,"}.messages-area{scroll-behavior:smooth}@media(max-width:").concat(m.breakpoints.mobile,'){.modern-chat-container{height:100vh!important;height:100dvh!important}.messages-area{-webkit-overflow-scrolling:touch;-ms-scroll-chaining:none;overscroll-behavior:contain}button,input,[role="button"]{min-height:44px!important;min-width:44px!important}}.modern-chat-container *:focus{outline:2px solid ').concat(m.colors.personas.gasnelio.alpha,";outline-offset:2px}@media(prefers-reduced-motion:reduce){.modern-chat-container *,.modern-chat-container *::before,.modern-chat-container *::after{-webkit-animation-duration:.01ms!important;-moz-animation-duration:.01ms!important;-o-animation-duration:.01ms!important;animation-duration:.01ms!important;-webkit-animation-iteration-count:1!important;-moz-animation-iteration-count:1!important;-o-animation-iteration-count:1!important;animation-iteration-count:1!important;-webkit-transition-duration:.01ms!important;-moz-transition-duration:.01ms!important;-o-transition-duration:.01ms!important;transition-duration:.01ms!important}}@media(prefers-color-scheme:dark){}")})]})}var Q=t(2983),Y=t(8223);(r=s||(s={})).POSITIVE="positive",r.NEUTRAL="neutral",r.CONCERNED="concerned",r.ANXIOUS="anxious",r.FRUSTRATED="frustrated";let V=new Map;class J{static getInstance(){return J.instance||(J.instance=new J),J.instance}async analyze(e){let a=e.toLowerCase().trim(),t=this.getCachedResult(a);if(t)return t;let r=await this.performLocalAnalysis(a);return this.cacheResult(a,r),r}async performLocalAnalysis(e){let{sentimentKeywords:a}=await t.e(543).then(t.bind(t,7543)),r=0,s=0,o=[],n=0;for(let[t,i]of Object.entries(a))for(let a of i){let t=RegExp("\\b".concat(a.word,"\\b"),"gi"),i=e.match(t);if(i){let e=a.weight*i.length;r+=e,s+=Math.abs(e),n+=i.length,o.push(a.word)}}n>0&&(r=Math.max(-1,Math.min(1,r/n)),s=Math.min(1,s/n));let i=this.analyzeEmojis(e);r=(r+i.score)/2,s=Math.max(s,i.magnitude);let c=this.determineCategory(r,s);return{score:r,magnitude:s,category:c,confidence:Math.min(1,(o.length+i.count)/5),keywords:o.slice(0,5)}}analyzeEmojis(e){let a=(e.match(/😊|😃|😄|😁|🙂|👍|❤️|💚|✅|🎉/g)||[]).length,t=(e.match(/😟|😰|😔|😢|😭|😡|😤|👎|❌|💔/g)||[]).length,r=a+t+(e.match(/🤔|😕|🧐|❓|⁉️/g)||[]).length;return 0===r?{score:0,magnitude:0,count:0}:{score:(a-t)/r,magnitude:Math.min(1,r/3),count:r}}determineCategory(e,a){if(a>.7){if(e>.3)return"positive";if(e<-.5)return"frustrated";if(e<-.2)return"anxious"}return e>.2?"positive":e<-.4?"frustrated":e<-.2?"anxious":.2>Math.abs(e)&&a>.3?"concerned":"neutral"}getCachedResult(e){let a=V.get(e);return a&&Date.now()-a.timestamp<3e5?a.result:(a&&V.delete(e),null)}cacheResult(e,a){if(V.size>=100){let e=V.keys().next().value;e&&V.delete(e)}V.set(e,{result:a,timestamp:Date.now()})}clearCache(){V.clear()}constructor(){}}let X=J.getInstance();class Z{async searchContext(e){let a=Date.now(),t=this.generateCacheKey(e),r=this.getCachedResponse(t);if(r)return{...r,cached:!0,processing_time:Date.now()-a};try{let r=await this.simulateRAGResponse(e);return this.cacheResponse(t,r),{...r,cached:!1,processing_time:Date.now()-a}}catch(a){return console.error("Erro ao buscar contexto ASTRA:",a),this.localFallbackSearch(e)}}async sendFeedback(e){try{console.log("Feedback registrado:",e),await new Promise(e=>setTimeout(e,500))}catch(e){console.error("Erro ao enviar feedback:",e)}}async getStats(){try{return{cache_stats:{total_cached_responses:this.cache.size,cache_hits:45,cache_misses:15,hit_rate_percent:75},feedback_stats:{total_feedback:120,average_rating:4.2,rating_distribution:{1:5,2:10,3:20,4:50,5:35}},system_stats:{total_chunks:250,knowledge_base_size:5242880}}}catch(e){throw console.error("Erro ao obter estat\xedsticas:",e),e}}async simulateRAGResponse(e){await new Promise(e=>setTimeout(e,300));let a=e.question.toLowerCase(),t=[{content:"A Poliquimioterapia \xdanica (PQT-U) \xe9 o esquema padr\xe3o para tratamento da hansen\xedase, consistindo em rifampicina 600mg dose mensal supervisionada, clofazimina 300mg dose mensal supervisionada e 50mg di\xe1ria autoadministrada, e dapsona 100mg di\xe1ria autoadministrada.",section:"tratamento_pqtu",topics:["pqt-u","poliquimioterapia","dosagem","rifampicina","clofazimina","dapsona"]},{content:"A rifampicina pode causar colora\xe7\xe3o avermelhada na urina, suor e l\xe1grimas nas primeiras 48 horas ap\xf3s a dose, sendo um efeito esperado e n\xe3o prejudicial. Pacientes devem ser orientados para n\xe3o se alarmarem.",section:"efeitos_adversos_rifampicina",topics:["rifampicina","efeito adverso","colora\xe7\xe3o","urina"]},{content:"A clofazimina pode causar hiperpigmenta\xe7\xe3o cut\xe2nea e ressecamento da pele, que s\xe3o revers\xedveis ap\xf3s o t\xe9rmino do tratamento. O uso de hidratantes e protetor solar \xe9 recomendado.",section:"efeitos_adversos_clofazimina",topics:["clofazimina","efeito adverso","hiperpigmenta\xe7\xe3o","pele"]},{content:"A dapsona pode causar anemia hemol\xedtica, especialmente em pacientes com defici\xeancia de G6PD. Monitoramento com hemograma \xe9 recomendado no in\xedcio do tratamento.",section:"efeitos_adversos_dapsona",topics:["dapsona","efeito adverso","anemia","g6pd","hemograma"]},{content:"O tratamento da hansen\xedase com PQT-U tem dura\xe7\xe3o de 6 doses mensais supervisionadas. A ades\xe3o ao tratamento \xe9 fundamental para a cura e preven\xe7\xe3o de resist\xeancia medicamentosa.",section:"duracao_tratamento",topics:["tratamento","dura\xe7\xe3o","ades\xe3o","cura"]}].map(e=>{let t=0;e.topics.forEach(e=>{a.includes(e)&&(t+=2)});let r=e.content.toLowerCase().split(/\s+/),s=a.split(/\s+/);return s.forEach(e=>{r.includes(e)&&(t+=1)}),{...e,relevance_score:t/(s.length+e.topics.length),importance_score:.8}}).filter(e=>e.relevance_score>0).sort((e,a)=>a.relevance_score-e.relevance_score).slice(0,e.maxChunks||3),r=t.map(e=>"[".concat(e.section,"] ").concat(e.content)).join("\n\n");return{chunks:t,combined_context:r||"N\xe3o foram encontradas informa\xe7\xf5es espec\xedficas sobre esta pergunta na base de conhecimento.",confidence:t.length>0?Math.min(t[0].relevance_score,1):0,cached:!1,processing_time:0}}localFallbackSearch(e){let a="\n    Informa\xe7\xf5es b\xe1sicas sobre PQT-U para hansen\xedase:\n    - Esquema padr\xe3o com 3 medicamentos\n    - Dura\xe7\xe3o de 6 meses\n    - Doses supervisionadas mensais\n    \n    Para informa\xe7\xf5es mais espec\xedficas, consulte um profissional de sa\xfade.\n    ";return{chunks:[{content:a,section:"fallback",relevance_score:.3,topics:["pqt-u","hanseniase"],importance_score:.5}],combined_context:a,confidence:.3,cached:!1,processing_time:10}}generateCacheKey(e){return"".concat(e.question,"_").concat(e.persona||"default","_").concat(e.maxChunks||3).toLowerCase().replace(/\s+/g,"_")}getCachedResponse(e){let a=this.cache.get(e);return a?Date.now()-(a.processing_time||0)>this.cacheTimeout?(this.cache.delete(e),null):a:null}cacheResponse(e,a){if(this.cache.size>100){let e=this.cache.keys().next().value;e&&this.cache.delete(e)}this.cache.set(e,a)}clearCache(){this.cache.clear()}constructor(){this.cacheTimeout=3e5,this.baseUrl="https://roteiro-dispensacao-api-1016586236354.us-central1.run.app",this.cache=new Map}}let $=new Z;class ee{static getInstance(){return ee.instance||(ee.instance=new ee),ee.instance}async searchKnowledge(e,a,t,r){let s=this.adjustSearchBySentiment(a,r),o={question:e,persona:t,maxChunks:s.maxChunks,...a&&{sentiment:{category:a.category,score:a.score,magnitude:a.magnitude}}},n=await $.searchContext(o);return s.minConfidence&&n.confidence<s.minConfidence?this.getFallbackResponse(e,t):n}async enrichMessage(e,a,t){try{let r=await this.searchKnowledge(e,a,t,{maxChunks:2,minConfidence:.5});if(!r.combined_context||r.confidence<.3)return{original:e,enriched:e,confidence:0,sources:[]};let s=this.buildEnrichedMessage(e,r,a);return{original:e,enriched:s.text,context:r.combined_context,confidence:r.confidence,sources:s.sources}}catch(a){return console.error("Erro ao enriquecer mensagem:",a),{original:e,enriched:e,confidence:0,sources:[]}}}adjustSearchBySentiment(e,a){let t={maxChunks:3,includeContext:!0,filterByTopics:[],minConfidence:.3};if(!e)return{...t,...a};switch(e.category){case s.ANXIOUS:return{...t,...a,maxChunks:4,minConfidence:.5};case s.FRUSTRATED:return{...t,...a,maxChunks:2,minConfidence:.6};case s.CONCERNED:return{...t,...a,maxChunks:5,includeContext:!0};default:return{...t,...a}}}buildEnrichedMessage(e,a,t){let r=[],o=e,n=a.chunks[0];return n&&n.relevance_score>.7&&(r.push(n.section),o=(null==t?void 0:t.category)===s.ANXIOUS?"Entendo sua preocupa\xe7\xe3o. ".concat(e,"\n\nInforma\xe7\xe3o importante: ").concat(this.simplifyContent(n.content)):(null==t?void 0:t.category)===s.FRUSTRATED?"".concat(e,"\n\nResumo: ").concat(this.extractKeyPoints(n.content)):"".concat(e,"\n\nContexto adicional: ").concat(n.content)),a.chunks.slice(1).forEach(e=>{e.relevance_score>.5&&r.push(e.section)}),{text:o,sources:r}}simplifyContent(e){let a=e;return[{from:/poliquimioterapia única|PQT-U/gi,to:"tratamento combinado"},{from:/hiperpigmentação/gi,to:"escurecimento da pele"},{from:/anemia hemolítica/gi,to:"redu\xe7\xe3o de gl\xf3bulos vermelhos"},{from:/dose supervisionada/gi,to:"dose tomada na presen\xe7a do profissional"}].forEach(e=>{let{from:t,to:r}=e;a=a.replace(t,r)}),a.length>200&&(a=a.substring(0,197)+"..."),a}extractKeyPoints(e){let a=e.split(/[.!?]+/),t=[];return a.forEach(e=>{(/\d+\s*(mg|ml|dose|mês|meses|dia|dias)/i.test(e)||/deve|precisa|importante|necessário/i.test(e))&&t.push(e.trim())}),t.slice(0,3).join(". ")+"."}getFallbackResponse(e,a){let t="ga"===a?"N\xe3o encontrei informa\xe7\xf5es espec\xedficas sobre isso, mas posso ajudar de outras formas. O que mais voc\xea gostaria de saber?":"N\xe3o h\xe1 informa\xe7\xf5es detalhadas sobre este t\xf3pico na base de conhecimento atual. Recomendo consultar as diretrizes oficiais ou um especialista.";return{chunks:[{content:t,section:"fallback",relevance_score:0,topics:[],importance_score:0}],combined_context:t,confidence:0,cached:!1,processing_time:0}}async prefetchCommonTopics(){await Promise.all(["Como funciona o tratamento PQT-U?","Quais s\xe3o os efeitos colaterais?","Quanto tempo dura o tratamento?","Posso tomar os rem\xe9dios em casa?"].map(e=>this.searchKnowledge(e,void 0,void 0,{maxChunks:2}).catch(e=>console.error("Erro no prefetch:",e))))}constructor(){}}let ea=ee.getInstance();class et{static getInstance(){return et.instance||(et.instance=new et),et.instance}async executeFallback(e,a,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{useLocalKnowledge:s=!0,includeEmergencyContacts:o=!0,adaptToSentiment:n=!0,maxRetries:i=3,timeoutMs:c=5e3}=r;switch(this.recordFailure(),a){case"network":case"timeout":return this.handleNetworkFallback(e,t,r);case"server_error":return this.handleServerErrorFallback(e,t,r);case"data_corruption":return this.handleDataCorruptionFallback(e,t,r);default:return this.handleGenericFallback(e,t,r)}}async handleNetworkFallback(e,a){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let t=this.searchLocalCache(e);if(t)return{success:!0,response:this.adaptResponseToSentiment(t,a),source:"cache",confidence:.8,suggestion:"Resposta baseada em cache local. Conex\xe3o pode estar inst\xe1vel."};let r=this.searchLocalKnowledge(e);return r?{success:!0,response:this.adaptResponseToSentiment(r,a),source:"local_knowledge",confidence:.6,suggestion:"Resposta baseada em conhecimento local. Recomendo tentar novamente quando a conex\xe3o melhorar."}:this.getEmergencyResponse(e,"network",a)}async handleServerErrorFallback(e,a){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let t=this.searchLocalKnowledge(e);return t?{success:!0,response:this.adaptResponseToSentiment(t,a),source:"local_knowledge",confidence:.7,suggestion:"Sistema principal temporariamente indispon\xedvel. Resposta baseada em conhecimento local."}:this.getEmergencyResponse(e,"server_error",a)}async handleDataCorruptionFallback(e,a){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let t=this.searchLocalKnowledge(e);return t?{success:!0,response:this.adaptResponseToSentiment(t,a),source:"local_knowledge",confidence:.6,suggestion:"Detectado problema nos dados. Usando conhecimento local verificado."}:this.getEmergencyResponse(e,"data_corruption",a)}async handleGenericFallback(e,a){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],this.getEmergencyResponse(e,"unknown",a)}searchLocalCache(e){let a=e.toLowerCase().trim();for(let e of[{key:"rifampicina dose",response:"A rifampicina \xe9 administrada na dose de 600mg uma vez por m\xeas, sempre sob supervis\xe3o profissional."},{key:"clofazimina efeito",response:"A clofazimina pode causar hiperpigmenta\xe7\xe3o da pele, que \xe9 revers\xedvel ap\xf3s o tratamento."},{key:"dapsona dose",response:"A dapsona \xe9 administrada na dose de 100mg diariamente por via oral."},{key:"tratamento dura\xe7\xe3o",response:"O tratamento PQT-U tem dura\xe7\xe3o de 6 doses mensais supervisionadas."}])if(a.includes(e.key.split(" ")[0])&&a.includes(e.key.split(" ")[1]))return e.response;return null}searchLocalKnowledge(e){let a=e.toLowerCase();for(let e of[{keywords:["rifampin","dose","quantidade"],response:"A rifampicina \xe9 o medicamento principal do esquema PQT-U, administrada mensalmente sob supervis\xe3o. Para informa\xe7\xf5es espec\xedficas de dosagem, consulte um profissional de sa\xfade."},{keywords:["clofazimin","pele","cor","escura"],response:"A clofazimina pode causar escurecimento tempor\xe1rio da pele. Este efeito \xe9 normal e revers\xedvel. Continue o tratamento conforme orienta\xe7\xe3o m\xe9dica."},{keywords:["dapsona","di\xe1rio","casa"],response:"A dapsona \xe9 tomada diariamente em casa. \xc9 importante n\xe3o interromper o uso sem orienta\xe7\xe3o m\xe9dica."},{keywords:["efeito","colateral","adverso","rea\xe7\xe3o"],response:"Efeitos adversos podem ocorrer durante o tratamento. Os mais comuns s\xe3o colora\xe7\xe3o da urina (rifampicina) e escurecimento da pele (clofazimina). Procure orienta\xe7\xe3o m\xe9dica se tiver d\xfavidas."},{keywords:["tempo","dura\xe7\xe3o","quanto","meses"],response:"O tratamento PQT-U dura 6 meses, com doses mensais supervisionadas. \xc9 fundamental completar todo o tratamento para garantir a cura."},{keywords:["gravidez","gestante","gr\xe1vida"],response:"O tratamento para hansen\xedase pode ser realizado durante a gravidez com adapta\xe7\xf5es. \xc9 essencial acompanhamento m\xe9dico especializado."}])if(e.keywords.some(e=>a.includes(e)))return e.response;return null}getEmergencyResponse(e,a,t){let r="",o="";return(null==t?void 0:t.category)===s.ANXIOUS?(r="Compreendo sua preocupa\xe7\xe3o. Embora eu n\xe3o possa acessar todas as informa\xe7\xf5es no momento, posso assegurar que o tratamento para hansen\xedase \xe9 seguro e eficaz quando seguido corretamente.",o="Para informa\xe7\xf5es urgentes, procure: Posto de Sa\xfade mais pr\xf3ximo ou ligue 136 (Disque Sa\xfade)"):(null==t?void 0:t.category)===s.FRUSTRATED?(r="Entendo sua frustra\xe7\xe3o. O sistema est\xe1 temporariamente indispon\xedvel, mas posso orientar sobre o b\xe1sico do tratamento PQT-U.",o="Para respostas mais espec\xedficas: Unidade B\xe1sica de Sa\xfade ou Ambulat\xf3rio de Hansen\xedase"):(r="Sistema temporariamente indispon\xedvel. O tratamento para hansen\xedase (PQT-U) \xe9 padronizado e eficaz - continue seguindo as orienta\xe7\xf5es do seu m\xe9dico.",o="Para mais informa\xe7\xf5es: Minist\xe9rio da Sa\xfade - Disque 136"),e.toLowerCase().includes("dose")||e.toLowerCase().includes("quantidade")?r+=" Lembre-se: n\xe3o altere doses sem orienta\xe7\xe3o m\xe9dica.":(e.toLowerCase().includes("efeito")||e.toLowerCase().includes("rea\xe7\xe3o"))&&(r+=" Se apresentar rea\xe7\xf5es adversas intensas, procure atendimento m\xe9dico."),{success:!0,response:r,source:"emergency",confidence:.4,suggestion:"Sistema indispon\xedvel. Recomendo consultar profissional de sa\xfade para informa\xe7\xf5es espec\xedficas.",emergency_contact:o}}adaptResponseToSentiment(e,a){if(!a)return e;switch(a.category){case s.ANXIOUS:return"Entendo sua preocupa\xe7\xe3o. ".concat(e," Lembre-se que voc\xea n\xe3o est\xe1 sozinho(a) neste tratamento.");case s.FRUSTRATED:return"".concat(e," Espero que isso esclare\xe7a sua d\xfavida de forma mais direta.");case s.POSITIVE:return"".concat(e," Fico feliz em poder ajudar!");default:return e}}initializeLocalKnowledge(){["O tratamento PQT-U \xe9 seguro e eficaz quando seguido corretamente","Nunca interrompa o tratamento sem orienta\xe7\xe3o m\xe9dica","Efeitos como colora\xe7\xe3o da urina e escurecimento da pele s\xe3o normais","O tratamento dura 6 meses com doses mensais supervisionadas","A hansen\xedase tem cura quando tratada adequadamente"].forEach((e,a)=>{this.localKnowledge.set("essential_".concat(a),e)})}initializeEmergencyResponses(){this.emergencyResponses.set("network","Conex\xe3o temporariamente indispon\xedvel. Continue seu tratamento normalmente e tente novamente mais tarde."),this.emergencyResponses.set("server_error","Sistema em manuten\xe7\xe3o. Para d\xfavidas urgentes, procure seu posto de sa\xfade."),this.emergencyResponses.set("data_corruption","Problema nos dados detectado. Recomendo consultar profissional de sa\xfade.")}recordFailure(){this.failureCount++,this.lastFailureTime=Date.now()}getFailureStats(){let e=Date.now()-this.lastFailureTime,a="good";return this.failureCount>10&&e<3e5?a="degraded":this.failureCount>20&&(a="critical"),{count:this.failureCount,lastFailure:this.lastFailureTime,systemHealth:a}}resetFailureCount(){this.failureCount=0,this.lastFailureTime=0}constructor(){this.failureCount=0,this.lastFailureTime=0,this.localKnowledge=new Map,this.emergencyResponses=new Map,this.initializeLocalKnowledge(),this.initializeEmergencyResponses()}}let er=et.getInstance();async function es(e,a,t){let r="unknown";return a.message.includes("network")||a.message.includes("fetch")?r="network":a.message.includes("timeout")?r="timeout":a.message.includes("500")||a.message.includes("502")||a.message.includes("503")?r="server_error":(a.message.includes("corrupt")||a.message.includes("invalid"))&&(r="data_corruption"),er.executeFallback(e,r,t)}let eo="conversation-history",en={dr_gasnelio:{personaId:"dr_gasnelio",expertiseAreas:["clinical","dosage","protocols","diagnosis","treatment"],keywords:["dose","dosagem","mg","rifampicina","dapsona","clofazimina","protocolo","tratamento","diagn\xf3stico","cl\xednico","m\xe9dico","prescri\xe7\xe3o","posologia","terap\xeautica","PQT-U","PQT","multibacilar","paucibacilar","MB","PB","esquema","rea\xe7\xe3o","efeito colateral","contraindica\xe7\xe3o","intera\xe7\xe3o"],specialties:["Dosagens","Protocolos Cl\xednicos","Diagn\xf3stico"]},ga:{personaId:"ga",expertiseAreas:["education","dispensation","family","guidance","support"],keywords:["paciente","fam\xedlia","educa\xe7\xe3o","orienta\xe7\xe3o","ensino","dispensa\xe7\xe3o","farm\xe1cia","entrega","cronograma","organiza\xe7\xe3o","ader\xeancia","ades\xe3o","motiva\xe7\xe3o","apoio","comunica\xe7\xe3o","explicar","ensinar","orientar","acompanhar","conversar","d\xfavidas","medo","preconceito","estigma","social"],specialties:["Educa\xe7\xe3o do Paciente","Dispensa\xe7\xe3o","Apoio Familiar"]}};class ei{set(e,a){let t=this.normalizeQuestion(e);this.cache.set(t,{analysis:a,timestamp:Date.now()}),this.cleanupExpired()}get(e){let a=this.normalizeQuestion(e),t=this.cache.get(a);return t&&Date.now()-t.timestamp<this.TTL?t.analysis:(t&&this.cache.delete(a),null)}normalizeQuestion(e){return e.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g," ").trim()}cleanupExpired(){let e=Date.now();Array.from(this.cache.entries()).forEach(a=>{let[t,r]=a;e-r.timestamp>=this.TTL&&this.cache.delete(t)})}constructor(){this.cache=new Map,this.TTL=3e5}}let ec=new ei;async function el(e,a){try{let t=ec.get(e);if(t)return t;let r=ed(e,a),s=null;try{s=await (0,Y.$N)(e)}catch(e){console.warn("Backend scope detection failed, using local analysis:",e)}let o=function(e,a,t){if(!a||!a.recommended_persona)return e;let r=a.recommended_persona;if(t[r]){let t=a.confidence||.5,s=(e.confidence+t)/2;if(r===e.recommendedPersonaId)return{...e,confidence:Math.min(.95,s+.2),reasoning:"".concat(e.reasoning," (confirmado por IA)")};if(t>e.confidence)return{recommendedPersonaId:r,confidence:s,reasoning:a.reasoning||"Recomendado por an\xe1lise de IA",scope:a.scope||e.scope,alternatives:[{personaId:e.recommendedPersonaId,confidence:e.confidence,reasoning:e.reasoning},...e.alternatives]}}return e}(r,s,a);return ec.set(e,o),o}catch(t){return console.error("Erro na an\xe1lise de roteamento:",t),ed(e,a)}}function ed(e,a){var t;let r=e.toLowerCase(),s={},o={};Object.keys(a).forEach(e=>{let a=en[e];if(!a)return;let t=0,n=[];a.keywords.forEach(e=>{r.includes(e.toLowerCase())&&(t+=e.length>6?2:1,n.push(e))}),a.expertiseAreas.forEach(e=>{r.includes(e)&&(t+=3,n.push(e))}),s[e]=t,o[e]=n});let n=Object.entries(s).sort((e,a)=>{let[,t]=e,[,r]=a;return r-t}).filter(e=>{let[,a]=e;return a>0});if(0===n.length){let e="dr_gasnelio";return{recommendedPersonaId:e,confidence:.3,reasoning:"Quest\xe3o geral - roteado para especialista cl\xednico",scope:"general",alternatives:Object.keys(a).filter(a=>a!==e).map(e=>({personaId:e,confidence:.2,reasoning:"Alternativa dispon\xedvel"}))}}let[i,c]=n[0],l=(null===(t=en[i])||void 0===t?void 0:t.keywords.length)||1,d=o[i]||[];return{recommendedPersonaId:i,confidence:Math.min(.95,c/l*.8+.2),reasoning:d.length>0?"Especialista em: ".concat(d.slice(0,3).join(", ")):"Melhor correspond\xeancia de expertise",scope:["dose","dosagem","mg","quantidade","posologia"].some(e=>r.includes(e))?"dosage":["diagn\xf3stico","sintoma","caso","tratamento","protocolo"].some(e=>r.includes(e))?"clinical":["paciente","fam\xedlia","explicar","ensinar","orientar"].some(e=>r.includes(e))?"education":["dispensar","farm\xe1cia","entrega","cronograma"].some(e=>r.includes(e))?"dispensation":"general",alternatives:n.slice(1,3).map(e=>{var a;let[t,r]=e;return{personaId:t,confidence:Math.min(.8,r/l*.6+.1),reasoning:(null===(a=o[t])||void 0===a?void 0:a.length)>0?"Tamb\xe9m especialista em: ".concat(o[t].slice(0,2).join(", ")):"Alternativa com expertise relacionada"}})}}var em=t(8497),eu=t(5121);let ep=e=>{let{size:a="medium",color:t=eu.rS.colors.primary[500],message:r,inline:s=!1}=e,n={small:"16px",medium:"24px",large:"32px"},i={display:s?"inline-flex":"flex",alignItems:"center",justifyContent:"center",gap:"8px",...!s&&{minHeight:"40px",padding:"8px"}},c={width:n[a],height:n[a],border:"2px solid ".concat(t,"20"),borderTop:"2px solid ".concat(t),borderRadius:"50%",animation:"spin 1s linear infinite"};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d(),{id:"d732791046adfab6",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"}),(0,o.jsxs)("div",{style:i,className:"jsx-d732791046adfab6",children:[(0,o.jsx)("div",{style:c,className:"jsx-d732791046adfab6"}),r&&(0,o.jsx)("span",{style:{fontSize:"0.9rem",color:eu.rS.colors.neutral[600],fontWeight:500},className:"jsx-d732791046adfab6",children:r})]})]})},eg=()=>(0,o.jsx)("div",{style:{padding:"20px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:eu.rS.colors.neutral[50],borderRadius:"8px"},children:(0,o.jsx)(ep,{size:"medium",message:"Carregando hist\xf3rico..."})}),ef=(0,n.lazy)(()=>t.e(824).then(t.bind(t,824)));function eh(){let{personas:e,loading:a,error:t}=(0,Q.H)(),{createConversation:r,switchToConversation:l,deleteConversation:d,renameConversation:m,addMessageToConversation:u,getCurrentMessages:p,getConversationsForPersona:g,currentConversationId:f}=function(){let[e,a]=(0,n.useState)([]),[t,r]=(0,n.useState)(null),[s,o]=(0,n.useState)(!1),[i,c]=(0,n.useState)(null),l=(0,n.useRef)(null);(0,n.useEffect)(()=>{try{o(!0);let e=localStorage.getItem(eo);if(e){let t=JSON.parse(e);if(Array.isArray(t)){let e=t.filter(e=>e&&"object"==typeof e&&e.id&&e.personaId).slice(0,50);a(e)}}c(null)}catch(e){console.error("Erro ao carregar hist\xf3rico de conversas:",e),c("Erro ao carregar hist\xf3rico de conversas"),a([])}finally{o(!1)}},[]);let d=(0,n.useCallback)(e=>{l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{try{let a=e.slice(0,50).map(e=>({...e,messages:e.messages.slice(-100)})),t=JSON.stringify(a);if(t.length>4718592){console.warn("Dados muito grandes para localStorage, limpando conversas antigas");let e=a.slice(0,Math.floor(25));localStorage.setItem(eo,JSON.stringify(e))}else localStorage.setItem(eo,t);c(null)}catch(a){console.error("Erro ao salvar hist\xf3rico de conversas:",a),c("Erro ao salvar hist\xf3rico de conversas");try{let a=e.slice(0,10);localStorage.setItem(eo,JSON.stringify(a))}catch(e){console.error("Erro cr\xedtico ao salvar:",e)}}},300)},[]),m=(0,n.useCallback)(e=>{try{if(!e||"string"!=typeof e)return"Nova conversa";let a=e.replace(/[^\w\sÀ-ſ]/gi,"").trim().split(" ").filter(e=>e.length>0).slice(0,6).join(" ");return a.length>40&&(a=a.substring(0,37)+"..."),a.length<3&&(a="Nova conversa"),a}catch(e){return console.error("Erro ao gerar t\xedtulo da conversa:",e),"Nova conversa"}},[]),u=(0,n.useCallback)((t,s)=>{try{if(!t||"string"!=typeof t)throw Error("personaId \xe9 obrigat\xf3rio");let o="conv_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),n=Date.now(),i=[{id:o,personaId:t,title:s?m(s):"Nova conversa",messages:[],lastActivity:n,createdAt:n},...e];return a(i),d(i),r(o),c(null),o}catch(e){return console.error("Erro ao criar conversa:",e),c("Erro ao criar nova conversa"),""}},[e,d,m]),p=(0,n.useCallback)(()=>t&&e.find(e=>e.id===t)||null,[t,e]),g=(0,n.useCallback)(r=>{if(t&&r)try{if(!r.content||!r.role||!r.timestamp)throw Error("Mensagem inv\xe1lida");let s=e.map(e=>{if(e.id===t){let a={...e,messages:[...e.messages,r].slice(-100),lastActivity:Date.now()};return 0===e.messages.length&&"user"===r.role&&(a.title=m(r.content)),a}return e});a(s),d(s),c(null)}catch(e){console.error("Erro ao adicionar mensagem:",e),c("Erro ao adicionar mensagem \xe0 conversa")}},[t,e,d,m]),f=(0,n.useCallback)(()=>{let e=p();return(null==e?void 0:e.messages)||[]},[p]),h=(0,n.useCallback)(a=>e.filter(e=>e.personaId===a).sort((e,a)=>a.lastActivity-e.lastActivity).map(e=>({id:e.id,personaId:e.personaId,title:e.title,lastMessage:e.messages.length>0?e.messages[e.messages.length-1].content.substring(0,50)+"...":"Conversa vazia",lastActivity:e.lastActivity,messageCount:e.messages.length})),[e]),y=(0,n.useCallback)(e=>{r(e)},[]),b=(0,n.useCallback)(s=>{let o=e.filter(e=>e.id!==s);a(o),d(o),t===s&&r(null)},[e,t,d]),x=(0,n.useCallback)((t,r)=>{let s=e.map(e=>e.id===t?{...e,title:r.trim()||"Conversa sem t\xedtulo"}:e);a(s),d(s)},[e,d]),v=(0,n.useCallback)(()=>{a([]),r(null),localStorage.removeItem("conversation-history")},[]),k=(0,n.useCallback)(()=>({totalConversations:e.length,totalMessages:e.reduce((e,a)=>e+a.messages.length,0),personaStats:e.reduce((e,a)=>(e[a.personaId]=(e[a.personaId]||0)+1,e),{})}),[e]);return(0,n.useEffect)(()=>()=>{l.current&&clearTimeout(l.current)},[]),{conversations:e,currentConversationId:t,loading:s,error:i,getCurrentConversation:p,getCurrentMessages:f,createConversation:u,switchToConversation:y,deleteConversation:b,renameConversation:x,clearAllConversations:v,addMessageToConversation:g,getConversationsForPersona:h,getStatistics:k,clearError:()=>c(null)}}(),{profile:h,updateProfile:y,getRecommendedPersona:b}=(0,em.Gr)(),{loading:x,error:w,sendMessage:j,currentSentiment:S,personaSwitchSuggestion:C,knowledgeStats:z,lastSearchResult:E,isSearchingKnowledge:T,fallbackState:R,resetFallback:D,resetSystemFailures:A}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{persistToLocalStorage:a=!0,storageKey:t="chat-history",enableSentimentAnalysis:r=!0,enableKnowledgeEnrichment:o=!0,onMessageReceived:i}=e,c=(0,n.useCallback)(()=>{if(!a)return[];try{let e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(e){return console.error("Erro ao carregar hist\xf3rico do chat:",e),[]}},[a,t]),[l,d]=(0,n.useState)(c),m=(0,n.useRef)(l),[u,p]=(0,n.useState)(!1),[g,f]=(0,n.useState)(null),[h,y]=(0,n.useState)(null);(0,n.useEffect)(()=>{m.current=l},[l]);let{currentSentiment:b,analyzeSentiment:x,sentimentHistory:v,clearHistory:k}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{debounceMs:a=500,maxHistorySize:t=10,autoAnalyze:r=!0}=e,[o,i]=(0,n.useState)(null),[c,l]=(0,n.useState)([]),[d,m]=(0,n.useState)(!1),u=(0,n.useRef)(null),p=(0,n.useRef)(""),g=(0,n.useCallback)(async e=>{if(!e||e.trim().length<3){let e={score:0,magnitude:0,category:s.NEUTRAL,confidence:0,keywords:[]};return i(e),e}if(e===p.current&&o)return o;m(!0);try{let a=await X.analyze(e);return i(a),p.current=e,l(r=>[{timestamp:Date.now(),text:e.substring(0,100),result:a},...r].slice(0,t)),a}catch(a){console.error("Erro ao analisar sentimento:",a);let e={score:0,magnitude:0,category:s.NEUTRAL,confidence:0,keywords:[]};return i(e),e}finally{m(!1)}},[o,t]);(0,n.useCallback)(e=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{g(e)},a)},[g,a]);let f=(0,n.useCallback)(()=>{l([]),i(null),p.current=""},[]),h=c.length>0?(()=>{let e;let a=c.reduce((e,a)=>e+a.result.score,0)/c.length;return e=a>.2?s.POSITIVE:a<-.4?s.FRUSTRATED:a<-.2?s.ANXIOUS:s.NEUTRAL,{score:a,category:e}})():null;return(0,n.useEffect)(()=>()=>{u.current&&clearTimeout(u.current)},[]),{currentSentiment:o,sentimentHistory:c,analyzeSentiment:g,clearHistory:f,isAnalyzing:d,averageSentiment:h}}({debounceMs:300,autoAnalyze:r}),{searchKnowledge:w,enrichMessage:j,isSearching:S,lastSearchResult:C,stats:z}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{prefetchCommon:a=!0,autoEnrich:t=!0,cacheTimeout:r=3e5}=e,[s,o]=(0,n.useState)(!1),[i,c]=(0,n.useState)(null),[l,d]=(0,n.useState)(null),[m,u]=(0,n.useState)(null),p=(0,n.useRef)(null);(0,n.useEffect)(()=>{a&&ea.prefetchCommonTopics().catch(e=>console.error("Erro no prefetch:",e)),y()},[a]);let g=(0,n.useCallback)(async(e,a,t)=>{o(!0),u(null),p.current&&clearTimeout(p.current);try{let r=await ea.searchKnowledge(e,a,t,{maxChunks:3,minConfidence:.3});return c(r),console.log("Knowledge search completed:",{question:e.substring(0,50)+"...",confidence:r.confidence,chunks:r.chunks.length,cached:r.cached}),r}catch(a){u(a instanceof Error?a.message:"Erro ao buscar conhecimento"),console.error("Erro na busca de conhecimento:",a);let e={chunks:[],combined_context:"",confidence:0,cached:!1,processing_time:0};return c(e),e}finally{o(!1)}},[]),f=(0,n.useCallback)(async(e,a,r)=>{if(!t)return{original:e,enriched:e,confidence:0,sources:[]};try{return await ea.enrichMessage(e,a,r)}catch(a){return console.error("Erro ao enriquecer mensagem:",a),{original:e,enriched:e,confidence:0,sources:[]}}},[t]),h=(0,n.useCallback)(async(e,a,t,r)=>{try{await $.sendFeedback({query:e,response:a,rating:t,comments:r}),setTimeout(()=>y(),1e3)}catch(e){console.error("Erro ao enviar avalia\xe7\xe3o:",e),u("Erro ao enviar avalia\xe7\xe3o")}},[]),y=(0,n.useCallback)(async()=>{try{let e=await $.getStats();d(e)}catch(e){console.error("Erro ao buscar estat\xedsticas:",e)}},[]),b=(0,n.useCallback)(()=>{$.clearCache(),c(null),console.log("Cache de conhecimento limpo")},[]);return(0,n.useEffect)(()=>()=>{p.current&&clearTimeout(p.current)},[]),{isSearching:s,lastSearchResult:i,stats:l,error:m,searchKnowledge:g,enrichMessage:f,rateResponse:h,refreshStats:y,clearCache:b}}({prefetchCommon:!0,autoEnrich:o}),{withFallback:E,shouldUseFallback:T,state:R,reset:D,getSystemStats:A,resetSystemFailures:I}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{maxRetries:a=3,retryDelay:t=1e3,autoReset:r=!0}=e,[s,o]=(0,n.useState)({isActive:!1,result:null,attempts:0,lastFailureType:null,systemHealth:"good"}),i=(0,n.useRef)(),c=(0,n.useCallback)(async(e,a,t)=>{o(e=>({...e,isActive:!0,attempts:e.attempts+1}));try{let s=await es(e,a,t);return o(e=>({...e,result:s,lastFailureType:a.message,systemHealth:er.getFailureStats().systemHealth})),r&&setTimeout(()=>{o(e=>({...e,isActive:!1,result:null}))},5e3),s}catch(a){console.error("Fallback tamb\xe9m falhou:",a);let e={success:!1,response:"Sistema temporariamente indispon\xedvel. Tente novamente em alguns minutos ou consulte um profissional de sa\xfade.",source:"emergency",confidence:.1,emergency_contact:"Disque Sa\xfade: 136"};return o(a=>({...a,result:e,systemHealth:"critical"})),e}},[r]),l=(0,n.useCallback)(async(e,a,t)=>{try{let a=await e();return s.attempts>0&&r&&o(e=>({...e,attempts:0,isActive:!1,result:null})),a}catch(e){return console.warn("Opera\xe7\xe3o falhou, executando fallback:",e),await c(a,e,t)}},[c,s.attempts,r]),d=(0,n.useCallback)(e=>{let a=er.getFailureStats();if("degraded"===a.systemHealth||"critical"===a.systemHealth)return!0;if(e){let a=e.message.toLowerCase();return a.includes("network")||a.includes("timeout")||a.includes("500")||a.includes("502")||a.includes("503")}return!1},[]),m=(0,n.useCallback)(e=>{let a=e.message.toLowerCase();return a.includes("network")?"Verifique sua conex\xe3o com a internet":a.includes("timeout")?"Tente novamente - o servidor pode estar ocupado":a.includes("500")||a.includes("502")||a.includes("503")?"Sistema em manuten\xe7\xe3o - tente novamente em alguns minutos":a.includes("404")?"Recurso n\xe3o encontrado - pode ser um problema tempor\xe1rio":"Erro inesperado - tente novamente ou consulte suporte"},[]),u=(0,n.useCallback)(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;try{return await e()}catch(o){if(r>=a)throw o;let s=t*Math.pow(2,r-1);return new Promise((a,t)=>{i.current=setTimeout(async()=>{try{let t=await u(e,r+1);a(t)}catch(e){t(e)}},s)})}},[a,t]),p=(0,n.useCallback)(()=>{i.current&&clearTimeout(i.current),o({isActive:!1,result:null,attempts:0,lastFailureType:null,systemHealth:er.getFailureStats().systemHealth})},[]),g=(0,n.useCallback)(()=>er.getFailureStats(),[]),f=(0,n.useCallback)(()=>{er.resetFailureCount(),o(e=>({...e,systemHealth:"good"}))},[]);return{state:s,isActive:s.isActive,result:s.result,attempts:s.attempts,systemHealth:s.systemHealth,executeFallback:c,withFallback:l,shouldUseFallback:d,getFailureSuggestion:m,retryWithBackoff:u,reset:p,getSystemStats:g,resetSystemFailures:f}}({maxRetries:2,retryDelay:1e3,autoReset:!0}),N=(0,n.useRef)(""),_=(0,n.useCallback)(e=>{if(a)try{localStorage.setItem(t,JSON.stringify(e))}catch(e){console.error("Erro ao salvar hist\xf3rico do chat:",e)}},[a,t]);(0,n.useEffect)(()=>{var e;r&&b&&N.current&&("dr-gasnelio"===(e=N.current)&&("anxious"===b.category||"frustrated"===b.category)&&b.confidence>.7||"ga"===e&&"neutral"===b.category&&b.magnitude<.3&&b.confidence>.7?y("dr-gasnelio"===N.current?"ga":"dr-gasnelio"):y(null))},[b,r]);let F=(0,n.useCallback)(async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e.trim())return;let s=null;if(r&&0===t)try{s=await x(e)}catch(e){console.error("Erro na an\xe1lise de sentimento:",e)}let n=null;if(o&&0===t)try{let t=await w(e,s||void 0,a);t.confidence>.3&&t.combined_context&&(n={context:t.combined_context,confidence:t.confidence,sources:t.chunks.map(e=>e.section)})}catch(e){console.error("Erro ao buscar contexto:",e)}N.current=a;let c={role:"user",content:e.trim(),timestamp:Date.now(),persona:a};0===t&&d(e=>{let a=[...e,c];return m.current=a,_(a),a}),p(!0),f(null);try{let r=0===t?[...m.current,c]:m.current,o={question:e.trim(),personality_id:a,conversation_history:r.slice(-10),...s&&{sentiment:{category:s.category,score:s.score,magnitude:s.magnitude}},...n&&{knowledge_context:n}},l=await E(()=>(0,Y.bE)(o),e.trim(),s||void 0);if(l&&"object"==typeof l&&"source"in l){let e={role:"assistant",content:l.response,timestamp:Date.now(),persona:a,metadata:{isFallback:!0,fallbackSource:l.source,confidence:l.confidence,suggestion:l.suggestion,emergency_contact:l.emergency_contact}};d(a=>{let t=[...a,e];return m.current=t,_(t),i&&i(e),t}),p(!1);return}let u={role:"assistant",content:l.answer,timestamp:l.timestamp?new Date(l.timestamp).getTime():Date.now(),persona:l.persona};d(e=>{let a=[...e,u];return m.current=a,_(a),i&&i(u),a}),p(!1)}catch(r){if(console.error("Erro ao enviar mensagem (tentativa ".concat(t+1,"):"),r),t<3)setTimeout(()=>{F(e,a,t+1)},1e3*Math.pow(2,t)),f("Tentando novamente... (".concat(t+1,"/").concat(3,")"));else{let e=r instanceof Error?r.message:"Erro ao enviar mensagem";f("".concat(e," (Falha ap\xf3s ").concat(3," tentativas)")),p(!1)}}t>=3&&p(!1)},[_,x,r]);return{messages:l,loading:u,error:g,sendMessage:F,clearMessages:(0,n.useCallback)(()=>{d([]),a&&localStorage.removeItem(t),r&&k()},[a,t,r,k]),getMessagesForPersona:(0,n.useCallback)(e=>m.current.filter(a=>a.persona===e),[]),currentSentiment:b,sentimentHistory:v,personaSwitchSuggestion:h,knowledgeStats:z,lastSearchResult:C,isSearchingKnowledge:S,fallbackState:R,resetFallback:D,getSystemStats:A,resetSystemFailures:I}}({persistToLocalStorage:!1,enableSentimentAnalysis:!0,enableKnowledgeEnrichment:!0,onMessageReceived:(0,n.useCallback)(e=>{u(e)},[u])}),[I,N]=(0,n.useState)(""),[_,F]=(0,n.useState)("ga"),[M,P]=(0,n.useState)(!1),[L,B]=(0,n.useState)(!1),[O,U]=(0,n.useState)(""),H=(0,n.useCallback)(()=>{if(!e||0===Object.keys(e).length)return[];try{return Object.keys(e).flatMap(a=>a&&e[a]?g(a):[])}catch(e){return console.error("Erro ao obter conversas:",e),[]}},[e,g]);(0,n.useEffect)(()=>{let e=()=>{B(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let W=p(),{currentAnalysis:q,isAnalyzing:G,shouldShowRouting:V,getRecommendedPersona:J,analyzeQuestion:Z,acceptRecommendation:ee,rejectRecommendation:et,clearAnalysis:ei,getExplanation:ec}=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{enabled:t=!0,debounceMs:r=800,minConfidenceThreshold:s=.4}=a,[o,i]=(0,n.useState)({currentAnalysis:null,isAnalyzing:!1,error:null,hasAnalyzed:!1}),c=(0,n.useRef)(null),l=(0,n.useRef)(""),d=(0,n.useRef)({acceptedRecommendations:0,rejectedRecommendations:0,totalAnalyses:0});(0,n.useEffect)(()=>()=>{c.current&&clearTimeout(c.current)},[]);let m=(0,n.useCallback)(async a=>{if(!t||!a.trim()||0===Object.keys(e).length)return;let o=a.trim();o!==l.current&&(l.current=o,c.current&&clearTimeout(c.current),c.current=setTimeout(async()=>{i(e=>({...e,isAnalyzing:!0,error:null}));try{let a=await el(o,e);a.confidence>=s?(i(e=>({...e,currentAnalysis:a,isAnalyzing:!1,hasAnalyzed:!0})),d.current.totalAnalyses++):i(e=>({...e,currentAnalysis:null,isAnalyzing:!1,hasAnalyzed:!0}))}catch(e){console.error("Erro na an\xe1lise de roteamento:",e),i(a=>({...a,currentAnalysis:null,isAnalyzing:!1,error:e instanceof Error?e.message:"Erro na an\xe1lise",hasAnalyzed:!0}))}},r))},[t,e,s,r]),u=(0,n.useCallback)(()=>{o.currentAnalysis&&(d.current.acceptedRecommendations++,console.log("Routing recommendation accepted:",{personaId:o.currentAnalysis.recommendedPersonaId,confidence:o.currentAnalysis.confidence,scope:o.currentAnalysis.scope}))},[o.currentAnalysis]),p=(0,n.useCallback)(e=>{o.currentAnalysis&&(d.current.rejectedRecommendations++,console.log("Routing recommendation rejected:",{recommended:o.currentAnalysis.recommendedPersonaId,selected:e,confidence:o.currentAnalysis.confidence,scope:o.currentAnalysis.scope,reasoning:o.currentAnalysis.reasoning})),i(e=>({...e,currentAnalysis:null}))},[o.currentAnalysis]),g=(0,n.useCallback)(()=>{i(e=>({...e,currentAnalysis:null,error:null,hasAnalyzed:!1})),l.current="",c.current&&clearTimeout(c.current)},[]),f=(0,n.useCallback)(()=>o.currentAnalysis?function(e,a){let t=a[e.recommendedPersonaId];if(!t)return e.reasoning;let r=en[e.recommendedPersonaId]||null,s=(null==r?void 0:r.specialties.join(", "))||"quest\xf5es especializadas";return"".concat(t.name," especializa-se em ").concat(s,". ").concat(e.reasoning)}(o.currentAnalysis,e):"Nenhuma an\xe1lise dispon\xedvel",[o.currentAnalysis,e]),h=(0,n.useCallback)(()=>!!o.currentAnalysis&&o.currentAnalysis.confidence<.6,[o.currentAnalysis]),y=(0,n.useCallback)(()=>{let e=d.current,a=e.totalAnalyses>0?e.acceptedRecommendations/e.totalAnalyses*100:0;return{...e,acceptanceRate:Math.round(a)}},[]),b=(0,n.useCallback)(()=>!!(o.currentAnalysis&&o.currentAnalysis.confidence>=s&&!o.isAnalyzing),[o.currentAnalysis,o.isAnalyzing,s]),x=(0,n.useCallback)(()=>o.currentAnalysis&&e[o.currentAnalysis.recommendedPersonaId]||null,[o.currentAnalysis,e]),v=(0,n.useCallback)(()=>o.currentAnalysis?o.currentAnalysis.alternatives.filter(a=>e[a.personaId]).map(a=>({...a,persona:e[a.personaId]})):[],[o.currentAnalysis,e]);return{currentAnalysis:o.currentAnalysis,isAnalyzing:o.isAnalyzing,error:o.error,hasAnalyzed:o.hasAnalyzed,analyzeQuestion:m,acceptRecommendation:u,rejectRecommendation:p,clearAnalysis:g,getExplanation:f,isAmbiguous:h,getAnalytics:y,shouldShowRouting:b,getRecommendedPersona:x,getAlternatives:v}}(e,{enabled:!0,debounceMs:1e3,minConfidenceThreshold:.6});(0,n.useEffect)(()=>{!_&&I.length>10&&Z(I)},[I,_,Z]),(0,n.useEffect)(()=>{if(e&&Object.keys(e).length>0&&!_){let a=null;if(h&&h.selectedPersona&&e[h.selectedPersona])a=h.selectedPersona;else if(h){let t=b();t&&e[t]&&(a=t)}if(!a){let t=localStorage.getItem("selectedPersona");t&&e[t]&&(a=t)}a||(a=e.ga?"ga":e.dr_gasnelio?"dr_gasnelio":Object.keys(e)[0]),a&&(console.log("[ChatPage] Setting initial persona:",a),F(a),localStorage.setItem("selectedPersona",a),h&&h.selectedPersona!==a&&y({selectedPersona:a}),f||r(a))}},[e]);let ed=(0,n.useCallback)(async(e,a)=>{u({role:"user",content:e,timestamp:Date.now(),persona:a});try{await j(e,a)}catch(e){console.error("Erro ao enviar mensagem:",e)}},[j,u]),ep=async e=>{if(e.preventDefault(),!I.trim())return;let a=I.trim();if(!_){U(a),await Z(a);return}if(!x){N("");try{await ed(a,_)}catch(e){console.error("Erro ao enviar mensagem:",e)}}},eh=e=>{F(e),localStorage.setItem("selectedPersona",e),r(e),ei(),O&&(N(O),U(""))};if((0,n.useCallback)(e=>{ee(),eh(e)},[ee]),(0,n.useCallback)(()=>{et(_||"")},[et,_]),(0,n.useCallback)(()=>{console.log("Explica\xe7\xe3o do roteamento:",ec())},[ec]),a)return(0,o.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)(k,{size:48,spinning:!0}),(0,o.jsx)("p",{children:"Carregando chat..."})]})});if(t)return(0,o.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)(v,{size:48,color:eu.rS.colors.primary[500]}),(0,o.jsxs)("p",{children:["Erro ao carregar chat: ",t]}),(0,o.jsx)(i.default,{href:"/",style:{color:eu.rS.colors.primary[500],textDecoration:"underline"},children:"Voltar ao in\xedcio"})]})});let ey=_?e[_]:null;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.Z,{currentPersona:null==ey?void 0:ey.name}),(0,o.jsx)(n.Suspense,{fallback:(0,o.jsx)(eg,{}),children:(0,o.jsx)(ef,{conversations:H(),currentConversationId:f,personas:e,onConversationSelect:e=>{l(e);let a=H().find(a=>a.id===e);a&&(F(a.personaId),localStorage.setItem("selectedPersona",a.personaId)),ei()},onNewConversation:e=>{r(e),F(e),localStorage.setItem("selectedPersona",e)},onDeleteConversation:d,onRenameConversation:m,isVisible:M,onToggle:()=>P(!M)})}),(0,o.jsx)("div",{style:{marginLeft:M&&!L?"320px":"0",transition:"margin-left 0.3s ease",position:"relative"},children:(0,o.jsx)(K,{personas:e,selectedPersona:_,onPersonaChange:eh,messages:W,inputValue:I,onInputChange:N,onSendMessage:ep,isLoading:x,isMobile:L,currentSentiment:S,knowledgeStats:z,isSearchingKnowledge:T,fallbackState:R,onHistoryToggle:()=>P(!M),showHistory:M})})]})}},319:function(e,a,t){"use strict";var r=t(7437),s=t(29),o=t.n(s),n=t(2265),i=t(3861),c=t(5121);let l=(0,n.memo)(function(e){let{persona:a,personaId:t,size:s="medium",showStatus:l=!1,isTyping:d=!1,onClick:m,ariaLabel:u,className:p="",style:g={}}=e,[f,h]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),x=(0,n.useMemo)(()=>{let e=(0,i.Qu)(t);return console.log("[PersonaAvatar] personaId: ".concat(t,", avatarUrl: ").concat(e)),e||null},[t]),v=(0,n.useMemo)(()=>(0,c.pf)(t),[t]),k=(0,n.useMemo)(()=>{switch(s){case"tiny":return{width:"24px",height:"24px",fontSize:"0.75rem"};case"small":return{width:"32px",height:"32px",fontSize:"1rem"};case"large":return{width:"64px",height:"64px",fontSize:"2rem"};default:return{width:"48px",height:"48px",fontSize:"1.5rem"}}},[s]),w=(0,n.useCallback)(()=>{h(!1),b(!1)},[]),j=(0,n.useCallback)(()=>{console.warn("Erro ao carregar avatar para persona ".concat(t,":"),x),h(!0),b(!1)},[t,x]),S=(0,n.useCallback)(()=>{b(!0)},[]),C=(0,n.useCallback)(()=>{m&&!y&&m()},[m,y]),z=(0,n.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&m&&!y&&(e.preventDefault(),m())},[m,y]),E="Avatar de ".concat(a.name).concat(d?", digitando":"").concat(l?", online":"");return(0,r.jsxs)("div",{role:m?"button":"img",tabIndex:m?0:-1,"aria-label":u||E,style:{position:"relative",display:"inline-block",cursor:m?"pointer":"default",outline:"none",...g},onClick:C,onKeyDown:z,className:"jsx-5912179cbb9301c9 "+(p||""),children:[(0,r.jsxs)("div",{style:{...k,borderRadius:"50%",background:f||!x?"linear-gradient(135deg, ".concat(v.primaryColor," 0%, ").concat(v.secondaryColor," 100%)"):"white",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",boxShadow:"0 4px 12px ".concat(v.primaryColor,"30"),transition:"all 0.3s ease",border:d?"3px solid ".concat(c.rS.colors.educational.success):"3px solid ".concat(v.accentColor,"40"),animation:d?"pulse 2s infinite":"none",overflow:"hidden"},onMouseEnter:e=>{m&&!y&&(e.currentTarget.style.transform="scale(1.1)",e.currentTarget.style.boxShadow="0 6px 20px ".concat(v.primaryColor,"40"))},onMouseLeave:e=>{m&&(e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 12px ".concat(v.primaryColor,"30"))},onFocus:e=>{m&&(e.currentTarget.style.outline="2px solid ".concat(v.primaryColor),e.currentTarget.style.outlineOffset="2px")},onBlur:e=>{m&&(e.currentTarget.style.outline="none")},className:"jsx-5912179cbb9301c9",children:[y&&(0,r.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.8rem",color:"white"},className:"jsx-5912179cbb9301c9",children:"⏳"}),!f&&x?(0,r.jsx)("img",{src:x,alt:"Avatar de ".concat(a.name,", especialista em ").concat(a.target_audience||"sa\xfade"),loading:"lazy",decoding:"async",width:parseInt(k.width),height:parseInt(k.height),style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%",opacity:y?.5:1,transition:"opacity 0.3s ease"},onError:j,onLoad:w,onLoadStart:S,className:"jsx-5912179cbb9301c9"}):(0,r.jsx)("span",{style:{fontSize:k.fontSize,color:"white",fontWeight:"bold",userSelect:"none"},"aria-hidden":"true",className:"jsx-5912179cbb9301c9",children:a.avatar||a.name.charAt(0).toUpperCase()})]}),l&&(0,r.jsx)("div",{"aria-label":d?"Digitando":"Online",style:{position:"absolute",bottom:"2px",right:"2px",width:"tiny"===s?"6px":"small"===s?"8px":"large"===s?"16px":"12px",height:"tiny"===s?"6px":"small"===s?"8px":"large"===s?"16px":"12px",borderRadius:"50%",background:d?"#4caf50":"#2196f3",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",animation:d?"pulse 2s infinite":"none"},className:"jsx-5912179cbb9301c9"}),d&&(0,r.jsx)("div",{"aria-live":"polite","aria-label":"Digitando",style:{position:"absolute",top:"-8px",right:"-8px",background:"#4caf50",color:"white",borderRadius:"12px",padding:"2px 6px",fontSize:"0.7rem",fontWeight:"bold",animation:"bounce 1s infinite",userSelect:"none",pointerEvents:"none"},className:"jsx-5912179cbb9301c9",children:(0,r.jsx)("span",{"aria-hidden":"true",className:"jsx-5912179cbb9301c9",children:"..."})}),(0,r.jsx)(o(),{id:"5912179cbb9301c9",children:"@-webkit-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-moz-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-o-keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@keyframes pulse{0%{border-color:#4caf50}50%{border-color:#81c784}100%{border-color:#4caf50}}@-webkit-keyframes bounce{0%,20%,50%,80%,100%{-webkit-transform:translatey(0);transform:translatey(0)}40%{-webkit-transform:translatey(-4px);transform:translatey(-4px)}60%{-webkit-transform:translatey(-2px);transform:translatey(-2px)}}@-moz-keyframes bounce{0%,20%,50%,80%,100%{-moz-transform:translatey(0);transform:translatey(0)}40%{-moz-transform:translatey(-4px);transform:translatey(-4px)}60%{-moz-transform:translatey(-2px);transform:translatey(-2px)}}@-o-keyframes bounce{0%,20%,50%,80%,100%{-o-transform:translatey(0);transform:translatey(0)}40%{-o-transform:translatey(-4px);transform:translatey(-4px)}60%{-o-transform:translatey(-2px);transform:translatey(-2px)}}@keyframes bounce{0%,20%,50%,80%,100%{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}40%{-webkit-transform:translatey(-4px);-moz-transform:translatey(-4px);-o-transform:translatey(-4px);transform:translatey(-4px)}60%{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px)}}"})]})});a.Z=l},2983:function(e,a,t){"use strict";t.d(a,{H:function(){return l}});var r=t(2265),s=t(8223),o=t(3861);class n{generateKey(e,a){let t=a?JSON.stringify(a):"";return"".concat(e).concat(t)}isExpired(e){return Date.now()-e.timestamp>e.ttl}cleanup(){let e=[];this.cache.forEach((a,t)=>{this.isExpired(a)&&e.push(t)}),e.forEach(e=>this.cache.delete(e))}evictOldest(){if(this.cache.size>=this.maxSize){let e=null,a=1/0;this.cache.forEach((t,r)=>{t.timestamp<a&&(a=t.timestamp,e=r)}),e&&this.cache.delete(e)}}get(e,a){this.cleanup();let t=this.generateKey(e,a),r=this.cache.get(t);return!r||this.isExpired(r)?(r&&this.cache.delete(t),null):(r.timestamp=Date.now(),r.data)}set(e,a,t,r){this.evictOldest();let s=this.generateKey(e,t),o={data:a,timestamp:Date.now(),ttl:r||this.defaultTTL,key:s};this.cache.set(s,o)}delete(e,a){let t=this.generateKey(e,a);this.cache.delete(t)}clear(){this.cache.clear()}getStats(){let e=[];return this.cache.forEach((a,t)=>e.push(t)),{size:this.cache.size,maxSize:this.maxSize,keys:e,hitRate:0}}preload(e,a,t,r){this.set(e,a,t,r)}constructor(){this.cache=new Map,this.maxSize=50,this.defaultTTL=3e5}}let i=new n,c={get:()=>i.get("personas",void 0),set:e=>i.set("personas",e,void 0,18e5)};function l(){let[e,a]=(0,r.useState)({}),[t,n]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async function(){try{n(!0),l(null);let e=c.get();if(e){a(e),n(!1);return}let t=await (0,s.H7)(),r=(0,o.bt)(t);c.set(r),a(r)}catch(e){console.error("Erro ao carregar personas:",e),l(e instanceof Error?e.message:"Erro desconhecido")}finally{n(!1)}})()},[]),{personas:e,loading:t,error:i,getPersonaById:a=>e[a]||null,getPersonasList:()=>Object.entries(e).map(e=>{let[a,t]=e;return{id:a,persona:t}}),getValidPersonasCount:()=>{let a=Object.keys(e).length;return console.log("[usePersonas] getValidPersonasCount:",{personas:e,count:a}),a>0?a:2},refetch:async()=>{try{n(!0),l(null);let e=await (0,s.H7)(),t=(0,o.bt)(e);a(t)}catch(e){console.error("Erro ao carregar personas:",e),l(e instanceof Error?e.message:"Erro desconhecido")}finally{n(!1)}}}}},8497:function(e,a,t){"use strict";t.d(a,{Gr:function(){return n}});var r=t(2265);let s="userProfile",o={language:"simple",notifications:!0,theme:"auto"};function n(){let[e,a]=(0,r.useState)(null),[t,n]=(0,r.useState)(!0);(0,r.useEffect)(()=>{try{let e=localStorage.getItem(s);if(e){let t=JSON.parse(e);"1.0"===t.version?a(t.profile):(console.log("Migrando perfil para nova vers\xe3o"),localStorage.removeItem(s))}}catch(e){console.error("Erro ao carregar perfil do usu\xe1rio:",e),localStorage.removeItem(s)}finally{n(!1)}},[]);let i=t=>{try{var r,n;let i={...t,preferences:{...o,...t.preferences},history:{lastPersona:t.selectedPersona||"ga",conversationCount:((null==e?void 0:null===(r=e.history)||void 0===r?void 0:r.conversationCount)||0)+1,lastAccess:new Date().toISOString(),preferredTopics:(null==e?void 0:null===(n=e.history)||void 0===n?void 0:n.preferredTopics)||[]}},c={version:"1.0",profile:i,savedAt:new Date().toISOString()};localStorage.setItem(s,JSON.stringify(c)),a(i)}catch(e){console.error("Erro ao salvar perfil do usu\xe1rio:",e)}};return{profile:e,isLoading:t,saveProfile:i,updateProfile:a=>{var t,r,s;e&&i({...e,...a,history:{lastPersona:a.selectedPersona||(null===(t=e.history)||void 0===t?void 0:t.lastPersona)||"ga",conversationCount:(null===(r=e.history)||void 0===r?void 0:r.conversationCount)||0,lastAccess:new Date().toISOString(),preferredTopics:(null===(s=e.history)||void 0===s?void 0:s.preferredTopics)||[]}})},clearProfile:()=>{try{localStorage.removeItem(s),a(null)}catch(e){console.error("Erro ao limpar perfil do usu\xe1rio:",e)}},getRecommendedPersona:()=>{if(!e)return"ga";let{type:a,focus:t,history:r}=e;return(null==r?void 0:r.lastPersona)&&r.conversationCount>2?r.lastPersona:"professional"===a||"student"===a?"technical"===t?"dr_gasnelio":"practical"===t?"ga":"dr_gasnelio":"technical"===t?"dr_gasnelio":"ga"},hasProfile:null!==e}}},8223:function(e,a,t){"use strict";t.d(a,{$N:function(){return n},H7:function(){return s},bE:function(){return o}});let r="https://roteiro-dispensacao-api-1016586236354.us-central1.run.app";async function s(){try{let e=await fetch("".concat(r,"/api/personas"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.json();return a.personas||a}catch(e){throw console.error("Erro ao buscar personas:",e),e}}async function o(e){try{let a=await fetch("".concat(r,"/api/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return await a.json()}catch(e){throw console.error("Erro ao enviar mensagem:",e),e}}async function n(e){try{let a=await fetch("".concat(r,"/api/scope"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return await a.json()}catch(e){throw console.error("Erro ao detectar escopo:",e),e}}}},function(e){e.O(0,[29,448,145,768,971,117,744],function(){return e(e.s=1340)}),_N_E=e.O()}]);