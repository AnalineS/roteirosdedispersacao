(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{1340:function(e,s,a){Promise.resolve().then(a.bind(a,9349))},9349:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return x}});var t=a(7437),r=a(29),n=a.n(r),i=a(2265),o=a(7648),l=a(4768),c=a(44),d=a(8223);function x(){let{personas:e,loading:s,error:a}=(0,c.H)(),{messages:r,loading:x,error:p,sendMessage:b,clearMessages:u}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{persistToLocalStorage:s=!0,storageKey:a="chat-history"}=e,[t,r]=(0,i.useState)(()=>{if(!s)return[];try{let e=localStorage.getItem(a);return e?JSON.parse(e):[]}catch(e){return console.error("Erro ao carregar hist\xf3rico do chat:",e),[]}}),[n,o]=(0,i.useState)(!1),[l,c]=(0,i.useState)(null),x=(0,i.useCallback)(e=>{if(s)try{localStorage.setItem(a,JSON.stringify(e))}catch(e){console.error("Erro ao salvar hist\xf3rico do chat:",e)}},[s,a]),p=(0,i.useCallback)(async function(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e.trim())return;let n={role:"user",content:e.trim(),timestamp:Date.now(),persona:s};if(0===a){let e=[...t,n];r(e),x(e)}o(!0),c(null);try{let i=0===a?[...t,n]:t,o={message:e.trim(),persona:s,conversation_history:i.slice(-10)},l=await (0,d.bE)(o),c={role:"assistant",content:l.response,timestamp:l.timestamp,persona:l.persona},p=[...i,c];r(p),x(p)}catch(t){if(console.error("Erro ao enviar mensagem (tentativa ".concat(a+1,"):"),t),a<3)setTimeout(()=>{p(e,s,a+1)},1e3*Math.pow(2,a)),c("Tentando novamente... (".concat(a+1,"/").concat(3,")"));else{let e=t instanceof Error?t.message:"Erro ao enviar mensagem";c("".concat(e," (Falha ap\xf3s ").concat(3," tentativas)")),o(!1)}}a>=3&&o(!1)},[t,x]),b=(0,i.useCallback)(()=>{r([]),s&&localStorage.removeItem(a)},[s,a]),u=(0,i.useCallback)(e=>t.filter(s=>s.persona===e),[t]);return{messages:t,loading:n,error:l,sendMessage:p,clearMessages:b,getMessagesForPersona:u}}(),[m,f]=(0,i.useState)(""),[h,g]=(0,i.useState)(null),j=(0,i.useRef)(null);(0,i.useEffect)(()=>{{let s=localStorage.getItem("selectedPersona");s&&e[s]&&g(s)}},[e]),(0,i.useEffect)(()=>{var e;null===(e=j.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[r]),(0,i.useEffect)(()=>{if(h&&e[h]&&0===r.length){let s=e[h];"Ol\xe1! Eu sou ".concat(s.name,", ").concat(s.description,". Como posso ajud\xe1-lo hoje com quest\xf5es sobre hansen\xedase e PQT-U?"),setTimeout(()=>{b("_welcome_",h)},500)}},[h,e,r.length]);let y=async e=>{if(e.preventDefault(),!m.trim()||!h||x)return;let s=m.trim();f(""),await b(s,h)},v=e=>{g(e),localStorage.setItem("selectedPersona",e),u()};if(s)return(0,t.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsx)("div",{style:{fontSize:"2rem",marginBottom:"20px"},children:"⏳"}),(0,t.jsx)("p",{children:"Carregando chat..."})]})});if(a)return(0,t.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsx)("div",{style:{fontSize:"2rem",marginBottom:"20px"},children:"⚠️"}),(0,t.jsxs)("p",{children:["Erro ao carregar chat: ",a]}),(0,t.jsx)(o.default,{href:"/",style:{color:"#1976d2",textDecoration:"underline"},children:"Voltar ao in\xedcio"})]})});let N=h?e[h]:null;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Z,{currentPersona:null==N?void 0:N.name}),(0,t.jsxs)("div",{style:{height:"100vh",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"},className:"jsx-81480df78bbb953a main-content",children:[(0,t.jsxs)("div",{style:{background:"#1976d2",color:"white",padding:"15px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},className:"jsx-81480df78bbb953a",children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"15px"},className:"jsx-81480df78bbb953a",children:[(0,t.jsx)(o.default,{href:"/",style:{color:"white",textDecoration:"none",fontSize:"1.5rem"},children:"←"}),N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{style:{fontSize:"2rem"},className:"jsx-81480df78bbb953a",children:N.avatar}),(0,t.jsxs)("div",{className:"jsx-81480df78bbb953a",children:[(0,t.jsx)("h2",{style:{margin:0,fontSize:"1.2rem"},className:"jsx-81480df78bbb953a",children:N.name}),(0,t.jsx)("p",{style:{margin:0,fontSize:"0.9rem",opacity:.8},className:"jsx-81480df78bbb953a",children:N.personality})]})]})]}),(0,t.jsxs)("select",{value:h||"",onChange:e=>v(e.target.value),style:{padding:"8px 12px",borderRadius:"8px",border:"none",background:"rgba(255,255,255,0.2)",color:"white",fontSize:"0.9rem"},className:"jsx-81480df78bbb953a",children:[(0,t.jsx)("option",{value:"",className:"jsx-81480df78bbb953a",children:"Escolher assistente..."}),Object.entries(e).map(e=>{let[s,a]=e;return(0,t.jsxs)("option",{value:s,style:{color:"black"},className:"jsx-81480df78bbb953a",children:[a.avatar," ",a.name]},s)})]})]}),(0,t.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"20px",display:"flex",flexDirection:"column",gap:"15px"},className:"jsx-81480df78bbb953a",children:[!h&&(0,t.jsx)("div",{style:{textAlign:"center",padding:"40px",background:"rgba(255,255,255,0.7)",borderRadius:"12px",margin:"20px"},className:"jsx-81480df78bbb953a",children:(0,t.jsx)("p",{style:{fontSize:"1.1rem",color:"#666"},className:"jsx-81480df78bbb953a",children:"Selecione um assistente virtual no menu acima para come\xe7ar a conversa"})}),r.map(e=>(0,t.jsx)("div",{style:{display:"flex",justifyContent:"user"===e.role?"flex-end":"flex-start",marginBottom:"10px"},className:"jsx-81480df78bbb953a",children:(0,t.jsxs)("div",{style:{maxWidth:"70%",padding:"12px 16px",borderRadius:"18px",background:"user"===e.role?"#1976d2":"white",color:"user"===e.role?"white":"#333",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontSize:"0.95rem",lineHeight:"1.4"},className:"jsx-81480df78bbb953a",children:["assistant"===e.role&&N&&(0,t.jsxs)("div",{style:{fontSize:"0.8rem",opacity:.7,marginBottom:"5px",display:"flex",alignItems:"center",gap:"5px"},className:"jsx-81480df78bbb953a",children:[N.avatar," ",N.name]}),(0,t.jsx)("div",{style:{whiteSpace:"pre-wrap"},className:"jsx-81480df78bbb953a",children:e.content})]})},"".concat(e.role,"-").concat(e.timestamp))),x&&(0,t.jsx)("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"10px"},className:"jsx-81480df78bbb953a",children:(0,t.jsx)("div",{style:{padding:"12px 16px",borderRadius:"18px",background:"white",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},className:"jsx-81480df78bbb953a",children:(0,t.jsxs)("div",{style:{display:"flex",gap:"4px",alignItems:"center"},className:"jsx-81480df78bbb953a",children:[(0,t.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#ccc",animation:"pulse 1.5s infinite"},className:"jsx-81480df78bbb953a"}),(0,t.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#ccc",animation:"pulse 1.5s infinite 0.5s"},className:"jsx-81480df78bbb953a"}),(0,t.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#ccc",animation:"pulse 1.5s infinite 1s"},className:"jsx-81480df78bbb953a"}),(0,t.jsxs)("span",{style:{marginLeft:"8px",fontSize:"0.9rem",color:"#666"},className:"jsx-81480df78bbb953a",children:[null==N?void 0:N.name," est\xe1 pensando..."]})]})})}),p&&(0,t.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",background:"#ffebee",color:"#c62828",textAlign:"center",margin:"10px 0"},className:"jsx-81480df78bbb953a",children:["Erro: ",p]}),(0,t.jsx)("div",{ref:j,className:"jsx-81480df78bbb953a"})]}),(0,t.jsxs)("form",{onSubmit:y,style:{padding:"20px",background:"white",borderTop:"1px solid #eee",display:"flex",gap:"10px"},className:"jsx-81480df78bbb953a",children:[(0,t.jsx)("input",{type:"text",value:m,onChange:e=>f(e.target.value),placeholder:h?"Pergunte ao ".concat(null==N?void 0:N.name,"..."):"Selecione um assistente primeiro...",disabled:!h||x,style:{flex:1,padding:"12px 16px",borderRadius:"25px",border:"1px solid #ddd",fontSize:"1rem",outline:"none",background:h?"white":"#f5f5f5"},className:"jsx-81480df78bbb953a"}),(0,t.jsx)("button",{type:"submit",disabled:!h||!m.trim()||x,style:{padding:"12px 20px",borderRadius:"25px",border:"none",background:h&&m.trim()&&!x?"#1976d2":"#ccc",color:"white",cursor:h&&m.trim()&&!x?"pointer":"not-allowed",fontSize:"1rem",fontWeight:"bold"},className:"jsx-81480df78bbb953a",children:x?"⏳":"➤"})]}),(0,t.jsx)(n(),{id:"81480df78bbb953a",children:"@-webkit-keyframes pulse{0%,80%,100%{opacity:.3}40%{opacity:1}}@-moz-keyframes pulse{0%,80%,100%{opacity:.3}40%{opacity:1}}@-o-keyframes pulse{0%,80%,100%{opacity:.3}40%{opacity:1}}@keyframes pulse{0%,80%,100%{opacity:.3}40%{opacity:1}}"})]})]})}},4768:function(e,s,a){"use strict";a.d(s,{Z:function(){return c}});var t=a(7437),r=a(29),n=a.n(r),i=a(7648),o=a(9376),l=a(2265);function c(e){let{currentPersona:s}=e,a=(0,o.usePathname)(),[r,c]=(0,l.useState)(!1),d=e=>"/"===e?"/"===a:a.startsWith(e);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>c(!r),style:{position:"fixed",top:"20px",left:"20px",zIndex:1e3,background:"#1976d2",color:"white",border:"none",borderRadius:"50%",width:"50px",height:"50px",fontSize:"1.5rem",cursor:"pointer",boxShadow:"0 4px 12px rgba(0,0,0,0.2)",display:"block"},className:"jsx-8b16e275268ec1c7 lg:hidden",children:r?"✕":"☰"}),r&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:998},onClick:()=>c(!1),className:"jsx-8b16e275268ec1c7"}),(0,t.jsxs)("nav",{style:{position:"fixed",top:0,left:r?0:"-300px",width:"280px",height:"100vh",background:"linear-gradient(180deg, #1976d2 0%, #1565c0 100%)",color:"white",transition:"left 0.3s ease",zIndex:999,overflowY:"auto",boxShadow:"4px 0 20px rgba(0,0,0,0.1)"},className:"jsx-8b16e275268ec1c7 lg:left-0",children:[(0,t.jsxs)("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},className:"jsx-8b16e275268ec1c7",children:[(0,t.jsx)("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:"bold"},className:"jsx-8b16e275268ec1c7",children:"PQT-U Educacional"}),s&&(0,t.jsxs)("p",{style:{margin:"5px 0 0",fontSize:"0.9rem",opacity:.8},className:"jsx-8b16e275268ec1c7",children:["Assistente: ",s]})]}),(0,t.jsx)("div",{style:{padding:"20px 0"},className:"jsx-8b16e275268ec1c7",children:[{id:"home",label:"In\xedcio",href:"/",icon:"\uD83C\uDFE0",description:"Sele\xe7\xe3o de assistentes virtuais"},{id:"dashboard",label:"Dashboard",href:"/dashboard",icon:"\uD83D\uDCCA",description:"Progresso educacional e recursos"},{id:"chat",label:"Conversar",href:"/chat",icon:"\uD83D\uDCAC",description:"Chat com assistentes especializados"},{id:"modules",label:"M\xf3dulos",href:"/modules",icon:"\uD83D\uDCDA",description:"Conte\xfado educacional estruturado"},{id:"resources",label:"Recursos",href:"/resources",icon:"\uD83C\uDFAF",description:"Calculadoras, checklists e ferramentas"},{id:"progress",label:"Progresso",href:"/progress",icon:"\uD83D\uDCC8",description:"Acompanhe seu aprendizado"}].map(e=>(0,t.jsx)(i.default,{href:e.href,onClick:()=>c(!1),style:{display:"block",padding:"15px 20px",color:"white",textDecoration:"none",borderLeft:d(e.href)?"4px solid white":"4px solid transparent",background:d(e.href)?"rgba(255,255,255,0.1)":"transparent",transition:"all 0.3s ease"},onMouseEnter:s=>{d(e.href)||(s.currentTarget.style.background="rgba(255,255,255,0.05)")},onMouseLeave:s=>{d(e.href)||(s.currentTarget.style.background="transparent")},children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},className:"jsx-8b16e275268ec1c7",children:[(0,t.jsx)("span",{style:{fontSize:"1.2rem"},className:"jsx-8b16e275268ec1c7",children:e.icon}),(0,t.jsxs)("div",{className:"jsx-8b16e275268ec1c7",children:[(0,t.jsx)("div",{style:{fontWeight:d(e.href)?"bold":"normal",fontSize:"1rem"},className:"jsx-8b16e275268ec1c7",children:e.label}),(0,t.jsx)("div",{style:{fontSize:"0.8rem",opacity:.7,marginTop:"2px"},className:"jsx-8b16e275268ec1c7",children:e.description})]})]})},e.id))}),(0,t.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"20px",borderTop:"1px solid rgba(255,255,255,0.1)",background:"rgba(0,0,0,0.1)"},className:"jsx-8b16e275268ec1c7",children:(0,t.jsxs)("div",{style:{fontSize:"0.8rem",opacity:.7,textAlign:"center"},className:"jsx-8b16e275268ec1c7",children:[(0,t.jsx)("p",{style:{margin:"0 0 5px"},className:"jsx-8b16e275268ec1c7",children:"Sistema Educacional"}),(0,t.jsx)("p",{style:{margin:0},className:"jsx-8b16e275268ec1c7",children:"Hansen\xedase PQT-U"})]})})]}),(0,t.jsx)(n(),{id:"8b16e275268ec1c7",children:"@media(min-width:1024px){.main-content{margin-left:280px;-webkit-transition:margin-left.3s ease;-moz-transition:margin-left.3s ease;-o-transition:margin-left.3s ease;transition:margin-left.3s ease}}"})]})}},44:function(e,s,a){"use strict";a.d(s,{H:function(){return n}});var t=a(2265),r=a(8223);function n(){let[e,s]=(0,t.useState)({}),[a,n]=(0,t.useState)(!0),[i,o]=(0,t.useState)(null);return(0,t.useEffect)(()=>{!async function(){try{n(!0),o(null);let e=await (0,r.H7)();s(e)}catch(e){console.error("Erro ao carregar personas:",e),o(e instanceof Error?e.message:"Erro desconhecido")}finally{n(!1)}}()},[]),{personas:e,loading:a,error:i,getPersonaById:s=>e[s]||null,getPersonasList:()=>Object.entries(e).map(e=>{let[s,a]=e;return{id:s,persona:a}}),refetch:()=>{n(!0),l()}};async function l(){try{n(!0),o(null);let e=await (0,r.H7)();s(e)}catch(e){console.error("Erro ao carregar personas:",e),o(e instanceof Error?e.message:"Erro desconhecido")}finally{n(!1)}}}},8223:function(e,s,a){"use strict";a.d(s,{H7:function(){return r},bE:function(){return n}});let t=a(257).env.NEXT_PUBLIC_API_URL||"https://roteiro-dispensacao-api-1016586236354.us-central1.run.app";async function r(){try{let e=await fetch("".concat(t,"/api/personas"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(e){throw console.error("Erro ao buscar personas:",e),e}}async function n(e){try{let s=await fetch("".concat(t,"/api/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));return await s.json()}catch(e){throw console.error("Erro ao enviar mensagem:",e),e}}}},function(e){e.O(0,[29,448,971,117,744],function(){return e(e.s=1340)}),_N_E=e.O()}]);