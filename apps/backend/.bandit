# Bandit Security Configuration for Medical Educational Platform
# Configuração específica para análise de segurança Python em plataforma médico-educacional

[bandit]

# Diretórios para análise (relativo ao backend)
targets = .

# Diretórios para ignorar
exclude_dirs = 
    /venv,
    /node_modules,
    /tests,
    /__pycache__,
    /build,
    /dist,
    /.pytest_cache

# Arquivos para ignorar por padrão
skips = 
    B101,  # assert_used (comum em desenvolvimento)
    B601   # paramiko_calls (não usado)

# Nível de confiança mínimo para reportar
confidence = medium

# Severidade mínima para reportar  
severity = medium

# Formato de saída
format = txt

# ===== TESTES ESPECÍFICOS PARA PLATAFORMA MÉDICA =====

# Testes críticos para incluir sempre
tests = 
    B102,  # exec_used - CRÍTICO
    B103,  # set_bad_file_permissions  
    B104,  # hardcoded_bind_all_interfaces - CRÍTICO para produção
    B105,  # hardcoded_password_string - CRÍTICO
    B106,  # hardcoded_password_funcarg - CRÍTICO
    B107,  # hardcoded_password_default - CRÍTICO
    B108,  # hardcoded_tmp_directory
    B110,  # try_except_pass - PODE MASCARAR ERROS MÉDICOS
    B112,  # try_except_continue - PODE MASCARAR ERROS MÉDICOS
    B201,  # flask_debug_true
    B301,  # pickle_load
    B311,  # random_not_secure
    B323,  # unverified_context
    B324,  # hashlib_not_secure
    B501,  # request_with_no_cert_validation
    B502,  # ssl_with_bad_version
    B506,  # yaml_load
    B602,  # subprocess_popen_with_shell_equals_true
    B608,  # hardcoded_sql_expressions
    B701,  # jinja2_autoescape_false
    B702   # use_of_mako_templates

# ===== CONFIGURAÇÕES ESPECÍFICAS ===

[bandit.hardcoded_password]
# Padrões para detectar senhas hardcoded em contexto médico
word_list = 
    password,
    passwd,
    secret,
    token,
    key,
    api_key,
    auth_token,
    medical_key,
    patient_key,
    clinical_secret

[bandit.try_except_pass]
# CRÍTICO: try/except vazios podem mascarar erros médicos
message = "Try/except pass statement detected. May mask critical medical calculation errors."

[bandit.sql_injection]
# Detecção de SQL injection em contexto médico
confidence = high
severity = high